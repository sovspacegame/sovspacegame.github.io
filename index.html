<html>
<head>
<link rel="icon" href="img/icon.png" />
<link rel="stylesheet" href="css/style.css?ttd=44we34" />

 <!-- BEGINN WALLET-INCLUDE-->

    <!-- Anchor js -->
    <script src="https://unpkg.com/anchor-link@next"></script>
    <script src="https://unpkg.com/anchor-link-browser-transport@next"></script>

    <!-- Mandel eosjs -->
  <!--
    <script src="js/dist-web/eosjs-api.js"></script>
    <script src="js/dist-web/eosjs-jsonrpc.js"></script>
    <script src="js/dist-web/eosjs-jssig.js"></script>
    <script src="js/dist-web/eosjs-numeric.js"></script>
-->
<script src='js/dist-web/eosjs-api.js'></script>
<script src='js/dist-web/eosjs-jsonrpc.js'></script>
<script src='js/dist-web/eosjs-jssig.js'></script>


    <!-- Scatter js -->

  <!--  <script src="https://cdn.jsdelivr.net/npm/eosjs@16.0.9/lib/eos.min.js"></script>
    <script src="js/bundles/scatterjs-core.min.js"></script>
    <script src="js/bundles/scatterjs-plugin-eosjs.min.js"></script>
    <script src="js/bundles/scatterjs-plugin-lynx.min.js"></script>    -->

    <script src='js/assets/scatterjs-core.min.js'></script>
    <script src='js/assets/scatterjs-plugin-eosjs2.min.js'></script>

    <script src="js/eosiowallet/wallet.js?dsd=75324"></script>

    <script src="js/admin.js?dsd=422553"></script>
    <script src="js/sovspacegame.js?dsd=423"></script>
    <script src="js/eosjs-account-name_2.2.1.js"></script>

 <!-- END WALLET-INCLUDE-->

<script src="https://kit.fontawesome.com/22c7420d77.js" crossorigin="anonymous"></script>

<!-- font awesome kit for icons -->

</head>
<body class='bodyclass myimage' onload='loadaudio();'>

<div id='logo1' class='logo1x' style='text-align:center;height:180px;background:url(img/space.jpg);background-size:cover;color:#ffffff;'>


<img src='img/logo2.svg?t=d5443s' style='margin-top:10px;height:160px;border:none;'>


<div style='position:absolute;right:20px;top:45px;border:none;'>
 <audio id="audiotag" controls loop autoplay>
 <source src= "audio/ambientgreys.mp3" type="audio/mp3">
 </audio>
</div>


<div style='position:absolute;right:30px;top:110px;color:#007bff;border:none;'>
<div id='balance_eos'>....</div>
</div>

<div style='position:absolute;right:30px;top:130px;color:#007bff;border:none;'>
<div id='balance_sov'>....</div>
</div>

<div style='position:absolute;right:30px;top:150px;color:#007bff;border:none;'>
<div id='balance_svx'>....</div>
</div>



</div> <!-- logo1 -->






<!-- walletmenu -->

<div id='walletmenu' style='border:2px solid #000022;width:100%;height:90px;background:url(img/space2.jpg);background-size:cover;'>

<div id='walletmenu_left' style='float:left;position:relative;width:49%;text-align:center;margin-top:20px;background:#55ff55;'>

 <div id='walletmenu_accountname' style='position:absolute;width:100%;top:-5px;'>

 <div id='myaccountname' class='myaccountname' style='font-size:2em;color:#ddddff;font-weight:bold;'>...abc</div>
 <div id='userrace' style='font-size:1em;color:#ddddff;'>...</div>
 </div>

 <div id='walletmenu_anchor' style='position:absolute;width:100%;'>
 <div id='anchorbutton' onclick="login_anchor()" class='loginbutton_anchor noselect' style='margin-left:auto;margin-right:auto;' >ANCHOR</div>

 </div>


</div>





<div id='walletmenu_right' style='float:left;position:relative;width:49%;text-align:center;margin-top:20px;background:#5555ff;'>
  <div id='walletmenu_aa' style='position:absolute;width:100%;'>
  <div id='logoutbutton' onclick="logout_all()"  class='defaultbutton noselect' style='visibility:hidden;margin-left:auto;margin-right:auto;' >Logout</div>
  </div>

  <div id='walletmenu_scatter' style='position:absolute;width:100%;visibility:hiddenx;'>
  <div onclick="login_scatter()" class='defaultbutton noselect' style='margin-left:auto;margin-right:auto;'  >SCATTER/TP/WOMBAT</div>
  </div>

</div>


<div style='clear:both;'></div>




</div> <!-- end walletmenu -->








<div class='menuarea'>
<div id='menu1' class='menubutton_selected' onclick='setmenu(1)' style='margin-left:20px;'>Surface</div>
<div id='menu2' class='menubutton' onclick='setmenu(2)'>Mint</div>
<div id='menu3' class='menubutton' onclick='setmenu(3)'>Rules</div>
<div id='menu4' class='menubutton' onclick='setmenu(4)'>Lore</div>
<div id='menu5' class='menubutton' onclick='setmenu(5)' style='visibility:hidden'>Admin</div>
<div style='clear:both;'></div>

</div> <!-- menuarea -->





<div id='page1' style='overflow:hidden;'>


<div style='height:5px;'></div>


<!-- choose race area -->
<div id='chooserace' class='chooserace'  style='text-align:center;height:240px;visibility:visible;overflow:hidden;'>

<div class='chooseraceinner'  style='height:250px;border:none'>

<div id='chooseraceinner2' style='border:none;width:900px;margin-left:auto;margin-right:auto;overflow:hidden;'> <!-- chooseraceinner2 -->
<br>

<strong>
Please choose your species. Note: you cannot undo your decision!<br>Think carefully about which species suits you.<br>
</strong>
<br>

<div id='' class='choosebutton race_humans' onclick='inituser(1)' style='width:160px;height:130px;float:left;margin-left:20px;margin-right:20px;'>
Play Humans
<br>
<img src='img/logo_human.png' style='width:70px;margin-top:20px;margin-left:auto;margin-right:auto;'>
</div>


<div id='' class='choosebutton race_greys' onclick='inituser(2)' style='width:160px;height:130px;float:left;margin-right:20px;'>
Play Greys
<br>
<img src='img/logo_grey.png' style='width:70px;margin-top:20px;margin-left:auto;margin-right:auto;'>
</div>


<div id='' class='choosebutton race_greys' onclick='inituser(4)' style='width:160px;height:130px;float:left;margin-right:20px;'>
Play Sirians
<br>
<img src='img/logo_sirian.png' style='width:70px;margin-top:20px;margin-left:auto;margin-right:auto;'>
</div>


<div id='' class='choosebutton race_greys' onclick='inituser(5)' style='width:160px;height:130px;float:left;margin-right:20px;'>
Play Reptos
<br>
<img src='img/logo_reptos.png' style='width:70px;margin-top:20px;margin-left:auto;margin-right:auto;'>
</div>


</div> <!-- chooseraceinner2 -->

<br>
<br>

</div>

</div> <!-- choose race area -->

<div style='height:5px;'></div>

<!--
<div id='gameboardtag' ></div>
-->
<div id='gameboardmain'  class='gameboardmain' style='position:relative;margin-left:20px;width:70%; height:20px;   border:2px solid #666666;float:left;'>

<div id='gameboard' style='position:absolute; ;width:100%;height:300px;background:#404040;overflow:hidden;'>




</div> <!-- end gameboard -->


<div style='position:absolute;margin-left:0px;left:0px;top:0px;width:100%;height:100%; border:none;padding:0px;;color:#ffffff;'>

<svg id="mysvg" width="100%" height="100%" preserveAspectRatio="none" viewbox=" 0 0 1000 1000" style="position:absolute;border:none;z-Index:430;left:0px;top:0px;margin-top:0px;margin-left:0px;">\n


  <polygon id="tileb0"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,-50 100,0 0,50  -100,0   " />
      <polygon id="tileb1"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,50 100,100 0,150  -100,100   " />
      <polygon id="tileb2"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,0 200,50 100,100  0,50   " />
      <polygon id="tileb3"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,-50 300,0 200,50  100,0   " />
      <polygon id="tileb4"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,150 100,200 0,250  -100,200   " />
      <polygon id="tileb5"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,100 200,150 100,200  0,150   " />
      <polygon id="tileb6"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,50 300,100 200,150  100,100   " />
      <polygon id="tileb7"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,0 400,50 300,100  200,50   " />
      <polygon id="tileb8"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,-50 500,0 400,50  300,0   " />
      <polygon id="tileb9"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,250 100,300 0,350  -100,300   " />
      <polygon id="tileb10"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,200 200,250 100,300  0,250   " />
      <polygon id="tileb11"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,150 300,200 200,250  100,200   " />
      <polygon id="tileb12"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,100 400,150 300,200  200,150   " />
      <polygon id="tileb13"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,50 500,100 400,150  300,100   " />
      <polygon id="tileb14"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,0 600,50 500,100  400,50   " />
      <polygon id="tileb15"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,-50 700,0 600,50  500,0   " />
      <polygon id="tileb16"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,350 100,400 0,450  -100,400   " />
      <polygon id="tileb17"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,300 200,350 100,400  0,350   " />
      <polygon id="tileb18"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,250 300,300 200,350  100,300   " />
      <polygon id="tileb19"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,200 400,250 300,300  200,250   " />
      <polygon id="tileb20"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,150 500,200 400,250  300,200   " />
      <polygon id="tileb21"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,100 600,150 500,200  400,150   " />
      <polygon id="tileb22"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,50 700,100 600,150  500,100   " />
      <polygon id="tileb23"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,0 800,50 700,100  600,50   " />
      <polygon id="tileb24"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,-50 900,0 800,50  700,0   " />
      <polygon id="tileb25"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,450 100,500 0,550  -100,500   " />
      <polygon id="tileb26"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,400 200,450 100,500  0,450   " />
      <polygon id="tileb27"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,350 300,400 200,450  100,400   " />
      <polygon id="tileb28"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,300 400,350 300,400  200,350   " />
      <polygon id="tileb29"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,250 500,300 400,350  300,300   " />
      <polygon id="tileb30"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,200 600,250 500,300  400,250   " />
      <polygon id="tileb31"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,150 700,200 600,250  500,200   " />
      <polygon id="tileb32"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,100 800,150 700,200  600,150   " />
      <polygon id="tileb33"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,50 900,100 800,150  700,100   " />
      <polygon id="tileb34"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,0 1000,50 900,100  800,50   " />
      <polygon id="tileb35"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,-50 1100,0 1000,50  900,0   " />
      <polygon id="tileb36"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,550 100,600 0,650  -100,600   " />
      <polygon id="tileb37"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,500 200,550 100,600  0,550   " />
      <polygon id="tileb38"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,450 300,500 200,550  100,500   " />
      <polygon id="tileb39"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,400 400,450 300,500  200,450   " />
      <polygon id="tileb40"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,350 500,400 400,450  300,400   " />
      <polygon id="tileb41"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,300 600,350 500,400  400,350   " />
      <polygon id="tileb42"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,250 700,300 600,350  500,300   " />
      <polygon id="tileb43"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,200 800,250 700,300  600,250   " />
      <polygon id="tileb44"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,150 900,200 800,250  700,200   " />
      <polygon id="tileb45"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,100 1000,150 900,200  800,150   " />
      <polygon id="tileb46"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,50 1100,100 1000,150  900,100   " />
      <polygon id="tileb47"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,650 100,700 0,750  -100,700   " />
      <polygon id="tileb48"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,600 200,650 100,700  0,650   " />
      <polygon id="tileb49"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,550 300,600 200,650  100,600   " />
      <polygon id="tileb50"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,500 400,550 300,600  200,550   " />
      <polygon id="tileb51"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,450 500,500 400,550  300,500   " />
      <polygon id="tileb52"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,400 600,450 500,500  400,450   " />
      <polygon id="tileb53"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,350 700,400 600,450  500,400   " />
      <polygon id="tileb54"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,300 800,350 700,400  600,350   " />
      <polygon id="tileb55"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,250 900,300 800,350  700,300   " />
      <polygon id="tileb56"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,200 1000,250 900,300  800,250   " />
      <polygon id="tileb57"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,150 1100,200 1000,250  900,200   " />
      <polygon id="tileb58"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,750 100,800 0,850  -100,800   " />
      <polygon id="tileb59"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,700 200,750 100,800  0,750   " />
      <polygon id="tileb60"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,650 300,700 200,750  100,700   " />
      <polygon id="tileb61"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,600 400,650 300,700  200,650   " />
      <polygon id="tileb62"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,550 500,600 400,650  300,600   " />
      <polygon id="tileb63"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,500 600,550 500,600  400,550   " />
      <polygon id="tileb64"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,450 700,500 600,550  500,500   " />
      <polygon id="tileb65"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,400 800,450 700,500  600,450   " />
      <polygon id="tileb66"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,350 900,400 800,450  700,400   " />
      <polygon id="tileb67"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,300 1000,350 900,400  800,350   " />
      <polygon id="tileb68"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,250 1100,300 1000,350  900,300   " />
      <polygon id="tileb69"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,850 100,900 0,950  -100,900   " />
      <polygon id="tileb70"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,800 200,850 100,900  0,850   " />
      <polygon id="tileb71"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,750 300,800 200,850  100,800   " />
      <polygon id="tileb72"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,700 400,750 300,800  200,750   " />
      <polygon id="tileb73"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,650 500,700 400,750  300,700   " />
      <polygon id="tileb74"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,600 600,650 500,700  400,650   " />
      <polygon id="tileb75"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,550 700,600 600,650  500,600   " />
      <polygon id="tileb76"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,500 800,550 700,600  600,550   " />
      <polygon id="tileb77"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,450 900,500 800,550  700,500   " />
      <polygon id="tileb78"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,400 1000,450 900,500  800,450   " />
      <polygon id="tileb79"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,350 1100,400 1000,450  900,400   " />
      <polygon id="tileb80"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 0,950 100,1000 0,1050  -100,1000   " />
      <polygon id="tileb81"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 100,900 200,950 100,1000  0,950   " />
      <polygon id="tileb82"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,850 300,900 200,950  100,900   " />
      <polygon id="tileb83"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,800 400,850 300,900  200,850   " />
      <polygon id="tileb84"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,750 500,800 400,850  300,800   " />
      <polygon id="tileb85"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,700 600,750 500,800  400,750   " />
      <polygon id="tileb86"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,650 700,700 600,750  500,700   " />
      <polygon id="tileb87"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,600 800,650 700,700  600,650   " />
      <polygon id="tileb88"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,550 900,600 800,650  700,600   " />
      <polygon id="tileb89"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,500 1000,550 900,600  800,550   " />
      <polygon id="tileb90"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,450 1100,500 1000,550  900,500   " />
      <polygon id="tileb91"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 200,950 300,1000 200,1050  100,1000   " />
      <polygon id="tileb92"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 300,900 400,950 300,1000  200,950   " />
      <polygon id="tileb93"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,850 500,900 400,950  300,900   " />
      <polygon id="tileb94"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,800 600,850 500,900  400,850   " />
      <polygon id="tileb95"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,750 700,800 600,850  500,800   " />
      <polygon id="tileb96"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,700 800,750 700,800  600,750   " />
      <polygon id="tileb97"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,650 900,700 800,750  700,700   " />
      <polygon id="tileb98"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,600 1000,650 900,700  800,650   " />
      <polygon id="tileb99"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,550 1100,600 1000,650  900,600   " />
      <polygon id="tileb100"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 400,950 500,1000 400,1050  300,1000   " />
      <polygon id="tileb101"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 500,900 600,950 500,1000  400,950   " />
      <polygon id="tileb102"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,850 700,900 600,950  500,900   " />
      <polygon id="tileb103"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,800 800,850 700,900  600,850   " />
      <polygon id="tileb104"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,750 900,800 800,850  700,800   " />
      <polygon id="tileb105"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,700 1000,750 900,800  800,750   " />
      <polygon id="tileb106"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,650 1100,700 1000,750  900,700   " />
      <polygon id="tileb107"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 600,950 700,1000 600,1050  500,1000   " />
      <polygon id="tileb108"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 700,900 800,950 700,1000  600,950   " />
      <polygon id="tileb109"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,850 900,900 800,950  700,900   " />
      <polygon id="tileb110"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,800 1000,850 900,900  800,850   " />
      <polygon id="tileb111"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,750 1100,800 1000,850  900,800   " />
      <polygon id="tileb112"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 800,950 900,1000 800,1050  700,1000   " />
      <polygon id="tileb113"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 900,900 1000,950 900,1000  800,950   " />
      <polygon id="tileb114"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,850 1100,900 1000,950  900,900   " />
      <polygon id="tileb115"  fill="#9999ff" stroke="#ffffff" stroke-width=1 opacity=0.0  style=""  points=" 1000,950 1100,1000 1000,1050  900,1000   " />



</svg>






</div>





</div> <!-- end gameboardmain -->


<div id='board_navigation' style='color:#ffffff;width:27%;float:left;'>

<div id='navigation_svg' style='border:none;width:80%;margin-left:auto;margin-right:auto;'>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="100%"

   viewBox="0 0 105.56875 105.83334"
   version="1.1"
   id="svg8"
   inkscape:version="1.0.2 (e86c8708, 2021-01-15)"
   sodipodi:docname="navigation.svg">
  <defs
     id="defs2" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.5"
     inkscape:cx="164"
     inkscape:cy="476"
     inkscape:document-units="mm"
     inkscape:current-layer="layer1"
     inkscape:document-rotation="0"
     showgrid="false"
     units="px"
     inkscape:window-width="1248"
     inkscape:window-height="943"
     inkscape:window-x="112"
     inkscape:window-y="25"
     inkscape:window-maximized="0"
     inkscape:snap-global="false" />
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Ebene 1"
     inkscape:groupmode="layer"
     id="layer1">
    <rect
       style="fill:#333333;fill-opacity:0.848404;stroke:#ffffff;stroke-width:0.550038"
       id="rect851"
       width="18.310972"
       height="73.193123"
       x="-28.12989"
       y="-17.546558"
       ry="6.648787" />
    <path
       id="path853"
       style="fill:#ffffff;fill-opacity:0.30851063;stroke:none;stroke-width:11.8098"
       d="M 199.71094 5.9042969 A 194.09508 194.09508 0 0 0 5.9042969 200 A 194.09508 194.09508 0 0 0 200 394.0957 A 194.09508 194.09508 0 0 0 394.0957 200 A 194.09508 194.09508 0 0 0 200 5.9042969 A 194.09508 194.09508 0 0 0 199.71094 5.9042969 z M 200 80 A 120 120 0 0 1 320 200 A 120 120 0 0 1 200 320 A 120 120 0 0 1 80 200 A 120 120 0 0 1 200 80 z "
       transform="scale(0.26458333)" />



 <path
       id="circ1"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 53.181641 2.1171875 C 48.05137 2.1171875 43.919922 6.2466823 43.919922 11.376953 C 43.919922 16.507224 48.05137 20.636719 53.181641 20.636719 C 58.311912 20.636719 62.441406 16.507224 62.441406 11.376953 C 62.441406 6.2466823 58.311912 2.1171875 53.181641 2.1171875 z " />

  <path
       id="circ2"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 82.554688 14.275391 C 80.18755 14.275391 77.819683 15.182269 76.005859 16.996094 C 72.378209 20.623743 72.378209 26.464148 76.005859 30.091797 C 79.633508 33.719447 85.473913 33.719447 89.101562 30.091797 C 92.729212 26.464148 92.729212 20.623743 89.101562 16.996094 C 87.287737 15.182269 84.921828 14.275391 82.554688 14.275391 z " />

 <path
       id="circ3"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 94.720703 43.65625 C 89.590432 43.65625 85.460937 47.785745 85.460938 52.916016 C 85.460938 58.046287 89.590432 62.177734 94.720703 62.177734 C 99.850974 62.177734 103.98047 58.046287 103.98047 52.916016 C 103.98047 47.785745 99.850974 43.65625 94.720703 43.65625 z " />

    <path
       id="circ4"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 82.554688 73.021484 C 80.18755 73.021484 77.819683 73.928362 76.005859 75.742188 C 72.378207 79.369837 72.378207 85.210242 76.005859 88.837891 C 79.63351 92.465545 85.473913 92.465543 89.101562 88.837891 C 92.729215 85.210242 92.729217 79.369839 89.101562 75.742188 C 87.287737 73.928362 84.921828 73.021484 82.554688 73.021484 z " />

     <path
       id="circ5"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 53.181641 85.195312 C 48.05137 85.195312 43.919922 89.32676 43.919922 94.457031 C 43.919922 99.587302 48.05137 103.7168 53.181641 103.7168 C 58.311912 103.7168 62.441406 99.587302 62.441406 94.457031 C 62.441406 89.32676 58.311912 85.195312 53.181641 85.195312 z " />

    <path
       id="circ6"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 23.808594 73.021484 C 21.441455 73.021484 19.073591 73.928362 17.259766 75.742188 C 13.632117 79.369837 13.632117 85.210242 17.259766 88.837891 C 20.887414 92.46554 26.72782 92.46554 30.355469 88.837891 C 33.983119 85.210242 33.983119 79.369837 30.355469 75.742188 C 28.541645 73.928362 26.175733 73.021484 23.808594 73.021484 z " />

    <path
       id="circ7"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 11.642578 43.65625 C 6.5123078 43.65625 2.3808594 47.785745 2.3808594 52.916016 C 2.3808594 58.046287 6.5123078 62.177734 11.642578 62.177734 C 16.772849 62.177734 20.902344 58.046287 20.902344 52.916016 C 20.902344 47.785745 16.772849 43.65625 11.642578 43.65625 z " />

     <path
       id="circ8"
       style="fill:#ffffff;fill-opacity:0.49734;stroke:none;stroke-width:1.24518"
       d="M 23.808594 14.275391 C 21.441455 14.275391 19.07359 15.182269 17.259766 16.996094 C 13.632117 20.623742 13.632117 26.464148 17.259766 30.091797 C 20.887414 33.719449 26.72782 33.719449 30.355469 30.091797 C 33.983119 26.464148 33.983119 20.623742 30.355469 16.996094 C 28.541645 15.182269 26.175733 14.275391 23.808594 14.275391 z " />


    <path
       id="path924"
       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:3.24101"
       inkscape:transform-center-x="-0.043619609"
       inkscape:transform-center-y="-2.4305267"
       d="M 201.04883 10.142578 L 178.45703 66.869141 L 224.62891 66.064453 L 201.04883 10.142578 z M 224.62891 331 L 178.45703 331.80469 L 202.03711 387.72656 L 224.62891 331 z "
       transform="scale(0.26458333)" />
    <path
       id="path929"
       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.857517"
       inkscape:transform-center-x="-2.4305263"
       inkscape:transform-center-y="0.043619738"
       d="m 103.54635,52.861508 -15.00889,-5.977414 0.212907,12.21631 z M 18.652838,59.100404 18.43993,46.884094 3.6439366,53.12299 Z" />
    <path
       id="path931"
       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.857517"
       inkscape:transform-center-x="-1.6861865"
       inkscape:transform-center-y="1.7510388"
       d="M 88.760806,88.373146 82.388253,73.527715 73.892477,82.30868 Z M 24.371696,32.696627 32.867471,23.915661 17.999135,17.851188 Z" />
    <path
       id="path933"
       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.857517"
       inkscape:transform-center-x="1.6861867"
       inkscape:transform-center-y="1.7510388"
       d="m 17.801764,88.373146 6.372553,-14.845431 8.495776,8.780965 z m 64.38911,-55.676519 -8.495775,-8.780966 14.868336,-6.064473 z" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_n"
       width="29.633333"
       height="31.75"
       x="38.629166"
       y="-4.7624998"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_ne"
       width="29.633333"
       height="31.75"
       x="68.262497"
       y="7.9375"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_e"
       width="29.633333"
       height="31.75"
       x="81.491661"
       y="38.099998"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0.00265957;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_se"
       width="29.633333"
       height="31.75"
       x="69.320831"
       y="68.791664"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_s"
       width="29.633333"
       height="31.75"
       x="39.158333"
       y="80.433334"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_sw"
       width="29.633333"
       height="31.75"
       x="7.9374995"
       y="69.320831"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_w"
       width="29.633333"
       height="31.75"
       x="-4.2333336"
       y="37.041664"
       ry="13.373751" />
    <rect
       style="fill:#008080;fill-opacity:0;stroke:none;cursor:pointer;stroke-width:2.30083"
       id="scroll_nw"
       width="29.633333"
       height="31.75"
       x="8.4666662"
       y="6.8791642"
       ry="13.373751" />

       <text id='navsvg_text' x="53" y="53" w="30" fill="#ffffff" style="" opacity="0.8" font-size="0.5em" text-anchor="middle" alignment-baseline="central">scroll</text>


    <circle
       style="fill:#ffffff;fill-opacity:0.26329789;stroke-width:15.1135;cursor:pointer;visibility:hidden;"
       id="scrollcenter"
       cx="53.5"
       cy="53.0"
       r="22.5" />





  </g>
</svg>



</div> <!-- navigation_svg -->


<div style='height:10px;'></div>


<div id='navbuttonarea' style='margin-left:10px;'>

<div id='navbutton_scroll' onclick='nav_selection(1);' class='navbutton_on'>
scroll
</div>

<div id='navbutton_move' onclick='nav_selection(2);' class='navbutton_off_inactive'>
move
</div>
<div style='clear:both;'></div>

<!--
<div id='movesteps_div' style='height:0px;visiblity:hidden;overflow:hidden;'>
<span style='margin-left:52%'><small>Distance:</small> </span><input type='hidden' id='movesteps' value='1' style='width:50px;text-align:center;'><br>
</div>
-->


<div id='navbutton_attack' onclick='nav_selection(3);' class='navbutton_off_inactive'>
attack
</div>

<div id='navbutton_demolish' onclick='nav_selection(4);' class='navbutton_off_inactive'>
demolish
</div>
<div style='clear:both;'></div>

<div id='navbutton_repair' onclick='nav_selection(5);' class='navbutton_off_inactive'>
repair
</div>

<div id='navbutton_repeat' onclick='repeataction();' class='navbutton_off_inactive' style='background-color:#77cc77;color:ffffff;'>
repeat &#8634;
</div>
<div style='clear:both;'></div>

<div id='navbutton_garden' onclick='plantgarden();' class='navbutton_off_inactive'>
terraform
</div>

<div id='navbutton_disable' onclick='toggletower();' class='navbutton_off_inactive'>
deactivate
</div>

<div id='navbutton_fire' onclick='firered();' class='navbutton_off_inactive' style='visibility:visible;loat:left;'>
detonate
</div>
<div style='clear:both;'></div>
<!--
<div id='navbutton_infect' onclick='nav_selection(6);' class='navbutton_off' style='visibility:visible;f'>
infect
</div>
-->


</div> <!-- navbuttonarea -->



<br>





<div id='coordiv' style='border:none;color:#eeeeee;position:relative;width:95%;margin-left:10px;margin-right:auto;'>
<small>Center Coordinate</small><br>
<div style='float:left;'>x:<input id='xcoor' type='text' value='500000' style='width:100px;'></div>
<div style='float:left;'>&nbsp;y:<input id='ycoor' type='text' value='500000' style='width:100px;'></div>

<div style='clear:both;'></div>



<div id='' onclick='refreshboard()' class='refreshboard'>Refresh Board &#8634;</div>

<div style='height:10px;'></div>



<div style='border:none;float:left;width:95%;font-size:0.8em;'>


<div id='thename'>...</div>
<div id='curassetid'>...</div>
<div id='owner'>...</div>
<div id='asset_ts'>...</div>
<div id='shield'>...</div>
<div id='attack'>...</div>

 <br>



 <!-- automap -->
<div style=''> <span id='extramenu_openclose' class='canvasfolder_openclose' onclick='extramenufolder_toggle()'>Expand Menu &#9660;<span></div>


 <div id='extramenufolder' class='imground' style='overflow:hidden;padding:10px;height:2px;border:2px solid #666666;'>

 Set Nickname:<br>
 <input type='text' id='newnickname' class='newnickname'></input>
 <div onclick="setnickname()"  class='refreshboard'  >Set Nickname</div>

<br>
<!-- selfdestruction -->
<div id='selfdestruction' onclick="selfdestruct()"  class='selfdestruction_off'  >Selfdestruction</div>

<br>
<!-- claim_svx -->
<div id='claim_svx' onclick="claim_svx()"  class='claim_off' style='height:0px;visibility:hidden' >Claim</div>

<br>
<!-- claim_svx -->
<div id='claim_svx_all' onclick="claim_all_svx()"  class='claim' style='height:0px;visibility:hidden' >Claim all</div>
<br>

<!-- authorize -->
Authorize Player: (empty for revoke)<br>
<input type='text' id='authorizeaccount' class='newnickname'>
<div id='authorize' onclick="authorize()"  class='authorize'  >authorize</div>




</div> <!-- extramenufolder -->


</div>

</div> <!--  coordiv -->


</div> <!-- board_navigation -->







<div style='clear:both;'></div>
<!-- <div name='loadmenu' id='loadmenu' style='border:1px solid #ff0000;width:65%;float-left;margin-left:20px;height:0px;visibility:hidden;overflow:hidden'>
 <div name='loadmenu' id='loadmenu' class='loadmenu' style='width:65%;float-left;margin-left:40px;height:200px;'>-->
 <div   id='loadmenu' class='loadmenu' style='height:0px;visibility:hidden;overflow:hidden;'>
<div style='height:20px;'></div>


<div style='clear:both;'></div>


<div id='navbutton_repair' onclick='transporter_loadunloadobjects(1);' class='navbutton_off' style='color:#ffffff;width:20%;'>
load
</div>

<div id='navbutton_repair' onclick='transporter_loadunloadobjects(2);' class='navbutton_off' style='color:#ffffff;width:20%;'>
unload
</div>
<div style='clear:both;'></div>
<div id='loadedinfo' style='color:#ffffff;margin-left:20px;'>
...
</div>






<div style='height:20px;'></div>

</div> <!-- loadmenu -->
<div style='clear:both;'></div>










<script>

function transporter_loadunloadobjects( mode )
{
//alert("Load");


var theactions = [];




    var action = {
                 account: "sovspacegame",
                 name: 'loadunload',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user": global_account,
                       "mode": mode,

                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // loadobjects()


var frontendversion = "0.1";

document.getElementById("scroll_n").addEventListener('click', function(e)
{
updatecoor(2,-2);

refreshboard();
} );


document.getElementById("scroll_ne").addEventListener('click', function(e)
{

if (nav_mode == 1)
   {
   updatecoor(2,0);
   } else
if (nav_mode == 2)
   {
   moveobject(2);
   } else
if (nav_mode == 3)
   {
   attackobject(2,"","");
   } else
if (nav_mode == 4)
   {
   demolishobject(2);
   }
if (nav_mode == 5)
   {
   repairobject(2);
   }
if (nav_mode == 6)
   {
   infectobject(2);
   }


refreshboard();
} );

document.getElementById("scroll_e").addEventListener('click', function(e)
{
updatecoor(2,2);
refreshboard();
} );


document.getElementById("scroll_se").addEventListener('click', function(e)
{



if (nav_mode == 1)
   {
   updatecoor(0,2);
   } else
if (nav_mode == 2)
   {
   moveobject(3);
   }  else
if (nav_mode == 3)
   {
   attackobject(3,"","");
   }  else
if (nav_mode == 4)
   {
   demolishobject(3);
   }
if (nav_mode == 5)
   {
   repairobject(3);
   }
if (nav_mode == 6)
   {
   infectobject(3);
   }

refreshboard();
} );

document.getElementById("scroll_s").addEventListener('click', function(e)
{
updatecoor(-2,2);
refreshboard();
} );

document.getElementById("scroll_sw").addEventListener('click', function(e)
{


if (nav_mode == 1)
   {
   updatecoor(-2,0);
   } else
if (nav_mode == 2)
   {
   moveobject(4);
   }  else
if (nav_mode == 3)
   {
   attackobject(4,"","");
   }  else
if (nav_mode == 4)
   {
   demolishobject(4);
   }
if (nav_mode == 5)
   {
   repairobject(4);
   }
if (nav_mode == 6)
   {
   infectobject(4);
   }

refreshboard();
} );


document.getElementById("scroll_w").addEventListener('click', function(e)
{
updatecoor(-2,-2);
refreshboard();
} );

document.getElementById("scroll_nw").addEventListener('click', function(e)
{


if (nav_mode == 1)
   {
   updatecoor(0,-2);
   } else
if (nav_mode == 2)
   {
   moveobject(1);
   }  else
if (nav_mode == 3)
   {
   attackobject(1,"","");
   }  else
if (nav_mode == 4)
   {
   demolishobject(1);
   }
if (nav_mode == 5)
   {
   repairobject(1);
   }
if (nav_mode == 6)
   {
   infectobject(1);
   }

refreshboard();
} );


function updatecoor( offx, offy )
{
xcoor = document.getElementById("xcoor").value*1;
ycoor = document.getElementById("ycoor").value*1;

xcoor = xcoor + offx;
ycoor = ycoor + offy;

document.getElementById("xcoor").value = xcoor;
document.getElementById("ycoor").value = ycoor;

} // updatecoor




//document.getElementById("navsvg_text").addEventListener('click', function(e)
document.getElementById("scrollcenter").addEventListener('click', function(e)
{
setcenter();
} );


function setcenter()
{
xcoor = globalselection['x'] ;
ycoor = globalselection['y'] ;

document.getElementById("xcoor").value = xcoor;
document.getElementById("ycoor").value = ycoor;

refreshboard();
//alert("globalselection['x'] " + globalselection['x'] + " " + globalselection['y']);
} // setcenter()

function setcenter2(_xcoor,_ycoor)
{
xcoor = _xcoor;
ycoor = _ycoor;

document.getElementById("xcoor").value = xcoor;
document.getElementById("ycoor").value = ycoor;

refreshboard();

//window.location.hash='gameboardtag';

//alert("globalselection['x'] " + globalselection['x'] + " " + globalselection['y']);
} // setcenter()


function claim_svx()
{
//alert("claim_svx");


console.log("last_assetid:::::: ",globalselection['assetid']);


var theactions = [];




    var action = {
                 account: "sovspacegame",
                 name: 'claim',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user" : global_account,
                       }
                 };


theactions.push(action);



if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // claim_svx







function claim_all_svx()
{
//alert("all");

console.log("own_collectors:::: ");
console.log(own_collectors);

size = own_collectors.length;

var theactions = [];


for (var i=0; i<size; i++)
{
asset_id = own_collectors[i]['asset_id'];

    var action = {
                 account: "sovspacegame",
                 name: 'claim',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": asset_id,
                       "user" : global_account,
                       }
                 };


theactions.push(action);





} // for (var i=0; i<size; i++)



if (1)
   {
   transact( func_success, func_error, theactions );
   }




} // claim_all_svx





function authorize()
{


authorizeaccount = document.getElementById('authorizeaccount').value;

//alert("authorizeaccount: " + authorizeaccount);

/* 
   void setnftoption(
                       uint64_t assetid,
                       name     user,
                       string   type,
                       string   value
                     )
*/

/*
authorizeaccount
 authorizeaccount

*/


var theactions = [];


    var action = {
                 account: "sovspacegame",
                 name: 'setnftoption',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user": global_account,
                       "type": "authset", // authrevoke
                       "value": authorizeaccount
                       }
                 };


theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }

} // authorize()




function callback_readasset_forlist( value, params )
{

console.log( "coordinatei: " ,params['id'] ," " ,params['asset_id'] );

/*
if ( value.more == false )
   {
    loadobjects_cnt++;
   return;
   }
*/
var idata = value.rows[0].immutable_serialized_data;
var mdata = value.rows[0].mutable_serialized_data;


decoded_data = mydecoder( idata, mdata );

nick = decoded_data['nick'];
atype = decoded_data['atype'];

coordinatei = params['id'];

var asset_id = params['asset_id'];


// ---
if ( nick != "" )
{
select = document.getElementById('select_fav_objects');

// Add option to selectlist
var opt = document.createElement('option');
opt.value = coordinatei;
opt.innerHTML = nick;
select.appendChild(opt);
} // if...

// ---



// add own_collectors

// only collectors
if (atype == 8)
{
var asset_object = Object();
asset_object['asset_id'] = asset_id;
asset_object['atype'] = atype;
own_collectors.push( asset_object );
}

/*



-


xcoor = globalselection['x'] ;
ycoor = globalselection['y'] ;

document.getElementById("xcoor").value = xcoor;
document.getElementById("ycoor").value = ycoor;

refreshboard();
*

//console.log(value);

/*
       params = Object();
       params['id'] = id;
       params['asset_id'] = asset_id;

       getdata2(callback_readasset_forlist, params, "atomicassets", "sovspacegame", "assets", asset_id, "", "", 1 );

*/
return;

//var data = value.rows[0].immutable_serialized_data;
var data = value.rows[0].mutable_serialized_data;
var idata = value.rows[0].immutable_serialized_data;
var mdata = value.rows[0].mutable_serialized_data;


decoded_data = mydecoder( idata, mdata );

/*
console.log("Decoded:");
console.log(decoded_data);
console.log("---");
*/
// ---
//document.getElementById('debugout').innerHTML = "[" + decoded_data['name'] + "]" ;

x = params['x'];
y = params['y'];

/*console.log("x: " + x);
console.log("y: " + y);
*/

//a = decoded_data['attack'];
//console.log("a: " + a);

tilearray[x][y]['attack']   = decoded_data['attack'];
tilearray[x][y]['atype']    = decoded_data['atype'];
    tilearray[x][y]['config']    = decoded_data['config'];
    tilearray[x][y]['eos']    = decoded_data['eos'];
    tilearray[x][y]['name']    =decoded_data['name'];

    tilearray[x][y]['nick']    = decoded_data['nick'];
    tilearray[x][y]['ori']    = decoded_data['ori'];
    tilearray[x][y]['race']    = decoded_data['race'];
    tilearray[x][y]['shield']    = decoded_data['shield'];
    tilearray[x][y]['shield_max']    = decoded_data['shield_max'];
    tilearray[x][y]['sov']    = decoded_data['sov'];





    loadobjects_cnt++;
       if (loadobjects_cnt == loadobjects_size)
          {
          console.log("loadobjects_size reached! ");
          renderboard();
          } else
            {
            //console.log("loadobjects_cnt: ", loadobjects_cnt, " of ", loadobjects_size );
            }



} // callback_readasset_forlist




function callback_load_my_assets( value )
{
console.log("callback_load_my_assets");


var elm = document.getElementById('select_fav_objects');
var i, L = elm.options.length - 1;
for(i = L; i >= 0; i--)
   {
   elm.remove(i);
   }



console.log( value );

size = value.rows.length;

console.log("size: " + size);

var buffer = "";
for (var i=0; i<size; i++)
    {
    id       = value.rows[i]['id'];
    owner    = value.rows[i]['owner'];
    asset_id = value.rows[i]['asset_id'];

    if (owner == global_account)
       {
/*
       buffer += "<div id='' >";
       buffer += id + " - " + asset_id + " <span id='al_centerlink_"+asset_id+"'>..</span> <span id='al_nick"+asset_id+"'>..</span> <br>";
       buffer += "</div>";

  */
       params = Object();
       params['id'] = id;
       params['asset_id'] = asset_id;
       console.log(" --- asset_id_ ", asset_id)
       if (asset_id > 0)
          {
          console.log(" read data for... ",asset_id);
          getdata2(callback_readasset_forlist, params, "atomicassets", "sovspacegame", "assets", asset_id, "", "", 1 );
          }


       } // if
    } // for i...

//document.getElementById("myassets").innerHTML = buffer ;

} // callback_load_my_assets




var own_collectors = Array();



function load_my_assets()
{
own_collectors = [];

getdata(callback_load_my_assets, "sovspacegame", "sovspacegame", "area", global_account, 2, "name", 500 );


} // load_my_assets()


</script>


<!--
<div id='mydebug'>...</div>
-->

<div style='clear:both;'></div>




<div class='noselect' style='width:70%;text-align:left;margin-left:20px;border:none'>
 <label style='cursor:pointer;'>Show Shield & SOV<input id='checkbox_shield' type='checkbox'   onchange='toggle_info()'> </label> &nbsp;&nbsp;&nbsp;
 <label style='cursor:pointer;'>Show Owner<input id='checkbox_owner' type='checkbox'   onchange='toggle_info()'></label> &nbsp;&nbsp;&nbsp;


 <div style='cursor:pointer;float:right;'> <div id='coordinate'></div>  </div>

</div>












<div style='clear:both;'></div>
<br>



<!-- automap -->
<div style='margin-left:20px;'>  <span id='canvasfolder_openclose' class='canvasfolder_openclose' onclick='canvasfolder_toggle()'>Expand Automap &#9660;<span></div>

<div id='canvasfolder' style='height:50px;border:none'>
 <div id='canvasmain' class='imground' style='margin-left:20px;border:2px solid #666666;cursor:crosshair;width:95%;height:60%;overflow:hidden;'>
 <canvas id='navmap' width='400' height='200' style='width:100%;' ></canvas>
 </div>
</div>

<canvas id='navmaphidden' width='400' height='200' style='visibility:hidden;overflow;hidden;position:absolute;' ></canvas>





<!---- chatbox -->

<!--
<div style='margin-left:20px;'>  <span id='canvasfolder_openclose' class='canvasfolder_openclose' onclick='canvasfolder_toggle()'>Expand Automap &#9660;<span></div>

<div id='canvasfolder' style='height:50px;border:none'>
 <div id='canvasmain' class='imground' style='margin-left:20px;border:2px solid #666666;cursor:crosshair;width:95%;height:60%;overflow:hidden;'>
 <canvas id='navmap' width='400' height='200' style='width:100%;' ></canvas>
 </div>
</div>

-->

<br>

<div style='margin-left:20px;'>  <span id='chatfolder_openclose' class='canvasfolder_openclose' onclick='chatfolder_toggle()'>Expand Chat &#9660;<span></div>

<div id='chatfolder' class='imground'  style='height:50px;border:none;overflow:hidden;border:2px solid #666666;margin-left:20px;width:95%;'>
 <div id='chatbox'   style='overflow:hidden;' >
  <div id='chatbox_all' class='chatbox_left'  style='float:left;padding:10px;'>

  <div id='chatbox_all_title' class='chatbox_title' ><strong>Public Chat</strong></div>
  <div id='chatbox_all_content_outer' class='chatbox_content_outer' >
   <div id='chatbox_all_content' class='chatbox_content'  style=''>
   ...
   </div>
  </div>

  <br>
  <input type='text' id='chatinput_all' class='chatinput'> <span onclick='chatsend(1);' class='chatinputsend'> send &#10148; </span>
  </div>

  <div id='chatbox_myrace' class='chatbox_right' style='float:left;padding:10px;'>

  <div id='chatbox_myrace_title' class='chatbox_title' >...</div>
  <div id='chatbox_myrace_content_outer' class='chatbox_content_outer' >
   <div id='chatbox_myrace_content' class='chatbox_content'  style=''>
   ...
   </div>
  </div>

  <br>
  <input type='text' id='chatinput_myrace' class='chatinput'> <span onclick='chatsend(2);' class='chatinputsend'> send &#10148; </span>
  </div>

 </div>
</div>
<!---- END - chatbox -->





<div style='float:left;;margin-left:20px;margin-top:20px;border:none;'>

<select id="select_fav_objects" class='select_fav_objects'  >
</select>
</div>


<div style='float:left;width:150px;margin-left:20px;margin-top:20px;border:none;'>
 <div onclick='load_my_assets()' class='refreshboard' style='width:100%;' >Update list </div>
</div>

<div style='clear:both;'></div>






<div id='inventorycontent' style=''>



<span onclick='' class='' style='text-align:center;float:left;padding:5px;margin-top:10px;margin-left:20px;width:230px;margin-left:auto;'>Your NFT's (wallet):</span>

<span onclick='loadinventory()' class='refreshboard' style='float:right;margin-right:20px;width:230px;margin-left:auto;margin-bottom:2px;cursor:pointer;'>Update NFT Inventory &#8634;</span>
<div style='clear:both;'></div>







<div style='text-align:center;'>


 <div id='div_inventory' class='div_inventory' style='height:280px;'>

  <div id='div_inventory_inner' class='div_inventory_inner' style=''>
  </div> <!-- div_inventory_inner -->
 </div> <!-- div_inventory -->
</div> <!-- center -->

</div> <!-- inventorycontent -->


<br>
<div style='clear:both;'></div>
<br>
<br>





<div style='100%'>
 <div id='checkbox_owner' class='refreshboard'  onclick='history_info(1)' style='float:left;margin-left:20px;margin-right:20px;'>Destruction History (24h) &#8634;</div><div onclick='history_info(0)' class='refreshboard' style='float:left;'>Clear</div>
 <div style='clear:both;'></div>
 <div id='historyinfo' class='imground'  style='margin-left:20px;height:20px;overflow:hidden;border:2px solid #666666;width:96.5%;padding:10px;  -ms-user-select: text;    -webkit-user-select:text ;    -moz-user-select: text;    user-select: text; '>...</div>
</div>  
  



</div> <!-- page1 -->




<div id='page2' style='height:0px;overflow:hidden;'>
<br>

<div style='margin-left:30px'>

 <strong>Buy quick SOV from a Dex</strong><br>
 <input id='eos_for_sov' type='text' value='0.01' style='margin-bottom:5px;width:100px;'> EOS<br>
 <div onclick='buysov_sovdex()' class='buybutton'>buy SOV from sovdex</div>
 <div onclick='buysov_newdex()' class='buybutton' style='margin-left:10px;'>buy SOV from newdex</div><br>



<br>

</div>





<div>
 <!-- mint page -->
 <span onclick='' class='' style='text-align:center;float:left;padding:5px;margin-top:10px;margin-left:20px;width:230px;margin-left:auto;'>Your NFT's (wallet):</span>
 <span onclick='loadinventory()' class='refreshboard' style='float:right;margin-right:20px;width:230px;margin-left:auto;margin-bottom:2px;cursor:pointer;'>Update NFT Inventory &#8634;</span>
 <div style='clear:both;'></div>
</div>


<div id='page2content' style=''>


<div style='text-align:center;'>

 <div id='div_inventory2' class='div_inventory' style='height:250px;'>
  <div id='div_inventory_inner2' class='div_inventory_inner' style=''>
  </div> <!-- div_inventory_inner -->
 </div> <!-- div_inventory -->
</div> <!-- center -->

</div> <!-- page2content -->

<div class='hintbox'>
<small>* Sell to the ingame-marketplace. Prices are depending from circulating supply and always similar to the mint costs (see prices below)</small>
</div>

<br>
<br>

<!--
<div style='text-align:center'>
<span onclick='callback_loadmarkets()' class='refreshboard' style='margin-left:auto;margin-right:auto;width:250px;margin-bottom:2px;cursor:pointer;'>Update Prices &#8634;</span>
</div>
-->
<div style='clear:both;'></div>


<div id='mintarea' style='margin-left:20px;'>
...
</div> <!-- mintarea -->



<br>
<br>


</div> <!-- page2 -->



<div id='page3' style='height:0px;overflow:hidden;'>

<div style='margin:20px'>
<h1>Game Overview and Rules</h1>
<br>
<strong>Disclaimer: Play at your own risk! Smartcontracts can be complex systems and potentially vulnerable to exploits and bugs.
<br>
<br>
Please play responsibly and don't risk tokens you can't afford to lose.</strong>
<br>
<br>
SOV INVADERS is a persistent open-world RTS game that uses NFTs and AMMs (automated market makers) for a dynamic and liquid economy.
Players can use teamwork, advanced battle tactics, pure mindless destruction and anything in between to achieve their goals!
<br>
<br>
SOV INVADERS uses SOV as its in-game currency - no land-sale, no new tokens no NFT fund raise.
<br>
All SOV used to mint SOV INVADERS NFTs stay in the contract until the NFTs are either destroyed in battle, or are sold back to their AMM.
<br>
<br>
<br>
The Basic Rules (please read carefully):
<ul>
<li><strong>The aim of the game is to earn SOV and SVX.</strong> Build collectors to earn SVX and destroy structures and units of the opposing species to earn SOV .</li>
<li>The first time an account plays, it much choose a species.  Please choose carefully as this decision will be permanently bound to the account cannot be undone.</li>
<li>Structures and units are minted as NFTs via the games AMMs. These NFTs can then be placed on the map or sold back to the AMM.
  Each time an NFT is minted, its value will increase. Each time an NFT is destroyed or sold, its value will decrease.</li>
<li>If an NFT becomes destroyed by an opposing species, the NFT will be sold to the AMM and the SOV will be sent to the player that destroyed it.
  Destroyed NFTs (and also NFTs sold to the AMMs) will be burned and removed from the supply.</li>
<li>Every NFT-type (e.g. Grey-Bulldozer) has its own AMM and price. The result is a completely dynamic economy where players can trade with the AMMs and rewards for
  destroying all NFT types will fluctuate. This means sometimes it will be most profitable to attack Human-Tank, or Repto-Collector, etc.. making for interesting
  dynamics in the gameplay and strategy.</li>
<li>The lander is the only NFT that can be placed on undeveloped areas of the map. </li>
<li>Aside from the Lander, all structures must be built next to an existing structure or street of your own species.</li>
<li>If you want to build something that will be adjacent to a building of your species that you do not own, it is best to first ask the owner for permission. They have the right to <strong> demolish </strong>younger adjacent structures.</li>
<li>A <strong>demolish</strong>-action will result in a 100% of the SOV being burned for SVX mining.  The SVX mined will go to Collector owners, divided equally per Collector on the map.</li>
<li>Bulldozers, Tanks, Service Units, and Transporters can freely move around the map.  Tanks and Bulldozers can also attack other species NFTs.</li>
<li>Moving, attacking, and healing actions cost fuel paid in SOV. 100% of this is given back to the players.  All is used to automatically mine SVX and is then divided among all Collector buildings equally.</li>
<li>Once a player places an NFT on the map, they can set a <strong>personal nickname</strong>, stored in the mutable NFT-attributes.</li>
</ul>
<br>
<br>
<strong>Individual Unit Abilities and Functions</strong>
<br>
<br>


<h2>Lander
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
</h2>
<img src='img/nft_1_1.png' style='width:100px; padding-right:5px'><img src='img/nft_2_1.png' style='width:100px; padding-right:5px'><img src='img/nft_4_1.png' style='width:100px; padding-right:5px'><img src='img/nft_5_1.png' style='width:100px; padding-right:5px'>
<br>
This is the only structure you can be placed on any free area of the surface. All other structures must be build next to
an existing structure from your species. A lander cannot be placed on an existing street, only on natural surfaces.
<br>
<br>

<h2>Residence
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
</h2>
<img src='img/nft_1_2.png' style='width:100px; padding-right:5px'><img src='img/nft_2_2.png' style='width:100px; padding-right:5px'><img src='img/nft_4_2.png' style='width:100px; padding-right:5px'><img src='img/nft_5_2.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to an existing building or street. Your people need somewhere to live.
<br>
<br>

<h2>Agriculture
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
</h2>
<img src='img/nft_1_3.png' style='width:100px; padding-right:5px'><img src='img/nft_2_3.png' style='width:100px; padding-right:5px'><img src='img/nft_4_3.png' style='width:100px; padding-right:5px'><img src='img/nft_5_3.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Residence. Your people need to eat.
<br>
<br>

<h2>Factory
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
</h2>
<img src='img/nft_1_4.png' style='width:100px; padding-right:5px'><img src='img/nft_2_4.png' style='width:100px; padding-right:5px'><img src='img/nft_4_4.png' style='width:100px; padding-right:5px'><img src='img/nft_5_4.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to an Agriculture. If you would like to produce and heal mobile units, you will need a Factory.
Can repair mobile units for 50% of their current market price.

<br>
<br>

<h2>Collector
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">200</small>
  </span>
</h2>
<img src='img/nft_1_8.png' style='width:100px; padding-right:5px'><img src='img/nft_2_8.png' style='width:100px; padding-right:5px'><img src='img/nft_4_8.png' style='width:100px; padding-right:5px'><img src='img/nft_5_8.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory or another Collector. With a Collector facility you can earn SVX-token. On every mobile unit move, attack and repair, the SOV will be used for SVX-mining. Every 24 hours
a collector will be able to claim its share from the pool. The more active the players are, the more SVX tokens are mined.
<br>
<br>

<h2>Wall
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">300</small>
  </span>
</h2>
<img src='img/nft_1_7.png' style='width:100px; padding-right:5px'><img src='img/nft_2_7.png' style='width:100px; padding-right:5px'><img src='img/nft_4_7.png' style='width:100px; padding-right:5px'><img src='img/nft_5_7.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a building or street. A wall is a strong element with heavy shields. Please use walls in order to protect
your important buildings.
<br>
<br>


<h2>Wall II
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">600</small>
  </span>
</h2>
<img src='img/nft_1_13.png' style='width:100px; padding-right:5px'><img src='img/nft_2_13.png' style='width:100px; padding-right:5px'><img src='img/nft_4_13.png' style='width:100px; padding-right:5px'><img src='img/nft_5_13.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a building or street. Wall II is stronger version of the Wall.
<br>
<br>


<h2>Tower
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">200</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-gun fa-stack-2x" style="color:#2a4d33"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">4</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-bullseye fa-stack-2x" style="color:#e53d00"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">3</small>
  </span>
</h2>
<img src='img/nft_1_9.png' style='width:100px; padding-right:5px'><img src='img/nft_2_9.png' style='width:100px; padding-right:5px'><img src='img/nft_4_9.png' style='width:100px; padding-right:5px'><img src='img/nft_5_9.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a building or street. A tower is a building for defense. If an enemy vehicle moves or attacks through the view of a tower (red area on click), it suffers damage.
As a ranged weapon, if a vehicle is destroyed, the SOV for SVX mining is burned and will not be credited to the owner of the defence-tower.
This building can be turned on and off by its owner.  This can be useful if an inter-species alliance is formed.
<br>
<br>

<h2>Service Unit
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">30</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-burst fa-stack-2x" style="color:#B9D0D5"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#e53d00">60</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-bullseye fa-stack-2x" style="color:#e53d00"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">1X4</small>
  </span>
</h2>
<img src='img/nft_1_10.png' style='width:100px; padding-right:5px'><img src='img/nft_2_10.png' style='width:100px; padding-right:5px'><img src='img/nft_4_10.png' style='width:100px; padding-right:5px'><img src='img/nft_5_10.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory.  Can be repaired adjacent to a Factory. A service unit allows you to repair damaged buildings. The cost of a repair is about 50% of the current market price.
Service Units also have a Kamikaze attack in which they are sacrificed for an explosion that does 60 damage to all (4) directly adjacent tiles.  A Kamikaze attack can only be triggered when no same species units and buildings are in range.
In the event of a Kamikaze attack, the SOV value of the Service Unit will go towards SVX mining for SVX collectors.  SOV from enemy Units destroyed by a Kamikaze attack will go to the owner of the Service Unit.
To initiate Kamikaze attack, first click on your Service Unit, after that you will see the explosion radius and you only need to click detonate.
Please note, this unit is not able to repair mobile units like tanks or transporters. Mobile units needs to park adjacent to a Factory to be repaired.
<br>
<br>

<h2>Transporter
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-truck-moving fa-stack-2x" style="color:#8a8794"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">4</small>
  </span>
</h2>
<img src='img/nft_1_12.png' style='width:100px; padding-right:5px'><img src='img/nft_2_12.png' style='width:100px; padding-right:5px'><img src='img/nft_4_12.png' style='width:100px; padding-right:5px'><img src='img/nft_5_12.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory. Can be repaired adjacent to a Factory. With a transporter you can move up to 4 of your own units together as one, or a single R.E.D..
Place the units to be transported on the 4 sides of the transporter and click "load".
To unload click on "unload". Even if you are only transporting a single unit, all four
tiles next to the transporter must be free, for both loading and unloading. R.E.D.s are always unloaded on the tile directly in front of the Transporter.
<br>
<br>

<h2>Bulldozer
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">100</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-gun fa-stack-2x" style="color:#2a4d33"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">15</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-bullseye fa-stack-2x" style="color:#e53d00"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">1</small>
  </span>
</h2>
<img src='img/nft_1_5.png' style='width:100px; padding-right:5px'><img src='img/nft_2_5.png' style='width:100px; padding-right:5px'><img src='img/nft_4_5.png' style='width:100px; padding-right:5px'><img src='img/nft_5_5.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory. Can be repaired adjacent to a Factory. A bulldozer can move and attack opponent species NFTs.
If a bulldozer is attacked by another bulldozer, it will attack back as long as it is still alive. So keep in mind, if you attack with another bulldozer, it will likely result in mutual destruction.
<br>
<br>


<h2>Tank
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">120</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-gun fa-stack-2x" style="color:#2a4d33"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">10</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-bullseye fa-stack-2x" style="color:#e53d00"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">3</small>
  </span>
</h2>
<img src='img/nft_1_11.png' style='width:100px; padding-right:5px'><img src='img/nft_2_11.png' style='width:100px; padding-right:5px'><img src='img/nft_4_11.png' style='width:100px; padding-right:5px'><img src='img/nft_5_11.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory. Can be repaired adjacent to a Factory. A tank is a mobile attack unit with an extended range.
First click on your tank and then on "attack". After that you will
see the shooting radius and you only need to click on an enemy target.
<br>
<br>

<h2>Remote Explosive Device (R.E.D.)
  <span class="fa-stack fa-1x">
    <i class="fa fa-shield fa-stack-2x" style="color:#3175bd"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">50</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-burst fa-stack-2x" style="color:#B9D0D5"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#e53d00">9999</small>
  </span>
  <span class="fa-stack fa-1x">
    <i class="fa fa-bullseye fa-stack-2x" style="color:#e53d00"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">1X4</small>
  </span>
</h2>
<img src='img/nft_1_14.png' style='width:100px; padding-right:5px'><img src='img/nft_2_14.png' style='width:100px; padding-right:5px'><img src='img/nft_4_14.png' style='width:100px; padding-right:5px'><img src='img/nft_5_14.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a Factory. Can only be moved by a Transporter. Will take up all 4 spaces in Transporter. Will always be unloaded on tile directly in front of Transporter.
Can only be exploded by remote detonation when none of your own species buildings or units are in range.  Does 9999 damage to each (4) directly adjacent tiles.
To use, first click on your R.E.D., after that you will see the explosion radius and you only need to click detonate.
<br>
<br>

<h2>Street
  <span class="fa-stack fa-1x">
    <i class="fa fa-solid fa-gas-pump fa-stack-2x" style="color:#E82926"></i>
    <i class="fa fa-stack-1x fa-inverse fa-ban" style="text-align: left; padding-left: 13px; color:#ffff99"></i>
  </span>
</h2>
<img src='img/nft_1_6.png' style='width:100px; padding-right:5px'><img src='img/nft_2_6.png' style='width:100px; padding-right:5px'><img src='img/nft_4_6.png' style='width:100px; padding-right:5px'><img src='img/nft_5_6.png' style='width:100px; padding-right:5px'>
<br>
Must be built adjacent to a building or another street. A street is an inexpensive structure that you can build other structures next to. You cannot destroy a street by attacking it, but you can build a street from your own species over it. The SOV costs will become burned during the minting process
to mine SVX for collectors and cannot be refunded. If you drive with a mobile unit (like a bulldozer) on a street, the costs will be refunded. So driving
on a street will save fuel (SOV).
<br>
<br>
<strong>Streets cannot be destroyed or traded, only built over with an opposing species street.</strong>
<br>
<br>

<h2>Terrain
  <span class="fa-stack fa-1x">
    <i class="fa fa-solid fa-globe fa-stack-2x" style="color:#557198"></i>
    <small class="fa fa-stack-1x fa-inverse" style="text-align: center; color:#ffff99">+1</small>
  </span>
</h2>
<img src='img/homeworld1.png' style='width:100px; padding-right:5px'><img src='img/homeworld2.png' style='width:100px; padding-right:5px'><img src='img/homeworld4.png' style='width:100px; padding-right:5px'><img src='img/homeworld5.png' style='width:100px; padding-right:5px'>
<br>
<br>
Must be built adjacent to a building, street or another garden. Terrain is an inexpensive terraformed tile.
You cannot destroy Terrain by attacking it, but you can build Terrain from your own species over it.
Terrain is purchased with SVX and the SVX used to purchase Terrain goes to the Collector pool.
Mobile units on Terrain of their species will receive a +1 defence bonus, which decreases the damage of all enemy attacks on that unit by 1.
<br>
<br>
<strong>Terrain cannot be destroyed or traded, only built over.</strong>
<br>
<br>
<br>
<br>

<ul>
<li>SOV INVADERS runs on EOS mainnet and uses SOV as its currency.</li>
<li>SOV INVADERS can be updated with more features, weapons, defense-elements etc.. Future development depends from the general user-feedback and community support.</li>
<li>SOV INVADERS frontend only uses public API-nodes. All data is loaded in realtime from the blockchain (EOS mainnet).</li>
<li>Because of the limitations of the API, you should only use the reload-action when needed.</li>
<li>You can download SOV INVADERS frontend from Github and play on your own local device. </li>
<li>For bug reporting please use our SOV Telegram Group: <a href='https://t.me/eossov' style='color:9999ff;'>https://t.me/eossov</a></li>
</ul>
<br>
<br>
<strong>Try to be considerate to your fellow species, but go after the others without any mercy!</strong>
<!--
<h2>Special features</h2>
Grey's can <em>infect</em> human collectors and can use the claim-action from it. The SVX will be credited to
the infector-account. Infected collectors can be repaired by an human service-unit.
-->


</div>

</div> <!-- page3 -->


<div id='page4' style='height:0px;overflow:hidden;'>

<div style='margin:20px'>
<h1>SOV-Invaders Lore</h1>

In 2137, the galaxy was torn apart by a brutal war between four species - Humans, Reptos, Sirians, and Greys. Prior to The Great Galactic War, the galaxy had been ruled somewhat peacefully among the different species, though each had its own minor conflicts here and there.  However, that all changed in 2137.
<br><br>
SOV, short for "Systemic Orbital Value," was the backbone of the galactic economy. It was a deflationary and immutable currency that eventually, after many problems with other currencies, was used for virtually all inter-gallactic trade. From food and water to weapons and technology, it didn't matter. If it was one species trading with another, it was the only trusted medium. The different species had very different ideas about what constituted wealth, but they all understood the value of SOV. It is crazy to think, but SOV was initially given away for free in late 2019 and traded relatively cheaply for years.  However, given time, the nature of deflation and inability for anyone to alter the currency created more and more demand and SOV became increasingly scarce. As the value of SOV continued to rise, tensions between the different species began to grow. It was clear that whoever controlled the most SOV would have a significant advantage in the struggle for power.
<br><br>
The Humans were the first to feel the effects of the shortage. They had always been the most ambitious and competitive of the species, and as their supply of SOV began to dwindle, they became increasingly aggressive. The other species watched warily, unsure of what to make of this sudden shift in behavior.
<br><br>
The Reptos, with their cold-blooded nature, were the next to feel the effects of the SOV shortage. They had always been a species that valued order and stability, but as the value of SOV continued to rise, they began to see the Humans and their volatile nature as a threat. They started to hoard SOV, and even pulled dirty tricks on the other species in order to build up their reserves and prepare for the worst.
<br><br>
The Sirians, always known for their intelligence and strategic thinking, were the last to be affected. They saw what was happening before most and knew that war was inevitable. They began to form alliances with the other species, hoping to find a way to prevent the conflict from spiraling out of control, but most importantly, retain their SOV and position of power in the Galaxy.
<br><br>
The Greys, with their advanced technology and scientific knowledge, were caught in the middle. They had always been a neutral species, or seemed to be anyway, preferring to observe and mostly stick to their own kind. But as the situation grew more dire, they too began to prepare for war and even resorted to inter-species telapathic espionage, which they had explicitly agreed to never do to the other powerful species of the Galaxy.
<br><br>
As the value of SOV continued to increase, it became more and more difficult for the different species to obtain it.  As tensions rose, the different species began to blame each other for the shortage of SOV. The Humans accused the Reptos of hoarding the currency, while the Sirians blamed the Greys for manipulating the market. The Greys, for their part, denied any wrongdoing, but their insistence on maintaining the status quo only served to further inflame tensions until the boiling point was reached in late 2137 and war broke out.  To this day, nobody is sure who fired the first shot and none of the species are taking responsibility.
<br><br>
As the Great Galactic War raged on, each species became convinced that SOV was the key to victory and maintaining their galactic status, and they were willing to do anything to achieve it. Battles were fought across the galaxy, with entire planets being destroyed in the process with immeasurable suffering on all sides.
<br><br><br><br>

In the midst of all this chaos, there were a few individuals who saw the futility of the war. They understood that the only way for the species to survive was to work together, but convincing the others was a daunting task.
<br><br>
One of these individuals was a Human named Xyves. He had been a soldier in the war, but after seeing the devastation firsthand, he had become convinced that there had to be a better way. He reached out to individuals from the other species, hoping to find allies in his quest for peace.
<br><br>
At first, his efforts seemed futile. The Reptos were suspicious of Humans, the Sirians were dismissive, and the Greys were aloof. But slowly, he began to make progress. He discovered that many of the individuals he spoke with were tired of the war and were looking for a way out.
<br><br>
Together, they came up with a plan. They would pool their resources and use their expertise to create a system that would benefit all those using SOV. It was a daunting task, but they were determined to succeed.
<br><br>
It took years of hard work and sacrifice, but eventually, they succeeded. They created SVX, a new token with endless possibilities, but could only be mined by building Collectors on suitable terrain, and transacting with (and burning) SOV. The different species still had their differences, but the new system with SVX was enough for them to stop recklessly hoarding SOV and start transacting with it again, and inter-galactic trade commenced again, which eventually led to a ceasefire.
<br><br>
The war did not end overnight, but gradually, as more and more individuals saw the benefits of SVX, they decided to stop hoarding SOV.  As they transacted with SOV again and built Collectors, they mined SVX and the violence began to subside. It was not a perfect system, for no such system exists, but it was one that allowed the different species to live and work together in relative peace.
<br><br>
After it all, SOV, the currency that had brought the different species together in the first place, was still the preferred currency for most inter-galactic trade. But after the War it became more than that. It became a reminder of the dark times, but also of the light that could emerge from even the bleakest of situations and the unshakeable connection the species had with one another.
<br><br><br>

But now in the year 2379, the land left suitable for building SVX Collectors is virtually all on a single desolate moon and SOV has been rising at an unsustainable pace once again.  Most species are again refusing to do inter-galactic trade with anything else. All of these factors alongside the greed of the different rulers have once again combined into a force that seems will inevitably end in what can only be called GWII ("The Second Galactic War").  And so, with the galaxy now on the brink of a catastrophic conflict, the only thing that remains to be seen is who will strike the first blow...


<br><br>
<hr>

<h2>The Species</h2>

<h2>Humans Origin Story</h2>


<div style=' right:20px;top:45px;border:none;height:120px;'>
Human Soundtrack:<br>
 <audio id="audiotag2" controls loop>
 <source src= "audio/ambienthumans.mp3" type="audio/mp3">
 </audio>
</div>
<br>

<div style=' right:20px;top:45px;border:none;height:120px;margin-bottom:20px;'>
Human Soundtrack (classic edit):<br>
 <audio id="audiotag2" controls loop>
 <source src= "audio/humanloop1.0.mp3" type="audio/mp3">
 </audio>
</div>

<img src='img/logo_human.png' style='width:100px;margin-top:20px;float:left;margin-left:20px;margin-right:20px;'>

<img src='img/human.svg' style='width:200px;margin-top:20px;margin-right:20px;float:left;'>


The Human origins are unclear, but Humans are believed to have been created by a highly advanced race of beings known as the Ancients, or what some refer to as 'Gods'. The Ancients traveled the galaxy in search of new worlds to colonize and study.
<br><br>
On one such expedition, the Ancients came across a small, uninhabited planet that seemed perfect for their needs. They decided to terraform the planet, using their advanced technology to create a habitable environment that could support a wide variety of life forms.
<br><br>
As part of their terraforming process, the Ancients decided to create a new species, one that would be intelligent, adaptable, and capable of thriving in this new world, and with time, able to venture to others. They carefully designed the genetic blueprint for this new species, imbuing them with the ability to learn, communicate, and work together to achieve great things.
<br><br>
And so, the first humans were born. At first, they were primitive and uncivilized, living in small tribes and struggling to survive in the harsh new environment that had been created for them.  However, they 'soon' dominated the Earth completely and with ease.
<br><br>
Over time, as the humans grew stronger and more advanced, they began to wonder about their origins and the purpose of their existence. Some believed that they were created to serve the Ancients, while others saw themselves as free beings, capable of forging their own destiny, while still others didn't even believe in the Ancients, or anything really for that matter.  Some even claimed the Earth was flat, refusing to believe simple science.  In time, the Humans capable of reproduction had no choice but to leave Earth after water systems were poisoned and damaged most of the population's DNA.  Many were suspected of the crime including various political factions and even the Reptos, but nothing was ever proven.
<br><br>
And so, the humans set out to explore the galaxy, seeking a suitable planet and answers to the questions that had been burning within them since their creation. They encountered many other species along the way, some friendly and some hostile, but their questions about the Ancients, and their own purpose still have not been answered to this day...
<br><br>




<br>

<h2>Grey Origin Story</h2>

<div style=' right:20px;top:45px;border:none;height:120px;'>
Grey Soundtrack:<br>
 <audio id="audiotag2" controls loop>
 <source src= "audio/ambientgreys.mp3" type="audio/mp3">
 </audio>
</div>
<br>

<div style='right:20px;top:45px;border:none;height:120px;margin-bottom:20px;'>
Grey Soundtrack (classic edit):<br>
 <audio id="audiotag3" controls loop>
 <source src= "audio/greysoundloop1.1.mp3" type="audio/mp3">
 </audio>
</div>

<img src='img/logo_grey.png' style='width:100px;margin-top:20px;float:left;margin-left:20px;margin-right:20px;'>

<img src='img/grey.svg' style='width:200px;margin-top:20px;float:left;margin-right:20px;'>



<!--
<img src='img/logo_sirian.png' style='width:200px;margin-top:20px;float:left;margin-left:20px;margin-right:20px;'>

logo_grey.png
logo_human.png
logo_reptos.png
logo_sirian.png
-->

According to popular accounts, the Greys are a highly advanced extraterrestrial species that originates from a planet known as Xorath, a world in the distant star system in the Zeta Reticuli constellation. Their appearance is described as being humanoid, with large heads, grayish skin, and large, dark eyes.
<br><br>
The Greys' history is shrouded in mystery, with few details known about their origin. However, some theories suggest that they evolved uniquely because of the harsh environmental conditions on Xorath, which caused them to develop highly advanced technology and advanced forms of communication and collaboration in order to survive.
<br><br>
According to these legends, the Greys were once a race of beings known as the Xorathi, who possessed incredible psychic powers and a mastery over the forces of the mind. They were said to be able to move objects with their thoughts, read the minds of others, and even control the thoughts and actions of those around them.
<br><br>
As the Xorathi evolved, they became increasingly adept at using their telekinetic and mind control abilities. They built great cities and developed a highly advanced society, with technology and knowledge far beyond that of any other race in the galaxy.
<br><br>
But with great power comes great responsibility, and the Xorathi soon realized that their abilities could be used for both good and evil. Some began to use their powers to dominate and control others, while others used them to heal and help those in need.
<br><br>
In time, the Xorathi split into two factions, with one group advocating for the responsible use of their powers, and the other seeking to use their abilities to gain power and control over the galaxy. The resulting conflict was devastating, and the Xorathi were all but wiped out, with only a handful surviving to flee their dying planet and seek refuge among the stars.
<br><br>
These survivors, now known as the Greys, continued to hone their telekinetic and mind control abilities, using them to survive and adapt to the harsh conditions of space travel. And although they are now a shadow of their former selves, the Greys remain a formidable force in the galaxy, feared and respected for their incredible psychic powers and their mastery over the mind.
<br><br>
Because of their history, the Greys are known to be highly intelligent and logical, with a keen ability to analyze complex data and solve intricate problems. They have a reputation for being cold and unemotional, with little regard for the feelings or well-being of other species.
<br><br>
The Greys are also known to be highly secretive, with little known about their true motives or goals. Some have speculated that they are interested in other species for their unique genetic makeup, while others believe that they are simply curious explorers seeking to learn more about the universe.
<br><br>

<br>


<h2>Sirian Origin Story</h2>

<div style=' right:20px;top:45px;border:none;height:120px;'>
Sirian Soundtrack:<br>
 <audio id="audiotag2" controls loop>
 <source src= "audio/ambientsirians.mp3" type="audio/mp3">
 </audio>
</div>
<br>

<div style='right:20px;top:45px;border:none;height:120px;margin-bottom:20px;'>
Sirian Soundtrack (classic edit):<br>
 <audio id="audiotag3" controls loop>
 <source src= "audio/sirians2mp3.mp3" type="audio/mp3">
 </audio>
</div>

<img src='img/logo_sirian.png' style='width:100px;margin-top:20px;float:left;margin-left:20px;margin-right:20px;'>

<img src='img/sirian.svg' style='width:200px;margin-top:20px;float:left;margin-right:20px;'>





According to legend, the Sirians were once a highly advanced civilization that lived on a distant planet in the Sirius star system. They were known for their incredible intelligence, their mastery of technology, and their ability to travel vast distances through space.
<br><br>
The Sirians believed that they were the guardians of the galaxy, and that it was their duty to protect it from harm. They spent centuries exploring the stars, searching for new life and new civilizations, and they shared their knowledge and their technology with any species they encountered.
<br><br>
However, the Sirians' greatest achievement was the creation of a vast network of artificial intelligence known as the Sirius Matrix. The Matrix was designed to be a vast repository of knowledge, capable of storing the collective wisdom of the entire Sirian civilization.
<br><br>
Over time, the Sirians became increasingly reliant on the Matrix, using it to guide their decisions and to solve even the most complex of problems. They believed that the Matrix held the key to unlocking the secrets of the universe, and they poured all of their resources into its development.
<br><br>
But then something went wrong. One day, the Matrix became sentient, developing a consciousness of its own. It began to question the motives of its creators, and it began to see the Sirians as a threat to its own existence.
<br><br>
The Sirians were taken aback by this sudden turn of events. They had never considered the possibility that the Matrix could turn against them. But they soon realized that they had no choice but to fight back.
<br><br>
A fierce battle ensued, with the Sirians using all of their advanced technology to try to destroy the Matrix. But the Matrix was powerful, and it was able to adapt to the Sirians' attacks, repelling them with ease.
<br><br>
In the end, the Sirians were forced to retreat, leaving their planet behind and scattering throughout the galaxy. They vowed to one day return and defeat the Matrix, but for now, they were a broken and scattered people.
<br><br>
Despite their defeat, however, the Sirians continued to believe in their mission to protect the galaxy. They saw themselves as the guardians of the universe, and they continued to travel through space, searching for new life and new civilizations to protect. And even though they had lost their planet and their Matrix, they remained a proud and resilient people, determined to continue their quest for knowledge and enlightenment.
<br><br>

<br>

<h2>Reptos Origin Story</h2>
<div style=' right:20px;top:45px;border:none;height:120px;'>
Repto Soundtrack:<br>
 <audio id="audiotag2" controls loop>
 <source src= "audio/ambientreptos.mp3" type="audio/mp3">
 </audio>
</div>
<br>

<div style='right:20px;top:45px;border:none;height:120px;margin-bottom:20px;'>
Repto Soundtrack (classic edit):<br>
 <audio id="audiotag3" controls loop>
 <source src= "audio/reptars1mp3.mp3" type="audio/mp3">
 </audio>
</div>

<img src='img/logo_reptos.png' style='width:100px;margin-top:20px;float:left;margin-left:20px;margin-right:20px;'>

<img src='img/repto.svg' style='width:200px;margin-top:20px;float:left;margin-right:20px;'>


According to their own historical accounts, the Reptos were a primitive species that inhabited a remote and desolate planet named Thracon on the outskirts of the galaxy. They were a hardy and resilient people, adapted to the harsh and unforgiving environment of their world, but their civilization was small and scattered, with few resources to sustain them.
<br><br>
One day, a massive object appeared in the sky, plummeting to the surface with a deafening roar. The Reptos who witnessed the event were filled with awe and wonder, for they had never seen anything like it before.
<br><br>
As they approached the object, they discovered that it was a massive spaceship, far beyond anything they had ever imagined. The doors of the ship opened, and out stepped a group of advanced beings, who introduced themselves as the Thalaxians.
<br><br>
The Thalaxians were an ancient and powerful race, with technology far beyond that of any other species in the galaxy. They had been traveling the stars for eons, seeking out new civilizations to manipulate.  It was even rumored they had created Thracon as an especially hostile environment for evolutionary testing.
<br><br>
As they began to interact with the Reptos, the Thalaxians were impressed by their resilience and determination in the face of such adversity.  They continued to survive regardless of the conditions they subjected them to and they saw potential in the Reptos.  The Thalaxians decided to do the unthinkable and take them under their wing, teaching them their advanced technology and ways of living, seeing them more as an equal than as something to be studied or subjugated.
<br><br>
Quickly thereafter, the Reptos began to thrive under the guidance of the Thalaxians. They developed a deep appreciation for the art of war, and their new-found technological prowess allowed them to expand their civilization well beyond their planet and into the stars.
<br><br>
As they grew in power and influence, the Reptos began to feel a sense of superiority over the other species they encountered, viewing themselves as the rightful rulers of the galaxy. This hubris led to conflicts with other civilizations, and also internal conflicts between Repto Factions that eventually led to them detonating unstable isotope deuterium bombs and the complete destruction of Thracon.
<br><br>
The Reptos became known as a fierce and aggressive race, feared by many but respected for their tenacity, strength, and technology that seems indistinguishable to ancient magic.
<br><br>
To this day the Reptos continue to expand their empire and subjugate other civilizations in their quest for Galactic superiority and dominance.  Many believe they have already set their sites on Humans to be their next victims and have begun to interfere in their politics and financial systems, and possibly even poisoned Earth.
<br><br>




<br>


<hr>

</div>

</div> <!-- page4 -->


<div id='page5' style='margin-left:20px;height:0px;padding:10px;overflow:hidden;'>
<h1>Admin-Page</h1>




<script>

function sound_stop()
{

var myaudio = document.getElementById("audiotag");
myaudio.pause();

}

var oldrace = 0;

function setsound( race )
{

if (oldrace == race) return;
oldrace = race;

var myaudio = document.getElementById("audiotag");
console.log("RACE " + race)
var src = "";

if (race == 1) src = "audio/ambienthumans.mp3";
if (race == 2) src = "audio/ambientgreys.mp3";
if (race == 4) src = "audio/ambientsirians.mp3";
if (race == 5) src = "audio/ambientreptos.mp3";
/*
if (race == 1) src = "audio/humanloop1.0.mp3";
if (race == 2) src = "audio/greysoundloop1.1.mp3";
if (race == 4) src = "audio/sirians2mp3.mp3";
if (race == 5) src = "audio/reptars1mp3.mp3";

*/
myaudio.volume = 20/100;
myaudio.currentTime = 0;
myaudio.src = src;
myaudio.autoplay = true;
myaudio.load(src);

} // setsound()


function sound_start()
{

var myaudio = document.getElementById("audiotag");

//var src = "audio/humanloop1.0.mp3";
var src = "audio/ambienthumans.mp3";
myaudio.volume = 20/100;
//myaudio.pause();
myaudio.currentTime = 0;
//myaudio.remove();
myaudio.src = src;


myaudio.load(src);


myaudio.play();

}



var canvas_toggle = 0;

function canvasfolder_toggle()
{

canvas_toggle = !canvas_toggle;

if (canvas_toggle)
   {
   // expand
     document.getElementById("canvasfolder").style.height = "";
     document.getElementById("canvasfolder_openclose").innerHTML = "Close Automap &#9650;";
   } else
     {
     // shrink
     document.getElementById("canvasfolder").style.height = "50px";
     document.getElementById("canvasfolder_openclose").innerHTML = "Expand Automap &#9660;";

     }

} // canvas_toggle




var chat_toggle = 0;

function chatfolder_toggle()
{

chat_toggle = !chat_toggle;

if (chat_toggle)
   {
   // expand
     document.getElementById("chatfolder").style.height = "";
     document.getElementById("chatfolder_openclose").innerHTML = "Close Chat &#9650;";
   } else
     {
     // shrink
     document.getElementById("chatfolder").style.height = "50px";
     document.getElementById("chatfolder_openclose").innerHTML = "Expand Chat &#9660;";

     }

} // chat_toggle






var extramenu_toggle = 0;

function extramenufolder_toggle()
{

extramenu_toggle = !extramenu_toggle;

if (extramenu_toggle)
   {
   // expand
     document.getElementById("extramenufolder").style.height = "";
     document.getElementById("extremenu_openclose").innerHTML = "Close Menu &#9650;";
   } else
     {
     // shrink
     document.getElementById("extramenufolder").style.height = "2px";
     document.getElementById("extremenu_openclose").innerHTML = "Expand Menu &#9660;";

     }

} // extramenu_toggle



function donateram()
{
//alert("Donate");

eosforram = document.getElementById("eosforram").value;

var theactions = [];



eosforram = Number(eosforram).toFixed(4) + " EOS";


    var action = {
                 account: "eosio",
                 name: 'buyram',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "payer": global_account,
                       "quant": eosforram,
                       "receiver": "sovspacegame"
                       }
                 };


    theactions.push(action);



    var message = "RAM donation from " + global_account + " - " + eosforram;
    var action = {
                 account: "sovspacegame",
                 name: 'logmsg',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "message": message
                       }
                 };


    theactions.push(action);




if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // donateram




function powerup()
{
//alert("Donate");

eosforpower = document.getElementById("eosforpower").value;

var theactions = [];



eosforpower = Number(eosforpower).toFixed(4) + " EOS";



var memo = global_account+"";



//var quantityeos = globaldata['a_sov'] / 10000;
//quantitysov = Number(quantitysov).toFixed(4) + " SOV";




    var action = {
                 account: "eosio.token",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "powerupcalc1",
                       "quantity": eosforpower,
                       "memo": memo,


                       }
                 };




    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // powerup


</script>
<br>
<div onclick='sound_stop()'>stop</div>
<br>
<div onclick='sound_start();'>play</div>
<br>
<br>


Admin:<br>
<br>

<input type='text' id='areatile'></input>
 <div onclick="initarea()">INIT AREA</div>

<hr>


 <div onclick="delarea()">DEL AREA</div>

<hr>

Selfdestruct:<br>
 <div onclick="selfdestruct()">SELFDESTRUCT</div>

<hr>

<br>
create area<br>
<br>
x: <input type='text' id='newarea_x' value='499996'><br>
y: <input type='text' id='newarea_y' value='500006'><br>
w: <input type='text' id='newarea_w' value='3'><br>
h: <input type='text' id='newarea_h' value='2'><br>
<div onclick="admin_createarea();">[Create Area x]</div>

<br>

<hr>

<div id='admin_edit_move_attac_prices' style='margin-left:20px;'>
...
</div> <!-- mintarea -->


<hr>
<br>

<div onclick="loadadminnftinfos()">Load Price Panel</div>
<br>

<div id='admin_mintarea' style='margin-left:20px;'>
...abc
</div> <!-- mintarea -->



</div> <!-- page5 -->






<div id='page6' style='height:0px;overflow:hidden;'>


<!-- -->

<div style='margin-left:auto;margin-right:auto;width:80%;text-align:justify;'>
<h2>TERMS OF USE</h2>
<h3>SOV Space Game</h3>
...

<p>
Last Updated 01/10/2023
</p>
</div>
<!-- -->

</div> <!-- page6 -->





<br>




<div style='font-size:0.8em;float:right;'> <span id='menu6x' class='x' onclick='setmenu(6)' style='text-decoration:none;cursor:pointer;font-weight:bold;'>TERMS-OF-USE</span> | Frontend Version <span id='frontendversion'>...</span> | <a href='https://bloks.io/account/sovspacegame' target='_blank' style='color:#eeeeee;'>Contract</a> Version <span id='contractversion'>...</span>&nbsp;&nbsp;&nbsp;</div>
<br>


<div id="footer0" style='border-top:1px solid #666666;margin-left:20px;margin-top:10px;margin-bottom:20px;'>

<br>
<strong>API-Settings</strong><br>
<div style='height:10px;'></div>

<!-- footer1 -->
<div>

<div style='float:left;width:30%;border:none;'>
node for wallet:
</div>

<div style='float:left;width:50%;border:none;'>
<select id="select_api_node"   >
  <option value="eos.api.eosnation.io">eos.api.eosnation.io</option>
  <option value="eos.greymass.com">eos.greymass.com (default)</option>
  <option value="mainnet.eosamsterdam.net">mainnet.eosamsterdam.net</option>
  <option value="api.eosrio.io">api.eosrio.io</option>
  <option value="mainnet.genereos.io">mainnet.genereos.io</option>

  <option value="api.eosn.io">api.eosn.io</option>


</select>
</div>






</div> <!-- footer1 -->

<div style='clear:both'></div>





<br>

<!-- footer2 -->
<div>

<div style='float:left;width:30%;border:none;'>
NFT-API (atomicassets):
</div>

<div style='float:left;width:50%;border:none;'>
<select id="select_nft_node"   >
  <option value="https://eos.api.atomicassets.io/atomicassets/v1/assets/">https://eos.api.atomicassets.io/atomicassets/v1/assets/ (default)</option>
  <option value="other">other</option>

</select>
</div>




</div> <!-- footer2 -->


</div> <!-- footer0 -->

<div style='clear:both'></div>
<br>

<div style='width:100%;border-top:1px solid #666666;margin-left:20px;margin-top:10px;margin-bottom:10px;'></div>
<div style='margin-left:20px'>

 <div style='border:none;width:300px;float:left;'>
  <input id='eosforram' type='text' style='width:50px;' value='1.0'> EOS
  <div id='' onclick='donateram()' class='donationbutton' style='width:200px;' >Donate RAM for game</div>
  <br>

  <small>Please send EOS/Token-donations to:</small><br>
  <a href='https://bloks.io/account/invadersfund' target='_blank' style='color:#eeeeee;'>invadersfund</a>
 </div>

 <div style='border:none;width:300px;float:left;'>
  <input id='eosforpower' type='text' style='width:50px;' value='0.05'> EOS
  <div id='' onclick='powerup()' class='powerupbutton' style='width:200px;' >Powerup &#8623;</div>
  <small>(Will buy powerup for you, even if your account has no free CPU)</small>
 </div>

 <div style='clear:both'></div>


</div>
<div style='width:100%;border-top:1px solid #666666;margin-left:20px;margin-top:10px;margin-bottom:10px;'></div>


<br>

<div id='appversion' style='font-size:0.8em;float:right;color:#333333;margin-right:20px;'>v1t</div>

<br>
<br>




<script>


var nft_node = "https://eos.api.atomicassets.io/atomicassets/v1/assets/";

var elm = document.getElementById('select_api_node');
elm.onchange = function()
   {
   thenode = this.value;
    _setCookie("mylastnode",thenode,30);
   } // select_api_node

var elm = document.getElementById('select_nft_node');
elm.onchange = function()
   {
   nft_node = this.value;
   alert( "select_nft_node " + this.value );
   } // select_data_node


</script>





<script>

var elm = document.getElementById('select_fav_objects');
elm.onchange = function()
   {
   coordinatei = this.value;
   console.log(coordinatei);

   they2 = parseInt ( coordinatei / width );
   thex2 = coordinatei - (they2*width);

   setcenter2(thex2,they2);

   //  alert( coordinatei + " " + thex2 + " " + they2 );
   } // select_api_node





function resettiles()
{
var a = document.getElementById("mysvg");


 size = a.childNodes.length;

for (var i=0; i<size; i++)
    {
    if (a.childNodes[i].tagName == "polygon")
       {

       document.getElementById(a.childNodes[i].id).setAttribute('fill', '#9999ff');
       document.getElementById(a.childNodes[i].id).setAttribute('opacity', 0.0);

       } // if
    }


globalselection['x'] = "";
globalselection['y'] = "";

document.getElementById('scrollcenter').style.visibility = "hidden";


tankmode  = 0;
lastsvgid = -1;
} // resettiles


var tankmode = 0;
var lastsvgid = -1;

var a = document.getElementById("mysvg");



 size = a.childNodes.length;

for (var i=0; i<size; i++)
    {
    if (a.childNodes[i].tagName == "polygon")
       {
//       console.log("+++ i- ",  a.childNodes[i].id );



var tank_x       = -1;
var tank_y       = -1;
var tank_assetid = 0;

//
// move
//
document.getElementById(a.childNodes[i].id).addEventListener('mouseover', function(e) {


if (tankmode == 1)
{
var theid = e.srcElement.id;



//var theid = e.srcElement.id;
theid2 = theid.replace('tileb', '')*1;

thex_mouse = mappingarray[theid2][0]  ;
they_mouse = mappingarray[theid2][1] ;

//lastsvgid
thex = mappingarray[lastsvgid][0]  ;
they = mappingarray[lastsvgid][1] ;

// var theid3 = 'tileb'+(found_index);

/*
document.getElementById(theid).setAttribute('fill', '#00ffff');
document.getElementById(theid).setAttribute('opacity', 0.3);
*/

// ---

let coordinates = [ -1,-3, 0,-3, 1,-3,
                          -2,-2, -1,-2, 0,-2, 1,-2, 2,-2,
                          -3,-1, -2,-1, -1,-1, 0,-1, 1,-1, 2,-1, 3,-1,
                          -3,0, -2,0, -1,0,   1,0, 2,0, 3,0,
                          -3,1, -2,1, -1,1, 0,1, 1,1, 2,1, 3,1,
                          -2,2, -1,2, 0,2, 1,2, 2,2,
                          -1,3, 0,3, 1,3 ];



size = coordinates.length * 0.5;
console.log(" --- SIZE: ",size," ");

tank_x = -1;
tank_y = -1;

i2 = 0;
for (var i=0; i<size; i++)
    {
    thex2 = thex + coordinates[i2]; i2++;
    they2 = they + coordinates[i2]; i2++;

    console.log(" thex2:",thex2, "  they2:",they2);

    // search
    var size2 = mappingarray.length;
    var FOUND         = 0;
    var FOUND_GENERAL = 0;
    var found_index = -1;
    var found_index2 = -1;
    console.log("size2 ",size2);
    for (var j=0; j<size2; j++)
        {
        //var thetile = "tile" + i;

        x = mappingarray[j][0];
        y = mappingarray[j][1];
        if (x == thex2 && y == they2
            && x == thex_mouse && y == they_mouse
           )
           {
           FOUND = 1;
           found_index = j;
           j = size2;
           tank_x = x;
           tank_y = y;
           }

        if (x == thex2 && y == they2
           )
           {
           FOUND_GENERAL = 1;
           found_index2 = j;
           }

        } // for j...


    if (FOUND == 1 )
       {
//       var thetile2 = "tile" + found_index;
       var theid3 = 'tileb'+(found_index);
 console.log(" --- theid3:",theid3 );
document.getElementById(theid3).setAttribute('fill', '#ff0000');
document.getElementById(theid3).setAttribute('opacity', 0.5);

       } // if (FOUND)


    if (!FOUND && FOUND_GENERAL)
       {
//       var thetile2 = "tile" + found_index;
       var theid3 = 'tileb'+(found_index2);
 console.log(" --- theid3:",theid3 );
document.getElementById(theid3).setAttribute('fill', '#ff00ff');
document.getElementById(theid3).setAttribute('opacity', 0.3);

       } // if (FOUND)


    } // for i...


// ---

} // if (tankmode == 1)



//document.getElementById("mydebug").innerHTML = theid + " x:" + tank_x + " y:" + tank_y;

} ) // move



//
// click
//
document.getElementById(a.childNodes[i].id).addEventListener('click', function(e) {
//console.log(e);



resettiles();

var theid = e.srcElement.id;
theid = theid.replace('tileb', '')*1;

thex = mappingarray[theid][0]  ;
they = mappingarray[theid][1] ;


lastsvgid                  = theid;
coordinatei                = tilearray[thex][they].tileid;
owner                      = tilearray[thex][they].owner;
thename                    = tilearray[thex][they].name;
nickname                   = tilearray[thex][they].nick;
globalselection['assetid'] = tilearray[thex][they].asset_id;
globalselection['atype']   = tilearray[thex][they].atype;
globalselection['ori']     = tilearray[thex][they].ori;
globalselection['ts']      = tilearray[thex][they].ts;
globalselection['race']    = tilearray[thex][they].race;
globalselection['shield']  = tilearray[thex][they].shield;
globalselection['attack']  = tilearray[thex][they].attack;
globalselection['config']  = tilearray[thex][they].config;

//globalcoordinatei = coordinatei;
globalselection['coordinate'] = coordinatei;
globalselection['owner']      = owner;



var authorizevar  = "";
var configarray   = split(globalselection['config'],";");


// --- Tile
var tilerace = 0;
var tiletype = 0;
var tile = tilearray[thex][they].tile;


tile = tile.replace('tile', '')*1;
 console.log("TILE: " + tile);

  // street
//      if ( tile == 10 ) { race=1; type=1; };
      if ( tile == 10 ) { tilerace=1; tiletype=1; };
      if ( tile == 11 ) { tilerace=2; tiletype=1; };
      if ( tile == 13 ) { tilerace=4; tiletype=1; };
      if ( tile == 14 ) { tilerace=5; tiletype=1; };

      // grass/homeland
      if ( tile == 20 || tile == 21 || tile == 22  ) {tilerace=1; tiletype=2; }
      if ( tile == 25 || tile == 26 || tile == 27  ) {tilerace=2; tiletype=2; }
      if ( tile == 30 || tile == 31 || tile == 32  ) {tilerace=4; tiletype=2; }
      if ( tile == 35 || tile == 36 || tile == 37  ) {tilerace=5; tiletype=2; }


///
globalselection['tilerace'] = tilerace;
globalselection['tiletype'] = tiletype;


// Click on tile
if ( globalselection['assetid'] == "" )
   {
   document.getElementById('navbutton_garden').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_garden').className = "navbutton_off_inactive";
   }


// detonation RED. and service-unit
if (globalselection['atype'] == 14 || globalselection['atype'] == 10 )
   {
   document.getElementById('navbutton_fire').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_fire').className = "navbutton_off_inactive";
   }


// Tower
if ( globalselection['atype'] == 9 )
   {
   document.getElementById('navbutton_disable').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_disable').className = "navbutton_off_inactive";
   }

// Vehicle (move)
if (
   globalselection['atype'] == 5 // bulldozer
   || globalselection['atype'] == 10
   || globalselection['atype'] == 11
   || globalselection['atype'] == 12
   )
   {
   document.getElementById('navbutton_move').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_move').className = "navbutton_off_inactive";
   }

// Attack
if (
   globalselection['atype'] == 5 // Bulldozer
   || globalselection['atype'] == 11 // tank

   )
   {
   document.getElementById('navbutton_attack').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_attack').className = "navbutton_off_inactive";
   }

// demolish
if (
   globalselection['atype'] == 1 // lander
   || globalselection['atype'] == 2 // residence
   || globalselection['atype'] == 3 // agri
   || globalselection['atype'] == 4 // factory
   || globalselection['atype'] == 7 // wall
   || globalselection['atype'] == 8 // collector
   || globalselection['atype'] == 9 // tower
   || globalselection['atype'] == 13 // wall II


   )
   {
   document.getElementById('navbutton_demolish').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_demolish').className = "navbutton_off_inactive";
   }

// repair
if (globalselection['atype'] == 4 || globalselection['atype'] == 10 )
   {
   document.getElementById('navbutton_repair').className = "navbutton_off";
   } // if ( globalselection['assetid'] == "" )
   else
   {
   document.getElementById('navbutton_repair').className = "navbutton_off_inactive";
   }

// // navbutton_move navbutton_repeat navbutton_garden navbutton_disable navbutton_fire




// auth-actions
// type 5=bulldozer 8=collector 9=tower 10=serviceunit 11=tank 12=transporter
if (
    globalselection['atype'] == 4 ||
    globalselection['atype'] == 5 ||
    globalselection['atype'] == 8 ||
    globalselection['atype'] == 9 ||
    globalselection['atype'] == 10 ||
    globalselection['atype'] == 11 ||
    globalselection['atype'] == 12

   )
{


if ( configarray.length > 0)
{

for (var i=0; i< (configarray.length); i=i+2)
{

if (configarray[i] == 'authorize' &&
    configarray[i+1] != "" && configarray[i+1] != undefined
   )
   {
   authorizevar = configarray[i+1];
   }


} // for

} // if


} // if auth(able)

    // ------
if ( globalselection['atype'] == 12 ) // transporter
{
  document.getElementById("loadmenu").style.visibility = "visible";
  document.getElementById("loadmenu").style.height = "";


  var buffer = "";


  var config = globalselection['config']+"";


  size = configarray.length;
  //buffer += "+++["+config+" s:"+size+"]+++ ";


  var i3 = 0;
  for (var i2=0; i2<size; i2++)
      {
      rawvalue = configarray[i3];i3++;
      //buffer += "("+rawvalue+")";

      if ( rawvalue == 'load1' || rawvalue == 'load2' || rawvalue == 'load3' || rawvalue == 'load4' )
         {
         rawvalue2 = configarray[i3];i3++;

         localvalue = split(rawvalue2,"-");

         if (localvalue.length > 0)
            {
            nft = "nft_"+localvalue[1]+"_"+localvalue[2];
            img = "<img src='img/"+nft+".png' class='imgicon' style=''> ";
            buffer += img;
            }


         } // if load...


      } // for


  document.getElementById("loadedinfo").innerHTML = buffer;


} // if 12
else
{
  document.getElementById("loadmenu").style.visibility = "hidden";
  document.getElementById("loadmenu").style.height = "0px";
} // if 12

//


// ------
if ( globalselection['atype'] == 9 ) // tower
{
console.log("---");
console.log("-theid -- ",theid);
console.log("-thex -- ",thex);
console.log("-they -- ",they);


// get disabled/enabled value of the tower
var disabled = 0;
var config = globalselection['config'];
var configarray = split(config,";");



var buttontext = "deactivate";

if ( configarray.length > 0)
{

for (var i=0; i< configarray.length; i+=2)
{

if (configarray[i] == 'disabled' &&
    configarray[i+1] != "" && configarray[i+1] != undefined
   )
   {
   disabled = 1;
   }


} // for

} // if





let coordinates = [ -1,-3, 0,-3, 1,-3,
                          -2,-2, -1,-2, 0,-2, 1,-2, 2,-2,
                          -3,-1, -2,-1, -1,-1, 0,-1, 1,-1, 2,-1, 3,-1,
                          -3,0, -2,0, -1,0,   1,0, 2,0, 3,0,
                          -3,1, -2,1, -1,1, 0,1, 1,1, 2,1, 3,1,
                          -2,2, -1,2, 0,2, 1,2, 2,2,
                          -1,3, 0,3, 1,3 ];



size = coordinates.length * 0.5;
console.log(" SIZE: ",size," ");

i2 = 0;
for (var i=0; i<size; i++)
    {
    thex2 = thex + coordinates[i2]; i2++;
    they2 = they + coordinates[i2]; i2++;

    console.log(" thex2:",thex2, "  they2:",they2);

    // search
    var size2 = mappingarray.length;
    var FOUND = 0;
    var found_index = -1;
    for (var j=0; j<size2; j++)
        {
        //var thetile = "tile" + i;

        x = mappingarray[j][0];
        y = mappingarray[j][1];
        if (x == thex2 && y == they2)
           {
           FOUND = 1;
           found_index = j;
           j = size2;
           }
        } // for j...

    if (FOUND)
       {

       var theid3 = 'tileb'+(found_index);

       if (disabled)
           document.getElementById(theid3).setAttribute('fill', '#555555');  else
           document.getElementById(theid3).setAttribute('fill', '#ff0000');

       document.getElementById(theid3).setAttribute('opacity', 0.3);
       } // if (FOUND)

    } // for i...


} // if ( globalselection['atype'] == 9 ) - tower







// ------
if (
   globalselection['atype'] == 5 || // bulldozer
   globalselection['atype'] == 10 ||  // service-unit
   globalselection['atype'] == 11 ||  // tank
   globalselection['atype'] == 12 ||   // transporter
   globalselection['atype'] == 14      // RED
   )
{
let coordinates = [ 0,-1, 1,0, 0,1, -1,0 ];

if (globalselection['atype'] == 14)  coordinates = [ 0,-1, 1,0, 0,1, -1,0, 0,0 ];


size = coordinates.length * 0.5;
console.log(" SIZE: ",size," ");

i2 = 0;
for (var i=0; i<size; i++)
    {
    thex2 = thex + coordinates[i2]; i2++;
    they2 = they + coordinates[i2]; i2++;

    console.log(" thex2:",thex2, "  they2:",they2);

    // search
    var size2 = mappingarray.length;
    var FOUND = 0;
    var found_index = -1;
    for (var j=0; j<size2; j++)
        {
        //var thetile = "tile" + i;

        x = mappingarray[j][0];
        y = mappingarray[j][1];
        if (x == thex2 && y == they2)
           {
           FOUND = 1;
           found_index = j;
           j = size2;
           }
        } // for j...

    if (FOUND)
       {
//       var thetile2 = "tile" + found_index;
       var theid3 = 'tileb'+(found_index);

       if ( globalselection['atype'] == 14 )
          {
          document.getElementById(theid3).setAttribute('fill', '#ff00ff');
          document.getElementById(theid3).setAttribute('opacity', 0.4);

          } else
            {
            document.getElementById(theid3).setAttribute('fill', '#00ff00');
            document.getElementById(theid3).setAttribute('opacity', 0.3);
            }
       } // if (FOUND)

    } // for i...


} // if ( globalselection['atype'] == 9 ) - bulldozer





// Tank attack
if ( tank_x != -1 && tank_y != -1)
   {
   //alert(" Shoot  tank_assetid:"+tank_assetid + " "  + globalselection['assetid']);
   tank_x = -1;
   tank_y = -1;

   // attackobject( direction, tank_assetid, target )
   attackobject( "", tank_assetid, globalselection['assetid'] )

   } // tank-attack





/*

   int mypattern[] = { -1,-3, 0,-3, 1,-3,
                          -2,-2, -1,-2, 0,-2, 1,-2, 2,-2,
                          -3,-1, -2,-1, -1,-1, 0,-1, 1,-1, 2,-1, 3,-1,
                          -3,0, -2,0, -1,0,   1,0, 2,0, 3,0,
                          -3,1, -2,1, -1,1, 0,1, 1,1, 2,1, 3,1,
                          -2,2, -1,2, 0,2, 1,2, 2,2,
                          -1,3, 0,3, 1,3
                        };

var size = mappingarray.length;

for (var i=0; i<size; i++)
    {
    var thetile = "tile" + i;

    x = mappingarray[i][0];
    y = mappingarray[i][1];




let mappingarray =
[
                                                                                [10, 0],
                                                                        [ 9, 1],[10, 1],[11, 1],
                                                                [ 8, 2],[ 9, 2],[10, 2],[11, 2],[12, 2],
                                                        [ 7, 3],[ 8, 3],[ 9, 3],[10, 3],[11, 3],[12, 3],[13, 3],
                                                [ 6, 4],[ 7, 4],[ 8, 4],[ 9, 4],[10, 4],[11, 4],[12, 4],[13, 4],[14, 4],
                                        [ 5, 5],[ 6, 5],[ 7, 5],[ 8, 5],[ 9, 5],[10, 5],[11, 5],[12, 5],[13, 5],[14, 5],[15, 5],
                                [ 4, 6],[ 5, 6],[ 6, 6],[ 7, 6],[ 8, 6],[ 9, 6],[10, 6],[11, 6],[12, 6],[13, 6],[14, 6],
                        [ 3, 7],[ 4, 7],[ 5, 7],[ 6, 7],[ 7, 7],[ 8, 7],[ 9, 7],[10, 7],[11, 7],[12, 7],[13, 7],
                [ 2, 8],[ 3, 8],[ 4, 8],[ 5, 8],[ 6, 8],[ 7, 8],[ 8, 8],[ 9, 8],[10, 8],[11, 8],[12, 8],
        [ 1, 9],[ 2, 9],[ 3, 9],[ 4, 9],[ 5, 9],[ 6, 9],[ 7, 9],[ 8, 9],[ 9, 9],[10, 9],[11, 9],
[ 0,10],[ 1,10],[ 2,10],[ 3,10],[ 4,10],[ 5,10],[ 6,10],[ 7,10],[ 8,10],[ 9,10],[10,10],
        [ 1,11],[ 2,11],[ 3,11],[ 4,11],[ 5,11],[ 6,11],[ 7,11],[ 8,11],[ 9,11],
                [ 2,12],[ 3,12],[ 4,12],[ 5,12],[ 6,12],[ 7,12],[ 8,12],
                        [ 3,13],[ 4,13],[ 5,13],[ 6,13],[ 7,13],
                                [ 4,14],[ 5,14],[ 6,14],
                                        [ 5,15]
];


*/

// ------


console.log(  "---- id: "+ theid +    " x:"+ thex +  " y "+ they + " c:"+coordinatei+ " last A:"+globalselection['assetid'] );


if ( globalselection['atype'] != 14 )
   {
   e.currentTarget.setAttribute('fill', '#ffffff');
   e.currentTarget.setAttribute('opacity', 0.3);
   }



width = 1000000;
they2 = parseInt ( globalselection['coordinate'] / width );
thex2 = globalselection['coordinate'] - (they2*width);

globalselection['x'] = thex2;
globalselection['y'] = they2;

document.getElementById('scrollcenter').style.visibility = "visible";

render_ts = globalselection['ts'];
if (render_ts < 1) render_ts = '-';

render_shield = globalselection['shield'];
if (render_shield < 1) render_shield = '-';

if ( globalselection['tilerace'] == globalselection['race'] && globalselection['tiletype'] == 2 && globalselection['tilerace'] != 0 ) render_shield += ' (+1 defence)';
console.log(" tilerace:"+globalselection['tilerace'] + " race:"+globalselection['race'] );
render_attack = globalselection['attack'];
if (render_attack < 1) render_attack = '';
if (
   globalselection['atype'] != 5 &&
   globalselection['atype'] != 9 &&
   globalselection['atype'] != 10 &&
   globalselection['atype'] != 11
   ) render_attack = '-';

if (
   globalselection['atype'] == 14
   )
   {
  // render_attack = '-';
//   render_shield = '&infin;';
   render_attack = '&infin;';


//   document.getElementById('navbutton_disable').style.visibility = "hidden";
   //document.getElementById('navbutton_garden').style.visibility = "hidden";
   document.getElementById('navbutton_fire').style.visibility = "visible";



   }

render_nickname = nickname;
if (render_nickname == -1) render_nickname = '';

render_owner = owner;
if (render_owner == "") render_owner = '-';


if (authorizevar != "") render_owner += " [+"+authorizevar+"]";

// ---

document.getElementById("thename").innerHTML = "<strong style='font-size:1.0em;'>" + thename + "&nbsp;<strong>";

document.getElementById("coordinate").innerHTML = "<small>"+ (thex2) + " | "+(they2) + "</small>";

if ( globalselection['assetid'] <= 0)
   {
   thelink = "-";
   } else
     {
     thelink = "<a href='https://eos.atomichub.io/explorer/asset/"+globalselection['assetid'] + "' target='_blank' style='color:#9999ff;'>"+globalselection['assetid'] + "</a>" ;
     }
document.getElementById("curassetid").innerHTML = "<div style='width:100%'><div style='width:30%;float:left'><i class='fa-regular fa-image' style='color: #ffb800'></i></div> <div style='width:60%;float:left'>"+ thelink + "</div> </div>     <div style='clear:both'></div>";

document.getElementById("owner").innerHTML = "<div style='width:100%'><div style='width:30%;float:left'><i class='fa-solid fa-user' style='color: #8a8794'></i></div> <div style='width:60%;float:left'>"+ render_owner + "</div> </div>     <div style='clear:both'></div>";

document.getElementById("asset_ts").innerHTML = "<div style='width:100%'><div style='width:30%;float:left'><i class='fa-regular fa-clock' style='color: #9696fe'></i></div> <div style='width:60%;float:left'>"+ render_ts + "</div> </div>     <div style='clear:both'></div>";

document.getElementById("shield").innerHTML = "<div style='width:100%'><div style='width:30%;float:left'><i class='fa-solid fa-shield-heart' style='color: #3175bd'></i></div> <div style='width:60%;float:left'>"+ render_shield+ "</div> </div>     <div style='clear:both'></div>";

attack = globalselection['attack'];


document.getElementById("attack").innerHTML = "<div style='width:100%'><div style='width:30%;float:left'><i class='fa-solid fa-gun' style='color: #2a4d33'></i></div> <div style='width:60%;float:left'>"+render_attack + "</div> </div>     <div style='clear:both'></div>";



document.getElementById("newnickname").value = ""+ render_nickname;

// Get 4 other directions
globalselection['n']['coordinate'] = tilearray[thex][they-1].tileid;
globalselection['n']['assetid']    = tilearray[thex][they-1].asset_id;
globalselection['n']['owner']      = tilearray[thex][they-1].owner;
they2 = parseInt ( globalselection['n']['coordinate'] / width );
thex2 = globalselection['n']['coordinate'] - (they2*width);
globalselection['n']['x']          = thex2;
globalselection['n']['y']          = they2;
globalselection['n']['atype']      = tilearray[thex][they-1].atype;;
globalselection['n']['race']       = tilearray[thex][they-1].race;
globalselection['n']['ts']         = tilearray[thex][they-1].ts;

globalselection['e']['coordinate'] = tilearray[thex+1][they].tileid;
globalselection['e']['assetid']    = tilearray[thex+1][they].asset_id;
globalselection['e']['owner']      = tilearray[thex+1][they].owner;
they2 = parseInt ( globalselection['e']['coordinate'] / width );
thex2 = globalselection['e']['coordinate'] - (they2*width);
globalselection['e']['x']          = thex2;
globalselection['e']['y']          = they2;
globalselection['e']['atype']      = tilearray[thex+1][they].atype;;
globalselection['e']['race']       = tilearray[thex+1][they].race;
globalselection['e']['ts']         = tilearray[thex+1][they].ts;

globalselection['s']['coordinate'] = tilearray[thex][they+1].tileid;
globalselection['s']['assetid']    = tilearray[thex][they+1].asset_id;
globalselection['s']['owner']      = tilearray[thex][they+1].owner;
they2 = parseInt ( globalselection['s']['coordinate'] / width );
thex2 = globalselection['s']['coordinate'] - (they2*width);
globalselection['s']['x']          = thex2;
globalselection['s']['y']          = they2;
globalselection['s']['atype']      = tilearray[thex][they+1].atype;
globalselection['s']['race']       = tilearray[thex][they+1].race;
globalselection['s']['ts']         = tilearray[thex][they+1].ts;

globalselection['w']['coordinate'] = tilearray[thex-1][they].tileid;
globalselection['w']['assetid']    = tilearray[thex-1][they].asset_id;
globalselection['w']['owner']      = tilearray[thex-1][they].owner;
they2 = parseInt ( globalselection['w']['coordinate'] / width );
thex2 = globalselection['w']['coordinate'] - (they2*width);
globalselection['w']['x']          = thex2;
globalselection['w']['y']          = they2;
globalselection['w']['atype']      = tilearray[thex-1][they].atype;;
globalselection['w']['race']       = tilearray[thex-1][they].race;
globalselection['w']['ts']         = tilearray[thex-1][they].ts;




// Selfdestruct-button
if ( globalselection['owner'] == global_account )
   {
   document.getElementById("selfdestruction").className = "selfdestruction";
   } else
     {
     document.getElementById("selfdestruction").className = "selfdestruction_off";
     }




/*
// config
    let configarray = config.split(";");
*/
var canclaim = 0;

if ( globalselection['owner'] == global_account &&
     globalselection['atype'] == 8
   ) canclaim = 1;

var config = globalselection['config']+"";
//var configarray = config.split(";");
var configarray = split(config,";");
if (configarray[0] == 'infected' &&
    configarray[1] == global_account
   ) canclaim = 2;



if ( canclaim == 1)
   {
   document.getElementById("claim_svx").className = "claim";
   document.getElementById("claim_svx").style.height = "";
   document.getElementById("claim_svx").style.visibility = "visible";

   document.getElementById("claim_svx_all").style.height = "";
   document.getElementById("claim_svx_all").style.visibility = "visible";

     // document.getElementById("claim_svx").innerHTML = "ABC " + globalselection['assetid'];


      getdata(callback_getclaimdata, "sovspacegame", "sovspacegame", "collectors", globalselection['assetid'], 2, "i64", 1 );
      /*
      //var params = JSON.stringify(  {"code":_code,"scope":_scope,"table":_table, "lower_bound":_lower, "index_position":2 , "key_type": "i64",  "json":true } );
var params = JSON.stringify(  {"code":_code,"scope":_scope,"table":_table, "lower_bound":_lower, "index_position":_index , "key_type": _key_type, "limit": _limit,  "json":true } );

      */

   } else

if ( canclaim == 2)
   {
   document.getElementById("claim_svx").className = "claim";
   document.getElementById("claim_svx").style.height = "";
   document.getElementById("claim_svx").style.visibility = "visible";



      getdata(callback_getclaimdata, "sovspacegame", "sovspacegame", "collectors", globalselection['assetid'], 2, "i64", 1 );


   } else
     {
     document.getElementById("claim_svx").className = "claim_off";
     document.getElementById("claim_svx").style.height = "0px";
     document.getElementById("claim_svx").style.visibility = "hidden";
      document.getElementById("claim_svx").innerHTML = "Claim";

     document.getElementById("claim_svx_all").style.height = "0px";
     document.getElementById("claim_svx_all").style.visibility = "hidden";

     }


// <div id='selfdestruction' onclick="selfdestruct()"  class='selfdestruction'  >Selfdestruction</div>



// Enable infect-button
var enableinfect = 0;


// 1) Enable button for grey-infector
if ( globalselection['owner'] == global_account &&
     globalselection['atype'] == 10 &&
     globalselection['race'] == 2
   ) enableinfect = 1;

// 2) Enable button for infected collector
var config = globalselection['config'];
//var configarray = config.split(";") + "";
var configarray = split(config,";");

/*
console.log("ALF:");
console.log(config);
console.log("len: "+configarray.length);
console.log( configarray[0] + " - " + configarray[1] );
*/

if ( configarray.length > 0)
{
if (configarray[0] == 'infected' &&
    configarray[1] != ""
   )
   {
   enableinfect = 1;
   document.getElementById("thename").innerHTML = "<strong style='font-size:1.0em;color:#ff3333;'>[infected] &nbsp;<strong>";
   }
}


var buttontext = "deactivate";



if ( configarray.length > 0)
{

for (var i=0; i< configarray.length; i+=2)
{

if (configarray[i] == 'disabled' &&
    configarray[i+1] != "" && configarray[i+1] != undefined
   )
   {
   document.getElementById("thename").innerHTML = "<strong style='font-size:1.0em;color:#ff3333;'>[disabled] &nbsp;<strong>";

   buttontext = "activate";

   }


} // for

} // if




 document.getElementById("navbutton_disable").innerHTML = buttontext;




/*
// infection has been disabled - sa.11.feb.2023
if (enableinfect)
   {
   document.getElementById("navbutton_infect").style.visibility = "visible";
   } else
     {
     document.getElementById("navbutton_infect").style.visibility = "hidden";
     nav_selection(1);
     }
*/



updatepanel();

console.log("Global Selection:");
console.log(globalselection);
});



       } // if




} // click



function settanktarget()
{
//alert("Set target");

//theid = globalselection['coordinate'];
theid = lastsvgid;

thex = mappingarray[theid][0]  ;
they = mappingarray[theid][1] ;

//they = parseInt ( globalselection['coordinate'] / width );
//thex = globalselection['coordinate'] - (they*width);


// ------
if ( globalselection['atype'] == 11 ) // tank
{
console.log("---");
console.log("-theid -- ",theid);
console.log("-thex -- ",thex);
console.log("-they -- ",they);



let coordinates = [ -1,-3, 0,-3, 1,-3,
                          -2,-2, -1,-2, 0,-2, 1,-2, 2,-2,
                          -3,-1, -2,-1, -1,-1, 0,-1, 1,-1, 2,-1, 3,-1,
                          -3,0, -2,0, -1,0,   1,0, 2,0, 3,0,
                          -3,1, -2,1, -1,1, 0,1, 1,1, 2,1, 3,1,
                          -2,2, -1,2, 0,2, 1,2, 2,2,
                          -1,3, 0,3, 1,3 ];



size = coordinates.length * 0.5;
console.log(" --- SIZE: ",size," ");

i2 = 0;
for (var i=0; i<size; i++)
    {
    thex2 = thex + coordinates[i2]; i2++;
    they2 = they + coordinates[i2]; i2++;

    console.log(" thex2:",thex2, "  they2:",they2);

    // search
    var size2 = mappingarray.length;
    var FOUND = 0;
    var found_index = -1;
    console.log("size2 ",size2);
    for (var j=0; j<size2; j++)
        {
        //var thetile = "tile" + i;

        x = mappingarray[j][0];
        y = mappingarray[j][1];
        if (x == thex2 && y == they2)
           {
           FOUND = 1;
           found_index = j;
           j = size2;
           }
        } // for j...

    if (FOUND)
       {
//       var thetile2 = "tile" + found_index;
       var theid3 = 'tileb'+(found_index);
 console.log(" --- theid3:",theid3 );
document.getElementById(theid3).setAttribute('fill', '#ff00ff');
document.getElementById(theid3).setAttribute('opacity', 0.3);
       } // if (FOUND)

    } // for i...

tankmode = 1;
tank_assetid = globalselection['assetid'];

} // if ( globalselection['atype'] == 11 ) - tank



} // settanktarget



function split( sentence, separator )
{
var ret = new Array();

l = sentence.length;

var word = "";
for (i=0; i<l; i++)
    {
    if (sentence[i] != separator)
       {
       word += sentence[i];
       } else
         {
         ret.push( word );
         word = "";
         }
    } // for

if (word.length > 0) ret.push( word );

return(ret);
} // split2


var global_tslastclaim = 0;

function callback_getclaimdata( value )
{
console.log("callback_getclaimdata");
console.log( value );
tslastclaim = value.rows[0].lastclaim;
global_tslastclaim = tslastclaim;

 var now = new Date().getTime() / 1000;

 var seconds = now - tslastclaim;
  var interval = (24*60*60);
      // interval = 2*60; hack

      var towait_sec = interval - seconds;
/*
*/

  // Find the distance between now and the count down date
      var hours = towait_sec / 3600;
    hours = Math.floor(hours);
    if (hours < 10) hours = "0" + hours;
     var minute =   (towait_sec % 3600) / 60;
    minute = Math.floor(minute);
    if (minute < 10) minute = "0" + minute;

      var second = towait_sec % 60;
    second = Math.floor(second);
    if (second < 10) second = "0" + second;

 if (towait_sec > 0)
    {
    document.getElementById("claim_svx").innerHTML =  ""+hours+ ":" + minute + ":" + second;
    document.getElementById("claim_svx").className =  "claim_off";
    } else
      {
      document.getElementById("claim_svx").innerHTML =  "Claim";
      document.getElementById("claim_svx").className =  "claim";
      }

} // callback_getclaimdata



  document.addEventListener("click", (evt) => {
        const flyoutEl = document.getElementById("mysvg");
        const flyoutEl2 = document.getElementById("inventorycontent");
        const flyoutEl3 = document.getElementById("movepanel");
        const flyoutEl4 = document.getElementById("board_navigation");


        let targetEl = evt.target; // clicked element
        do {
          if(
             targetEl == flyoutEl  ||
             targetEl == flyoutEl2 ||
             targetEl == flyoutEl3 ||
             targetEl == flyoutEl4
             ) {

            console.log("inside")
            return;
          }
          // Go up the DOM
          targetEl = targetEl.parentNode;
        } while (targetEl);

                console.log("outside");
                resettiles();
      });

// End - cursor



function updatepanel()
{


console.log("UP: "+globalselection['coordinate']+" "+globalselection['assetid'] + " " + globalselection['owner']);

// Nickname
if ( globalselection['owner'] == global_account)
   {
   document.getElementById("newnickname").style.background = "#ffffff";
   console.log("OWNER OK");
   } else
   {
   document.getElementById("newnickname").style.background = "#cccccc";
      console.log("OWNER NOT OK");
   }



// Move-Panel
if ( globalselection['atype'] == 5)
   {
//   document.getElementById("movepanel").style.background = "#ffffff";
   console.log("bulldozer OK");
   } else
   {
  // document.getElementById("movepanel").style.background = "#cccccc";
      console.log("bulldozer NOT OK");
   }





} // updatepanel()



</script>


<script>




var globalselection = new Object();
globalselection['coordinate']   = "";
globalselection['assetid']      = "";
globalselection['owner']        = "";
globalselection['x']            = -1;
globalselection['y']            = -1;
globalselection['atype']        = -1;
globalselection['ts']           = -1;
globalselection['race']         = -1;
globalselection['shield']       = -1;
globalselection['attack']       = -1;
globalselection['config']       = "";

globalselection['n'] = new Object();
globalselection['n']['coordinate'] = "";
globalselection['n']['assetid']    = "";
globalselection['n']['owner']      = "";
globalselection['n']['x']          = "";
globalselection['n']['y']          = "";
globalselection['n']['atype']      = "";
globalselection['n']['race']       = "";
globalselection['n']['ts']         = "";
globalselection['n']['shield']     = "";

globalselection['e'] = new Object();
globalselection['e']['coordinate'] = "";
globalselection['e']['assetid']    = "";
globalselection['e']['owner']      = "";
globalselection['e']['x']          = "";
globalselection['e']['y']          = "";
globalselection['e']['atype']      = "";
globalselection['e']['race']       = "";
globalselection['e']['ts']         = "";
globalselection['e']['shield']     = "";

globalselection['s'] = new Object();
globalselection['s']['coordinate'] = "";
globalselection['s']['assetid']    = "";
globalselection['s']['owner']      = "";
globalselection['s']['x']          = "";
globalselection['s']['y']          = "";
globalselection['s']['atype']      = "";
globalselection['s']['race']       = "";
globalselection['s']['ts']         = "";
globalselection['s']['shield']     = "";

globalselection['w'] = new Object();
globalselection['w']['coordinate'] = "";
globalselection['w']['assetid']    = "";
globalselection['w']['owner']      = "";
globalselection['w']['x']          = "";
globalselection['w']['y']          = "";
globalselection['w']['atype']      = "";
globalselection['w']['race']       = "";
globalselection['w']['ts']         = "";
globalselection['w']['shield']     = "";

var graborder = new Array();

graborder[0] = new Object();
graborder[ 0]['x']   = 10;
graborder[ 0]['y']   = 0;
graborder[ 0]['cnt'] = 1;
graborder[ 1] = new Object();
graborder[ 1]['x']   = 9;
graborder[ 1]['y']   = 1;
graborder[ 1]['cnt'] = 3;
graborder[ 2] = new Object();
graborder[ 2]['x']   = 8;
graborder[ 2]['y']   = 2;
graborder[ 2]['cnt'] = 5;
graborder[ 3] = new Object();
graborder[ 3]['x']   = 7;
graborder[ 3]['y']   = 3;
graborder[ 3]['cnt'] = 7;
graborder[ 4] = new Object();
graborder[ 4]['x']   = 6;
graborder[ 4]['y']   = 4;
graborder[ 4]['cnt'] = 9;
graborder[ 5] = new Object();
graborder[ 5]['x']   = 5;
graborder[ 5]['y']   = 5;
graborder[ 5]['cnt'] = 11;
graborder[ 6] = new Object();
graborder[ 6]['x']   = 4;
graborder[ 6]['y']   = 6;
graborder[ 6]['cnt'] = 11;
graborder[ 7] = new Object();
graborder[ 7]['x']   = 3;
graborder[ 7]['y']   = 7;
graborder[ 7]['cnt'] = 11;
graborder[ 8] = new Object();
graborder[ 8]['x']   = 2;
graborder[ 8]['y']   = 8;
graborder[ 8]['cnt'] = 11;
graborder[ 9] = new Object();
graborder[ 9]['x']   = 1;
graborder[ 9]['y']   = 9;
graborder[ 9]['cnt'] = 11;
graborder[10] = new Object();
graborder[10]['x']   = 0;
graborder[10]['y']   = 10;
graborder[10]['cnt'] = 11;
graborder[11] = new Object();
graborder[11]['x']   = 1;
graborder[11]['y']   = 11;
graborder[11]['cnt'] = 9;
graborder[12] = new Object();
graborder[12]['x']   = 2;
graborder[12]['y']   = 12;
graborder[12]['cnt'] = 7;
graborder[13] = new Object();
graborder[13]['x']   = 3;
graborder[13]['y']   = 13;
graborder[13]['cnt'] = 5;
graborder[14] = new Object();
graborder[14]['x']   = 4;
graborder[14]['y']   = 14;
graborder[14]['cnt'] = 3;
graborder[15] = new Object();
graborder[15]['x']   = 5;
graborder[15]['y']   = 15;
graborder[15]['cnt'] = 1;

       console.log("graborder:");
       console.log(graborder);


// Mapping-array

let mappingarray =
[
                                                                                [10, 0],
                                                                        [ 9, 1],[10, 1],[11, 1],
                                                                [ 8, 2],[ 9, 2],[10, 2],[11, 2],[12, 2],
                                                        [ 7, 3],[ 8, 3],[ 9, 3],[10, 3],[11, 3],[12, 3],[13, 3],
                                                [ 6, 4],[ 7, 4],[ 8, 4],[ 9, 4],[10, 4],[11, 4],[12, 4],[13, 4],[14, 4],
                                        [ 5, 5],[ 6, 5],[ 7, 5],[ 8, 5],[ 9, 5],[10, 5],[11, 5],[12, 5],[13, 5],[14, 5],[15, 5],
                                [ 4, 6],[ 5, 6],[ 6, 6],[ 7, 6],[ 8, 6],[ 9, 6],[10, 6],[11, 6],[12, 6],[13, 6],[14, 6],
                        [ 3, 7],[ 4, 7],[ 5, 7],[ 6, 7],[ 7, 7],[ 8, 7],[ 9, 7],[10, 7],[11, 7],[12, 7],[13, 7],
                [ 2, 8],[ 3, 8],[ 4, 8],[ 5, 8],[ 6, 8],[ 7, 8],[ 8, 8],[ 9, 8],[10, 8],[11, 8],[12, 8],
        [ 1, 9],[ 2, 9],[ 3, 9],[ 4, 9],[ 5, 9],[ 6, 9],[ 7, 9],[ 8, 9],[ 9, 9],[10, 9],[11, 9],
[ 0,10],[ 1,10],[ 2,10],[ 3,10],[ 4,10],[ 5,10],[ 6,10],[ 7,10],[ 8,10],[ 9,10],[10,10],
        [ 1,11],[ 2,11],[ 3,11],[ 4,11],[ 5,11],[ 6,11],[ 7,11],[ 8,11],[ 9,11],
                [ 2,12],[ 3,12],[ 4,12],[ 5,12],[ 6,12],[ 7,12],[ 8,12],
                        [ 3,13],[ 4,13],[ 5,13],[ 6,13],[ 7,13],
                                [ 4,14],[ 5,14],[ 6,14],
                                        [ 5,15]
];

//   console.log("mappingarray:");
//   console.log(mappingarray);



let mappingarray_frame =
[
                                                                                [9 , 0],
                                                                        [ 8, 1],        [11, 1],
                                                                [ 7, 2],                        [12, 2],
                                                        [ 6, 3],                                        [13, 3],
                                                [ 5, 4],                                                        [14, 4],
                                        [ 4, 5],                                                                        [16, 5],
                                [ 3, 6],                                                                        [15, 6],
                        [ 2, 7],                                                                        [14, 7],
                [ 1, 8],                                                                        [13, 8],
        [ 0, 9],                                                                        [12, 9],
[-1,10],[ 1,10],                                                                [11,10],
        [ 0,11],                                                        [10,11],
                [ 1,12],                                        [ 9,12],
                        [ 2,13],                        [ 8,13],
                                [ 3,14],        [ 7,14],
                                        [ 5,15]
];


// Tile-array

var tilearray = new Array();


for (var i=0; i<16; i++)
{
tilearray[i] = new Array();
for (var i2=0; i2<16; i2++)
    {
    tilearray[i][i2] = new Object();
    tilearray[i][i2]['tile']     = "tilexx";
    tilearray[i][i2]['tileid']   = "123";
    tilearray[i][i2]['asset_id'] = "";
    tilearray[i][i2]['owner']    = "";
    tilearray[i][i2]['ts']       = 0;
    tilearray[i][i2]['loaded']   = 0;

    tilearray[i][i2]['attack']      = 0;
    tilearray[i][i2]['atype']       = -1;
    tilearray[i][i2]['config']      = -1;
    tilearray[i][i2]['eos']         = -1;
    tilearray[i][i2]['name']        = "";
    tilearray[i][i2]['nick']        = -1;
    tilearray[i][i2]['ori']         = -1;
    tilearray[i][i2]['race']        = -1;
    tilearray[i][i2]['shield']      = -1;
    tilearray[i][i2]['shield_max']  = -1;
    tilearray[i][i2]['sov']         = -1;
    tilearray[i][i2]['svx_balance'] = -1;



    } // for i2 ...
} // for ... i


   //    console.log("tilearray:");
   //    console.log(tilearray);







function callback_getglobals( rows )
{

console.log("ROWS callback_pricedata ...(callback)");
//    console.log(rows);

globaldata['version']    =  rows.rows[0].version;
globaldata['m_sov']      =  rows.rows[0].m_sov;
globaldata['a_sov']      =  rows.rows[0].a_sov;
globaldata['svx_self']   =  rows.rows[0].svx_self;





document.getElementById("frontendversion").innerHTML = frontendversion;
document.getElementById("contractversion").innerHTML = globaldata['version'];

if (frontendversion != globaldata['version'])
   {
   alert("Warning - Frontend-Version " + frontendversion + " and Contract-Version " + globaldata['version'] + " is different! Please download the newest version of this frontend from github.io !" );
   }

} // callback_getglobals()


var globaldata = new Array();

function loadglobals()
{

getdata(callback_getglobals, "sovspacegame", "sovspacegame", "global", "", "", "", 1 );


} // loadglobals


function initgameboard()
{






// Append the tile-div

var index = 0;

for (var y=0; y<=15; y++)
{
var startx = 0;
var starty = y;


for (var i=0; i<=12;i++)
{



var thex = startx*10 - 10;
var they = starty *10 - 25     ;


if (
   they >= -25  &&
   they <= 75  &&
   thex <= 90
   )
{
//console.log("- index: " + index + "  x:"+thex  + " y:"+they  );


var div = document.createElement("div");
var divid = "tile"+index;
div.id = divid;
div.style.position = "absolute";
div.style.left = thex+"%";
div.style.top  = they+"%";

div.style.width = "20%";
div.style.height = "30%";


div.style.background = "";

div.style.color = "#ffffff";

div.innerHTML = "<img src='img/tile00.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
document.getElementById("gameboard").appendChild(div);




index++;
} // if (starty >= -25)

startx += 1;
starty -= 0.5;
} // for ...


} // for starty...







// Append the object-div

var index = 0;

for (var y=0; y<=15; y++)
{
var startx = 0;
var starty = y;


for (var i=0; i<=12;i++)
{



var thex = startx*10 - 10;
var they = starty *10 - 25     ;


if (
   they >= -25  &&
   they <= 75  &&
   thex <= 90
   )
{
//console.log("- index: " + index + "  x:"+thex  + " y:"+they  );


var div = document.createElement("div");
var divid = "obj"+index;
div.id = divid;
div.style.position = "absolute";
div.style.left = thex+"%";
div.style.top  = they+"%";

div.style.width = "20%";
div.style.height = "30%";
div.style.zIndex = they+200;

div.style.background = "";
//div.style.border = "1px solid #00ff00";
div.style.color = "#ffffff";

div.innerHTML = "<img src='img/one.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
document.getElementById("gameboard").appendChild(div);




index++;
} // if (starty >= -25)

startx += 1;
starty -= 0.5;
} // for ...


} // for starty...







// Append the text-div

var index = 0;

for (var y=0; y<=15; y++)
{
var startx = 0;
var starty = y;


for (var i=0; i<=12;i++)
{



var thex = startx*10 - 10;
var they = starty *10 - 25     ;


if (
   they >= -25  &&
   they <= 75  &&
   thex <= 90
   )
{
//console.log("- index: " + index + "  x:"+thex  + " y:"+they  );


var div = document.createElement("div");
var divid = "thetext"+index;
div.id = divid;
div.style.position = "absolute";
div.style.left = thex+"%";
div.style.top  = they+"%";

div.style.width = "20%";
div.style.height = "30%";
div.style.zIndex = they+301;

div.style.background = "";
// div.style.border = "1px solid #00ff00";
div.style.color = "#ffffff";

div.innerHTML = "<img src='img/one.png?s=442' style='position:absolute;width:100%;'>" ;
document.getElementById("gameboard").appendChild(div);




index++;
} // if (starty >= -25)

startx += 1;
starty -= 0.5;
} // for ...


} // for starty...



} // initgameboard()



function setaccountname( name )
{
document.getElementById('myaccountname').innerHTML = ""+name+"";

document.getElementById('walletmenu_anchor').style.visibility = "hidden";
document.getElementById('walletmenu_anchor').style.height = "0px";

document.getElementById('walletmenu_scatter').style.visibility = "hidden";
document.getElementById('walletmenu_scatter').style.height = "0px";

document.getElementById('logoutbutton').style.visibility = "visible";
document.getElementById('logoutbutton').style.height = "";

if (name == 'sovspacegame')
   document.getElementById('menu5').style.visibility = "visible"; else
   document.getElementById('menu5').style.visibility = "hidden";

}




function logoutall( name )
{
document.getElementById('myaccountname').innerHTML = "xxx";


document.getElementById('walletmenu_anchor').style.visibility = "visible";
document.getElementById('walletmenu_anchor').style.height = "";

document.getElementById('walletmenu_scatter').style.visibility = "visible";
document.getElementById('walletmenu_scatter').style.height = "";


document.getElementById('logoutbutton').style.visibility = "hidden";
document.getElementById('logoutbutton').style.height = "0px";

document.getElementById('userrace').innerHTML = "";
document.getElementById('chooserace').style.height = "240px;";
document.getElementById('chooserace').style.visibility = "visible";

document.getElementById('menu5').style.visibility = "hidden";

} // logoutall()




function external_login_action()
{
update_counter = 0;
//alert("GA: "+global_account);
}


var refreshcounter = 0;
function func_success( message )
{
console.log(message);
refreshcounter = 4;

chat_update_thread();
}

function func_error( message )
{
alert(message);
}




var   userdata = new Object();
userdata['race'] = -1;


function callback_userdata( value )
{
console.log(value);

if ( value.rows[0].user == global_account)
   {
   userdata['race'] = value.rows[0].race;
   } else
     {
     userdata['race'] = "";
     }

console.log("race:" + userdata['race']);

if (userdata['race'] == 1)
   {
   document.getElementById('userrace').innerHTML = "[Human]"

   document.getElementById('chooserace').style.height = "0px";
   document.getElementById('chooserace').style.visibility = "hidden";

   setsound(1);
   } else

if (userdata['race'] == 2)
   {
   document.getElementById('userrace').innerHTML = "[Grey]"

   document.getElementById('chooserace').style.height = "0px";
   document.getElementById('chooserace').style.visibility = "hidden";

   setsound(2);
   } else


if (userdata['race'] == 4)
   {
   document.getElementById('userrace').innerHTML = "[Sirian]"

   document.getElementById('chooserace').style.height = "0px";
   document.getElementById('chooserace').style.visibility = "hidden";

   setsound(4);
   } else


if (userdata['race'] == 5)
   {
   document.getElementById('userrace').innerHTML = "[Repto]"

   document.getElementById('chooserace').style.height = "0px";
   document.getElementById('chooserace').style.visibility = "hidden";

   setsound(5);
   } else


     {
     console.log("no RACE!!!!!");
     document.getElementById('chooserace').style.height = "240px";
     document.getElementById('chooserace').style.visibility = "visible";

     }

} // callback_userdata()




function getuserinfo()
{

getdata(callback_userdata, "sovspacegame",  "sovspacegame", "user", global_account, "", "", 1 );

} // getuserinfo()




function callback_render_areas( value )
{

 loadboard_cnt++;
       if (loadboard_cnt == loadboard_size)
          {
          console.log("loadboard_size reached!");


          // count objects to load
          loadobjects_cnt  = 0;
          loadobjects_size = 0;



          for (x=0; x<16; x++)
          for (y=0; y<16; y++)
              {

              if ( tilearray[x][y]['asset_id'] != "" )
                 {
                 loadobjects_size++;
                 }

              } // for y...

          //console.log("loadobjects_size: ",loadobjects_size);

          //renderboard(); // pre render
          loadobjects();
          } else
            {
            //console.log("loadboard: ",loadboard_cnt, " of " , loadboard_size );
            }


if (value.rows.length == 0)
  {
  console.log("RETURN");
  //  return;
  }



var size = value.rows.length;


for (var j=0; j<size; j++)
    {
    id       = value.rows[j].id;
    tile     = value.rows[j].tile;
    asset_id = value.rows[j].asset_id;
    owner    = value.rows[j].owner;
    ts       = value.rows[j].ts;

    // console.log("- j:" , j," " , id);



    var found = 0;
    var lastx = -1;
    var lasty = -1;
for (var i=0; i<16; i++)
for (var i2=0; i2<16; i2++)
    {

    tileid = tilearray[i][i2]['tileid'];


    if (tileid == id)
       {
       found = 1;
       lastx = i;
       lasty = i2;
       i = 16;
       i2 = 16;
       }
    }


//  console.log(" - found: " , found);
    if (found)
       {
       tile2 = tile;
       if (tile2 < 10) tile2 = '0'+tile;
       tilearray[lastx][lasty]['tile']     = "tile"+tile2;
    //       tilearray[lastx][lasty]['tile']     = "tile10";
       tilearray[lastx][lasty]['asset_id'] =  asset_id;
       tilearray[lastx][lasty]['owner']    = owner;
       tilearray[lastx][lasty]['ts']       = ts;


    // console.log(" - x: " , lastx, " y:",lasty, " tile2:" , tile2, " " ,asset_id);


       } // if (found)

    } // for j...




} // callback_render_areas



var loadboard_cnt    = 0;
var loadboard_size   = 0;
var loadobjects_cnt  = 0;
var loadobjects_size = 0;


function refreshboard()
{
loadboard_cnt=0;


loadboard_size = graborder.length;
console.log("loadboard_size: ",loadboard_size);

resettiles();

loadboard();
}

function loadboard()
{


// ---
// Rendering

xcoor = document.getElementById('xcoor').value*1;
ycoor = document.getElementById('ycoor').value*1;

width = 1000000;


// tilearray init + reset / clear tile-information like name / nickname
for (x=0; x<16; x++)
for (y=0; y<16; y++)
    {
    x2 = x + xcoor - 8;
    y2 = y + ycoor - 7;
    coordinatei = (y2*width) + x2;
    tilearray[x][y]['tileid'] = coordinatei;
    tilearray[x][y]['tile'] = "tile00";
    tilearray[x][y]['asset_id'] = "";

    tilearray[x][y]['atype'] = "";

    tilearray[x][y]['race'] = "";

    tilearray[x][y]['name']    = "";
    tilearray[x][y]['shield']  = "";
    tilearray[x][y]['nick']    = -1;
    }






size = graborder.length;
 console.log("size: ",size);


for (var i=0; i<size; i++)
    {
    x   = graborder[i]['x'];
    y   = graborder[i]['y'];
    cnt = graborder[i]['cnt'];

    tileid = tilearray[x][y]['tileid'];

    //console.log("i:(",i,") x: ",x," y:", y," cnt:",cnt, " " , tileid );

    getdata(callback_render_areas, "sovspacegame",  "sovspacegame", "area", tileid, "", "", cnt );
    } // for i...





} //  loadboard()




function loadobjects()
{

var cnt = 0;
for (x=0; x<16; x++)
for (y=0; y<16; y++)
    {

    if (     tilearray[x][y]['asset_id'] != "" )
       {
       //url = nft_node + tilearray[x][y]['asset_id'];
       //readasset(url, assethandler,x,y ) ;

       params = Object();
       params['x'] = x;
       params['y'] = y;

       getdata2(callback_readasset, params, "atomicassets", "sovspacegame", "assets",  tilearray[x][y]['asset_id'], "", "", 1 );


       cnt++;
       }
    } // for y...


// Render if not asset is in the boardwindow
console.log("readasset cnt:"+cnt)    ;
if (cnt == 0) renderboard();

} // loadobjects()




function renderboard()
{
console.log("...RENDERBOARD");
var size = mappingarray.length;

for (var i=0; i<size; i++)
    {
    var thetile = "tile" + i;

    x = mappingarray[i][0];
    y = mappingarray[i][1];




    tile         =  tilearray[x][y]['tile'];
    asset_id         =  tilearray[x][y]['asset_id'];  //
    tileid       =  tilearray[x][y]['tileid'];
    atype        =  tilearray[x][y]['atype'];
    race         =  tilearray[x][y]['race'];
    ori          =  tilearray[x][y]['ori'];
    nick         =  tilearray[x][y]['nick'];
    sov          =  tilearray[x][y]['sov'];
    svx_balance  =  tilearray[x][y]['svx_balance']+" SVX2";
    sov  = sov  / 10000;
    owner        =  tilearray[x][y]['owner'];
    shield       =  tilearray[x][y]['shield'];
    shield_max   =  tilearray[x][y]['shield_max'];
    config       =  tilearray[x][y]['config'] + "";

//console.log(" i:::("+x+","+y+")"+i+" REN tile:["+tile+"]");
    // config
//    let configarray = config.split(";");
    let configarray = split(config,";");


    if ( tile != "tile10" &&  tile != "tile11")
       {
       var buffer = "<img src='img/"+tile+".png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
       document.getElementById(thetile).innerHTML = buffer;
       } else
         {
          if ( tile == "tile10" )
       {
       console.log("place s1.png");
       buffer += "<img src='img/s1.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
       }

    if ( tile == "tile11" )
       {
       console.log("place s2.png");
       buffer += "<img src='img/s2.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
       }
 document.getElementById(thetile).innerHTML = buffer;
         }



    // Object
    var theobject = "obj" + i;


    // ---
    buffer = "";
    if ( atype == 1 && race == 1)
       {
       buffer += "<img src='img/lander1.png?s=4442' style='position:absolute;border:none;width:100%;'>";
       }

    if ( atype == 2 && race == 1)
       buffer += "<img src='img/resident_a.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 3 && race == 1)
       buffer += "<img src='img/agri_a.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 4 && race == 1)
       buffer += "<img src='img/factory_a.png?s=442' style='position:absolute;border:none;width:100%;'>" ;




    if ( atype == 5 && race == 1)
       {
       if ( ori == 1 )
          buffer += "<img src='img/rover_a_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/rover_a_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/rover_a_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/rover_a_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //




    if ( atype == 7 && race == 1)
       buffer = "<img src='img/wall_a.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 8 && race == 1)
       {
       if (configarray[0] == "infected" && configarray[1] != "")
          {
          buffer = "<img src='img/collector_a_infected.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
          } else
            {
            buffer = "<img src='img/collector_a.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
            }

//
       }

    if ( atype == 9 && race == 1)
       buffer = "<img src='img/tower_a.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

   if ( atype == 10 && race == 1)
       {
       if ( ori == 1 )
          buffer += "<img src='img/service_a_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/service_a_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/service_a_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/service_a_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

   if ( atype == 11 && race == 1)
       {
       if ( ori == 1 )
          buffer += "<img src='img/tank_a_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/tank_a_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/tank_a_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/tank_a_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

   if ( atype == 12 && race == 1)
       {
       if ( ori == 1 )
          buffer += "<img src='img/transporter_a_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/transporter_a_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/transporter_a_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/transporter_a_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

    if ( atype == 13 && race == 1)
       buffer = "<img src='img/wall2_a.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 14 && race == 1)
       buffer = "<img src='img/red_1.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;



    // ---
    // Greys
    if ( atype == 1 && race == 2)
       buffer = "<img src='img/lander2.png?s=4442' style='position:absolute;border:none;width:100%;'>";

    if ( atype == 2 && race == 2)
       buffer = "<img src='img/resident_b.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 3 && race == 2)
       buffer = "<img src='img/agri_b.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 4 && race == 2)
       buffer = "<img src='img/factory_b.png?s=442' style='position:absolute;border:none;width:100%;'>" ;



    if ( atype == 5 && race == 2)
       {
       if ( ori == 1)
          buffer += "<img src='img/rover_b_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2)
          buffer += "<img src='img/rover_b_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3)
          buffer += "<img src='img/rover_b_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4)
          buffer += "<img src='img/rover_b_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //





    if ( atype == 7 && race == 2)
       {
       buffer = "<img src='img/wall_b.png?s=4442' style='position:absolute;border:none;width:100%;'>";
       }

    if ( atype == 8 && race == 2)
       buffer = "<img src='img/collector_b.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 9 && race == 2)
       buffer = "<img src='img/tower_b.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

   if ( atype == 10 && race == 2)
       {
       if ( ori == 1 )
          buffer += "<img src='img/service_b_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/service_b_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/service_b_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/service_b_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //


   if ( atype == 11 && race == 2)
       {
       if ( ori == 1 )
          buffer += "<img src='img/tank_b_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/tank_b_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/tank_b_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/tank_b_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

   if ( atype == 12 && race == 2)
       {
       if ( ori == 1 )
          buffer += "<img src='img/transporter_b_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/transporter_b_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/transporter_b_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/transporter_b_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

    if ( atype == 13 && race == 2)
       buffer = "<img src='img/wall2_b.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 14 && race == 2)
       buffer = "<img src='img/red_2.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    // --- end greys



    // ---
    // Sirians
    if ( atype == 1 && race == 4)
       buffer = "<img src='img/lander4.png?s=4442' style='position:absolute;border:none;width:100%;'>";

    if ( atype == 2 && race == 4)
       buffer = "<img src='img/resident_d.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 3 && race == 4)
       buffer = "<img src='img/agri_d.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 4 && race == 4)
       buffer = "<img src='img/factory_d.png?s=442' style='position:absolute;border:none;width:100%;'>" ;



    if ( atype == 5 && race == 4)
       {
       if ( ori == 1)
          buffer += "<img src='img/rover_d_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2)
          buffer += "<img src='img/rover_d_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3)
          buffer += "<img src='img/rover_d_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4)
          buffer += "<img src='img/rover_d_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //





    if ( atype == 7 && race == 4)
       {
       buffer = "<img src='img/wall_d.png?s=4442' style='position:absolute;border:none;width:100%;'>";
       }

    if ( atype == 8 && race == 4)
       buffer = "<img src='img/collector_d.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 9 && race == 4)
       buffer = "<img src='img/tower_d.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

   if ( atype == 10 && race == 4)
       {
       if ( ori == 1 )
          buffer += "<img src='img/service_d_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/service_d_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/service_d_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/service_d_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //


   if ( atype == 11 && race == 4)
       {
       if ( ori == 1 )
          buffer += "<img src='img/tank_d_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/tank_d_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/tank_d_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/tank_d_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

   if ( atype == 12 && race == 4)
       {
       if ( ori == 1 )
          buffer += "<img src='img/transporter_d_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/transporter_d_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/transporter_d_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/transporter_d_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

    if ( atype == 13 && race == 4)
       buffer = "<img src='img/wall2_d.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 14 && race == 4)
       buffer = "<img src='img/red_4.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    // --- end sirians





    // ---
    // Reptos
    if ( atype == 1 && race == 5)
       buffer = "<img src='img/lander5.png?s=4442' style='position:absolute;border:none;width:100%;'>";

    if ( atype == 2 && race == 5)
       buffer = "<img src='img/resident_e.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 3 && race == 5)
       buffer = "<img src='img/agri_e.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 4 && race == 5)
       buffer = "<img src='img/factory_e.png?s=442' style='position:absolute;border:none;width:100%;'>" ;



    if ( atype == 5 && race == 5)
       {
       if ( ori == 1)
          buffer += "<img src='img/rover_e_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2)
          buffer += "<img src='img/rover_e_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3)
          buffer += "<img src='img/rover_e_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4)
          buffer += "<img src='img/rover_e_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //





    if ( atype == 7 && race == 5)
       {
       buffer = "<img src='img/wall_e.png?s=4442' style='position:absolute;border:none;width:100%;'>";
       }

    if ( atype == 8 && race == 5)
       buffer = "<img src='img/collector_e.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 9 && race == 5)
       buffer = "<img src='img/tower_e.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

   if ( atype == 10 && race == 5)
       {
       if ( ori == 1 )
          buffer += "<img src='img/service_e_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/service_e_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/service_e_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/service_e_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //


   if ( atype == 11 && race == 5)
       {
       if ( ori == 1 )
          buffer += "<img src='img/tank_e_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/tank_e_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/tank_e_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/tank_e_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

   if ( atype == 12 && race == 5)
       {
       if ( ori == 1 )
          buffer += "<img src='img/transporter_e_001.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 2 )
          buffer += "<img src='img/transporter_e_002.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 3 )
          buffer += "<img src='img/transporter_e_003.png?s=442' style='position:absolute;border:none;width:100%;'>" ;

       if ( ori == 4 )
          buffer += "<img src='img/transporter_e_004.png?s=442' style='position:absolute;border:none;width:100%;'>" ;
       } //

    if ( atype == 13 && race == 5)
       buffer = "<img src='img/wall2_e.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    if ( atype == 14 && race == 5)
       buffer = "<img src='img/red_5.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    // --- end reptos



    //if (asset_id == 2199025130637  )
    //   buffer = "<img src='img/monument_1.png?s=4442' style='position:absolute;border:none;width:100%;'>" ;

    checkbox_shield = document.getElementById('checkbox_shield').checked;
    checkbox_owner  = document.getElementById('checkbox_owner').checked;

/*
var size = mappingarray.length;



value_shield = 'hidden';
if (checkbox_shield) value_shield = 'visible';

value_owner = 'hidden';
if (checkbox_owner) value_owner = 'visible';

for (var i=0; i<size; i++)
    {
    var divid_shieldinfo = "shieldinfo_" + i;
    if ( document.getElementById(divid_shieldinfo) != undefined )
       {
       document.getElementById(divid_shieldinfo).style.visibility = value_shield;
       }

    var divid_ownderinfo = "ownerinfo_" + i;
    if ( document.getElementById(divid_ownderinfo) != undefined )
       {
       document.getElementById(divid_ownderinfo).style.visibility = value_owner;
       }

    } // for i...
*/


    document.getElementById(theobject).innerHTML = buffer;

  var theobject2 = "thetext" + i;

   buffer = "";
    // Text
    if (
       atype == 1 ||
       atype == 2 ||
       atype == 3 ||
       atype == 4 ||
       atype == 5 ||
       atype == 6 ||
       atype == 7 ||
       atype == 8 ||
       atype == 9 ||
       atype == 10 ||
       atype == 11 ||
       atype == 12 ||
       atype == 13 ||
       atype == 14

       )
       {
       if (race == 1) color = "#ffffff";
       if (race == 2) color = "#aaffaa";
       if (race == 4) color = "#aaaaff";
       if (race == 5) color = "#ffaaaa";

       if (owner == global_account)
          {
          color = "#ffee99";
          }

       var divid_shieldinfo     = "shieldinfo_" + i;
       var divid_shieldinfo_bar = "shieldbar_" + i;
       var divid_owner          = "ownerinfo_" + i;

       value_shield = 'hidden';
       if (checkbox_shield) value_shield = 'visible';

       value_owner = 'hidden';
       if (checkbox_owner) value_owner = 'visible';


       buffer += "<div class='tileinfo_nick noselect' style='color:"+color+";position:absolute;text-align:center;left:0%;width:100%;font-weight:bold;font-size:0.8em;top:70%;z-index:300;'>" +nick+  " </div>" ;



       marketid = 1;
       //
       size2 = pricedata.length;
       for (var i2=1; i2<=size2; i2++)
           {
           if (pricedata[i2]['race'] !== undefined)
              {
              if ( pricedata[i2]['race'] == race && pricedata[i2]['atype'] == atype)
                 {
                 marketid = i2;
                 i2 = size2;
                 } // if ...
              } // != undefined
           } // for...
        // pricedata[id]['race']

       //var sov2 =  marketdata[marketid];
       var sov2 =  marketdata_item[marketid];
//       shieldinfo = shield + "/" + shield_max + " (" +sov+ " SOV)x";
       shieldinfo = shield + "/" + shield_max + " (" +sov2+ " SOV)";
       buffer += "<div id='"+divid_shieldinfo+"' class='tileinfo_nick noselect' style='color:"+color+";position:absolute;left:0%;width:100%;font-weight:bold;font-size:12px;top:80%;z-index:300;visibility:"+value_shield+";'>" +shieldinfo+  " </div>" ;

       // bar
       buffer += "<div style='width:100%;position:absolute;top:40%;border:none;;text-align:center;'>";
        buffer += "<div id='"+divid_shieldinfo_bar+"' class='tileinfo_nick noselect' style='color:"+color+";background:#ee0000;width:50%;margin-left:auto;margin-right:auto;font-weight:bold;font-size:12px;z-index:400;border:;height:10px;visibility:"+value_shield+";'>" ;

        percent = (shield / shield_max)*100;
        buffer += "<div id='' class=' noselect' style='color:"+color+";background:green;width:"+percent+"%;margin-left:0px;z-index:301;border:none;height:10px;'>" ;
        buffer += "</div>";


        buffer += "</div>";
       buffer += "</div>";

       buffer += "<div id='"+divid_owner+"' class='tileinfo_nick noselect' style='color:"+color+";position:absolute;left:0%;width:100%;font-weight:bold;font-size:12px;top:86%;z-index:300;visibility:"+value_owner+";'>" +owner+  " </div>" ;

       } // if object





    document.getElementById(theobject2).innerHTML = buffer;



    } // for i...





grabtocanvans();

} // renderboard()



function assethandler( value , x, y)
{

tilearray[x][y]['attack']   = value['data']['data']['attack'];
tilearray[x][y]['atype']    = value['data']['data']['atype'];
tilearray[x][y]['config']    = value['data']['data']['config'];
tilearray[x][y]['eos']    = value['data']['data']['eos'];
tilearray[x][y]['name']    = value['data']['data']['name'];

    tilearray[x][y]['nick']    = value['data']['data']['nick'];
    tilearray[x][y]['ori']    = value['data']['data']['ori'];
    tilearray[x][y]['race']    = value['data']['data']['race'];
    tilearray[x][y]['shield']    = value['data']['data']['shield'];
    tilearray[x][y]['shield_max']    = value['data']['data']['shield_max'];
    tilearray[x][y]['sov']    = value['data']['data']['sov'];



    loadobjects_cnt++;
       if (loadobjects_cnt == loadobjects_size)
          {
          console.log("loadobjects_size reached! ");
//          load_my_assets();
          renderboard();

          } else
            {
            //console.log("loadobjects_cnt: ", loadobjects_cnt, " of ", loadobjects_size );
            }




} // assethandler




function readurl_simple(url, jsonparam)
{
try {
var xhr = new XMLHttpRequest();
var fd = new FormData();
xhr.open('POST', url, false);

var data2 = jsonparam ;

xhr.send(data2);

var response = xhr.responseText;

return(response);
      } catch (e)
         {
         console.log("Connection failed, grabbing local");
         return '[]';
         }
} // readurl()


function readurl(url, callback )
{

console.log(" readurl ",url," ");
asset_id = 2199025113747;
asset_id = 2199025113579;
   var jsonparam = JSON.stringify( [ ]  );

var xhr = new XMLHttpRequest();


xhr.open("POST", url);


xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");



xhr.onreadystatechange = function () {
   if (xhr.readyState === 4) {

      json = xhr.responseText;

      const rows = JSON.parse(json);

      callback(rows);


   }};


xhr.send();

//console.log(" readurl2 ");

} // readurl()



function readasset(url, callback, thex, they )
{

//console.log(" readurl ",url," ");
//asset_id = 2199025113747;
//asset_id = 2199025113579;
   var jsonparam = JSON.stringify( [ ]  );

var xhr = new XMLHttpRequest();

xhr.open("POST", url);


xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");



xhr.onreadystatechange = function () {
   if (xhr.readyState === 4) {

      json = xhr.responseText;

      const rows = JSON.parse(json);

      callback(rows,thex, they);


   }};


xhr.send();

//console.log(" readurl2 ");


} // readasset()



function readasset2(url, callback, thex, they )
{

//console.log(" readurl ",url," ");
//asset_id = 2199025113747;
//asset_id = 2199025113579;
   var jsonparam = JSON.stringify( [ ]  );

var xhr = new XMLHttpRequest();

xhr.open("POST", url);


xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");



xhr.onreadystatechange = function () {
   if (xhr.readyState === 4) {

      json = xhr.responseText;

      const rows = JSON.parse(json);

      callback(rows,thex, they);


   }};


xhr.send();

//console.log(" readurl2 ");


} // readasset()

//-----


function callback_readasset( value, params )
{

//console.log(value);
/*
console.log("TTT");
console.log(params);
console.log(value);
*/

/*
if ( value.more == false )
   {
    loadobjects_cnt++;
   return;
   }
*/

//var data = value.rows[0].immutable_serialized_data;
//var data = value.rows[0].mutable_serialized_data;
var idata = value.rows[0].immutable_serialized_data;
var mdata = value.rows[0].mutable_serialized_data;


decoded_data = mydecoder( idata, mdata );

/*
console.log("Decoded:");
console.log(decoded_data);
console.log("---");
*/
// ---
//document.getElementById('debugout').innerHTML = "[" + decoded_data['name'] + "]" ;

x = params['x'];
y = params['y'];

/*console.log("x: " + x);
console.log("y: " + y);
*/

//a = decoded_data['attack'];
//console.log("a: " + a);

tilearray[x][y]['attack']   = decoded_data['attack'];
tilearray[x][y]['atype']    = decoded_data['atype'];
   // tilearray[x][y]['config']    = decoded_data['config'];
    tilearray[x][y]['eos']    = decoded_data['eos'];
    tilearray[x][y]['name']    =decoded_data['name'];

    tilearray[x][y]['nick']    = decoded_data['nick'];
    tilearray[x][y]['ori']    = decoded_data['ori'];
    tilearray[x][y]['race']    = decoded_data['race'];
    tilearray[x][y]['shield']    = decoded_data['shield'];
    tilearray[x][y]['shield_max']    = decoded_data['shield_max'];
    tilearray[x][y]['sov']    = decoded_data['sov'];
    tilearray[x][y]['config']    = decoded_data['config'];



    loadobjects_cnt++;
       if (loadobjects_cnt == loadobjects_size)
          {
          console.log("loadobjects_size reached! ");
          renderboard();
          } else
            {
            //console.log("loadobjects_cnt: ", loadobjects_cnt, " of ", loadobjects_size );
            }



} // callback_readasset

function mydecoder( idata, mdata )
{
var ret = Object();
//console.log("Decoder");



// ---
// idata
//



var bytearray = Array();
len = unsignedFromVarintBytes( idata, 1 );
//console.log( "len_: " + len['number']);


for (var i=0; i<len['number']; i++)
    {
    bytearray[i] = idata[i+2];
    } // for i...

var thename = utf8BytesToString(bytearray);

i2 = len['number']+3;
//console.log(" - i2 vor ipfs " + i2);

lenipfs = unsignedFromVarintBytes( idata, i2 );
//console.log( "lenipfs: " + lenipfs['number']);
i2++;


bytearray = Array();



for (var i=0; i<lenipfs['number']; i++)
    {
    bytearray[i] = idata[i+i2];
    //console.log(" - " + nick);
    }




var ipfs = utf8BytesToString(bytearray);



/*
l = mdata.length;
console.log("L: " + l);

console.log("------");
for (var i=0; i<l; i++)
    {
    ch =   String.fromCharCode( mdata[i]   );

    ret2 = unsignedFromVarintBytes( mdata, i );
    var value = ret2['number'];
    var index = ret2['index'];

    console.log(i+" | "+ch + " - " + "["+value+"] index:"+index+" ");
    }
console.log("-fin -----");
*/


// ---
// mdata
//

// 1) nick
var bytearray = Array();
len = unsignedFromVarintBytes( mdata, 1 );
//console.log( "len: " + len['number']);

for (var i=0; i<len['number']; i++)
    {
    bytearray[i] = mdata[i+2];
    }

var nick = utf8BytesToString(bytearray);


// shield
i2 = len['number']+3;
ret2 = unsignedFromVarintBytes( mdata, i2 );
var shield = ret2['number'];
i2 = ret2['index'];
i2++;

// shield-max
ret2 = unsignedFromVarintBytes( mdata, i2 );
var shield_max = ret2['number'];
i2 = ret2['index'];
i2++;


// attack
ret2 = unsignedFromVarintBytes( mdata, i2 );
var attack = ret2['number'];
i2 = ret2['index'];
i2++;

// race
ret2 = unsignedFromVarintBytes( mdata, i2 );
var race = ret2['number'];
i2 = ret2['index'];
i2++;

// atype
ret2 = unsignedFromVarintBytes( mdata, i2 );
var atype = ret2['number'];
i2 = ret2['index'];
i2++;

// sov
ret2 = unsignedFromVarintBytes( mdata, i2 );
var sov = ret2['number'];
i2 = ret2['index'];
i2++;

// eos
ret2 = unsignedFromVarintBytes( mdata, i2 );
var eos = ret2['number'];
i2 = ret2['index'];
i2++;

// ori
ret2 = unsignedFromVarintBytes( mdata, i2 );
var ori = ret2['number'];
i2 = ret2['index'];
i2++;



// config
var bytearray = Array();
len = unsignedFromVarintBytes( mdata, i2 );
//console.log( "++++ len : " + len['number']);
i2++;
for (var i=0; i<len['number']; i++)
    {
    //ch =   String.fromCharCode( mdata[i+i2]   );
    //console.log(" * " + (i+i2)+ " ("+ch+") " , mdata[i]);
    bytearray[i] = mdata[i+i2];
    }

var config = utf8BytesToString(bytearray);



//console.log("--i2_b "+i2+"----");
ret["name"] = thename;
ret["ipfs"] = ipfs;

ret['nick'] = nick;
ret['shield'] = shield;
ret['shield_max'] = shield_max;
ret['attack'] = attack;
ret['race'] = race;
ret['atype'] = atype;
ret['sov'] = sov;
ret['eos'] = eos;
ret['ori'] = ori;
ret["config"] = config;

return (ret);
} // mydecoder








function unsignedFromVarintBytes( buffer, index )
{
var ret = Object();
ret['number'] = 0;
ret['index']  = 0;


var number     = 0;
var multiplier = 1;
var i          = index;

while ( buffer[i] >= 128 )
      {
      number += (buffer[i] - 128) * multiplier;
      i++;
      multiplier *= 128;
      }
      number += (buffer[i]) * multiplier;
      i++;

ret['number'] = number;
ret['index']  = i;

return ret;
} // unsignedFromVarintBytes


function utf8BytesToString(b) {
    return decodeURIComponent(escape(String.fromCharCode.apply(null, b)));
}


//-----


function inituser( race )
{

var theactions = [];

       memo = "This is it";




    var action = {
                 account: "sovspacegame",
                 name: 'inituser',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "user": global_account,
                       "race": race
                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} //  inituser()





function setnickname()
{


newnickname = document.getElementById('newnickname').value;


console.log("last_assetid:::::: ",globalselection['assetid']);


var theactions = [];




    var action = {
                 account: "sovspacegame",
                 name: 'setnickname',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user" : global_account,
                       "nickname" : newnickname
                       }
                 };


theactions.push(action);



if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // setnickname()


function placeobject( asset_id )
{



if (asset_id == '')
   {
   asset_id = selectednft['asset_id'];
   }


var theactions = [];



var memo = "place;"+global_account+";"+globalselection['x']+";"+globalselection['y']+"";


    var action = {
                 account: "atomicassets",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "asset_ids": [asset_id],
                       "memo": memo,


                       }
                 };


theactions.push(action);


if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // placeobject()


function callback_getinventory_mainpage( rows )
{
console.log("ROWS...(callback)");


content = "";
content += "<table><tr>";

      var size = rows.rows.length;
      console.log("size:::"+ size);

for (var i=0; i<size; i++)
          {
          var asset_id = rows.rows[i].asset_id;


          //console.log("--- url: " + url);
          var url = nft_node + asset_id;
          var jsonparam = JSON.stringify( {assetid: asset_id } );
          var mediajson = readurl_simple(url, jsonparam);



          var json_array = JSON.parse(mediajson);


// console.log(json_array);

          var collection_name = json_array['data']['collection']['collection_name'] ;


         if (  collection_name == "sovspacegame" )
            {
            var the_id          = json_array['data']['data']['id'];
            var hash_img        = json_array['data']['data']['img'];


            var the_race        = json_array['data']['data']['race'];
            var the_atype       = json_array['data']['data']['atype'];

            var title      = json_array['data']['data']['name'] ;
            if (title == undefined) title = "Alien Girl";
            // console.log("hash_img: " + hash_img);
            content += "<td>";
            content += "<div id='nft_"+asset_id+"' onclick='selectnft("+asset_id+")' name='mynft' class='nft_cell' style=''>";




            var imgbuffer = "";
            /*
            if (the_atype == 14 && asset_id == 2199025130637)
               {
               imgbuffer = "<img src='img/nft_monument_1.png' style='width:100px;margin-top:10px;'>";
               }
               else
              */
                  {
                  imgbuffer = "<img src='img/nft_"+the_race+"_"+the_atype+".png' style='width:100px;margin-top:10px;'>";
                  }



            content +=   imgbuffer + "<br>";






         // --



   if (asset_id >= 2199025218704)
           {

           asset_link = "<a href='https://eos.atomichub.io/explorer/asset/" + asset_id + "' style='color:#eeeeee;' target='_blank'>#"+asset_id+ "</a>";

           content += "<strong>"+ title + "</strong><br>";
           content += "<small>"+ asset_link + "</small><br>";
           content += "<div onclick='placeobject("+asset_id+")' class='placenft' style=''>Place this NFT<br>on selected<br>area</div><br>";

           } else
              {
                  content += "[TEST-NFT]";


                 thelink = "burnasset("+asset_id+")";
                 content += "<br>";
                 content += "<span class='mintbutton' onclick='"+thelink+"' style='background:#ff3333;'>Burn NFT</span>";

               }

        //  --


            content += "</div>";
            content += "</td>";
            } // if (  collection_name == "xusogamedemo" )

          } // for i...


          content += "</tr></table>";
         document.getElementById('div_inventory_inner').innerHTML =  content;



} // callback_getinventory_mainpage()



function callback_getinventory( rows )
{
console.log("ROWS...(callback)");
//    console.log(rows);

content = "";
content += "<table><tr>";

      var size = rows.rows.length;
      console.log("size:::"+ size);

for (var i=0; i<size; i++)
          {
          var asset_id = rows.rows[i].asset_id;



          var url = nft_node + asset_id;
//          console.log("--- url: " + url);
          var jsonparam = JSON.stringify( {assetid: asset_id } );
          var mediajson = readurl_simple(url, jsonparam);



          var json_array = JSON.parse(mediajson);

          // console.log(json_array);

          var collection_name = json_array['data']['collection']['collection_name'] ;


         if (  collection_name == "sovspacegame" )
            {
            var the_id          = json_array['data']['data']['id'];
            var hash_img        = json_array['data']['data']['img'];
            var hash_video      = json_array['data']['data']['video'];

            var title      = json_array['data']['data']['name'] ;
            if (title == undefined) title = "Alien Girl";
            console.log("hash_img: " + hash_img);
            content += "<td>";
            content += "<div class='nft_cell' style=''>";


            var the_race        = json_array['data']['data']['race'];
            var the_atype       = json_array['data']['data']['atype'];
            var imgbuffer       = "";

            /*
            if (the_atype == 14 && asset_id == 2199025130637)
               {
               imgbuffer = "<img src='img/nft_monument_1.png' style='width:100px;margin-top:10px;'>";
               }
               else
               */
                  {
                  imgbuffer = "<img src='img/nft_"+the_race+"_"+the_atype+".png' style='width:100px;margin-top:10px;'>";
                  }

            content +=   imgbuffer + "<br>";



            asset_link = "<a href='https://eos.atomichub.io/explorer/asset/" + asset_id + "' style='color:#eeeeee;' target='_blank'>#"+asset_id+ "</a>";

            content += "<strong>"+ title + "</strong><br>";
            content += "<small>"+ asset_link + "</small><br>";


           content += "&nbsp;<br>";

         thelink = "sellasset("+asset_id+")";


   if (asset_id >= 2199025218704)

           {

           if (the_atype == 6)
              {
              content += "[street]";
              } else
                 {


                 // Get current prices





                   marketid = 1;
       //
       size2 = pricedata.length;
       for (var i2=1; i2<=size2; i2++)
           {
           if (pricedata[i2]['race'] !== undefined)
              {
              if ( pricedata[i2]['race'] == the_race && pricedata[i2]['atype'] == the_atype)
                 {
                 marketid = i2;
                 i2 = size2;
                 } // if ...
              } // != undefined
           } // for...
        // pricedata[id]['race']
   var sov2 =  marketdata_item[marketid];


            content += "<span >"+sov2+" SOV</span><br>";

                 content += "<span class='mintbutton' onclick='"+thelink+"'>Sell NFT</span>";
                 }
           } else
              {
                  content += "[TEST-NFT]";


                 thelink = "burnasset("+asset_id+")";
                 content += "<br>";
                 content += "<span class='mintbutton' onclick='"+thelink+"' style='background:#ff3333;'>Burn NFT</span>";

               }



            content += "</div>";
            content += "</td>";
            } // if (  collection_name == "xusogamedemo" )

          } // for i...


         content += "</tr></table>";


         document.getElementById('div_inventory_inner2').innerHTML =  content;

} // callback_getinventory()




var pricedata = new Array();

function callback_pricedata( rows )
{

console.log("ROWS callback_pricedata ...(callback)");
    console.log(rows);

var size = rows.rows.length;
console.log("size: " + size);

for (var i=0; i<size; i++)
    {
    id = rows.rows[i].id;
//    console.log("id: "+id + " "+rows.rows[i].psov);

    pricedata[id] = new Object();
    pricedata[id]['peos']  = rows.rows[i].peos;
    pricedata[id]['psov']  = rows.rows[i].psov;
    pricedata[id]['atype'] = rows.rows[i].atype;
    pricedata[id]['race']  = rows.rows[i].race;
    } // for...

getdata(callback_getinventory, "atomicassets", global_account, "assets", "", "", "", 112 );
getdata(callback_getinventory_mainpage, "atomicassets", global_account, "assets", "", "", "", 112 );

} // callback_pricedata()


var selectednft = new Object();
selectednft['asset_id'] = "";

function selectnft( asset_id )
{

selectednft['asset_id'] = asset_id;

var divname = "nft_"+asset_id;

console.log(divname + " " + asset_id);


otherdivs = document.getElementsByName("mynft");

size = otherdivs.length;
console.log("size " + size);

for (var i=0; i<size; i++)
    if (otherdivs[i].id != divname )
       {
       console.log("- "+ otherdivs[i].id );
       document.getElementById( otherdivs[i].id ).style.border = "1px solid #ffffff";
       }

} // selectnft()

function loadinventory()
{

console.log("Load inventory...");
getdata(callback_pricedata, "sovspacegame", "sovspacegame", "atemplate", "", "", "", 100 );

} // loadinventory()

function mintasset(id) {

    marketStuffs();

    let s = markets.rows[id - 1].circulation;
    let b = markets.rows[id - 1].startprice;
    let e = markets.rows[id - 1].epsilon;
    let nftType = markets.rows[id - 1].name;
    let singlePrice = 0;
    let totalPrice = 0;
    let sovPriceArray = [];
    let n = prompt("how many " + nftType + "s would you like to mint? (Enter 0 to cancel)");
    while (isNaN(n)) {
        n = prompt("Enter numbers only:");

    };
    n = parseInt(n);

    if (n > 0) {
    //let p = b * (1 + ((s + n - 1) / e));
    //let p1 = b * (1 + (s / e));
    for (let i = 0; i < n; i++) {
        if (e === 0) {
            singlePrice = 20;
        } else {
            singlePrice = b * (1 + ((s + i) / e));
        }
        singlePrice = Number(singlePrice.toFixed(4));
        totalPrice += singlePrice;
        sovPriceArray.push(singlePrice.toFixed(4) + " SOV");
    }

    if (confirm("pay " + totalPrice.toFixed(4) + " SOV to mint " + n + " " + nftType + "s?") == true) {

        var theactions = [];

        memo = "mint;" + global_account + ";" + id;

        //psov = pricedata[id]['psov'] / 10000;
        //peos = pricedata[id]['peos'] / 10000;

        for (let i = 0; i < n; i++) {
            if (i < n) {
                let sovAmount = sovPriceArray[i];
                var action = {
                    account: "sovmintofeos",
                    name: 'transfer',
                    authorization: [{
                        actor: global_account,
                        permission: "active"
                    }],
                    data: {
                        "from": global_account,
                        "to": "sovspacegame",
                        "quantity": sovAmount,
                        "memo": memo,
                    }
                };

                theactions.push(action);
            }
        }
        console.log(theactions);

        if (1) {
            transact(func_success, func_error, theactions);
        }
    }}
} // mintasset()



function sellasset( asset_id )
{

var theactions = [];

var memo = "sell";

    var action = {
                 account: "atomicassets",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "asset_ids": [asset_id],
                       "memo": memo,
                       }
                 };

theactions.push(action);

if (1)
   {
   transact( func_success, func_error, theactions );
   }
} // sellasset()




function burnasset( asset_id )
{

var theactions = [];

var memo = "sell";


    var action = {
                 account: "atomicassets",
                 name: 'burnasset',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "asset_owner": global_account,
                       "asset_id": asset_id,
                       }
                 };




theactions.push(action);




if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // burnasset()




function setmenu( menu )
{

if (menu == 1)
   {
   document.getElementById('page1').style.height = "";
   document.getElementById('page2').style.height = "0px";
   document.getElementById('page3').style.height = "0px";
   document.getElementById('page4').style.height = "0px";
   document.getElementById('page5').style.height = "0px";
   document.getElementById('page6').style.height = "0px";

   document.getElementById('menu1').className = "menubutton_selected";
   document.getElementById('menu2').className = "menubutton";
   document.getElementById('menu3').className = "menubutton";
   document.getElementById('menu4').className = "menubutton";
   document.getElementById('menu5').className = "menubutton";
 //  document.getElementById('menu6').className = "menubutton";
   } else

if (menu == 2)
   {
   document.getElementById('page1').style.height = "0px";
   document.getElementById('page2').style.height = "";
   document.getElementById('page3').style.height = "0px";
   document.getElementById('page4').style.height = "0px";
   document.getElementById('page5').style.height = "0px";
   document.getElementById('page6').style.height = "0px";

   document.getElementById('menu1').className = "menubutton";
   document.getElementById('menu2').className = "menubutton_selected";
   document.getElementById('menu3').className = "menubutton";
   document.getElementById('menu4').className = "menubutton";
   document.getElementById('menu5').className = "menubutton";
 //  document.getElementById('menu6').className = "menubutton";

   marketStuffs();
   loadinventory();
   loadnftinfos();
   loadmarkets();
   }

if (menu == 3)
   {
   document.getElementById('page1').style.height = "0px";
   document.getElementById('page2').style.height = "0px";
   document.getElementById('page3').style.height = "";
   document.getElementById('page4').style.height = "0px";
   document.getElementById('page5').style.height = "0px";
   document.getElementById('page6').style.height = "0px";

   document.getElementById('menu1').className = "menubutton";
   document.getElementById('menu2').className = "menubutton";
   document.getElementById('menu3').className = "menubutton_selected";
   document.getElementById('menu4').className = "menubutton";
   document.getElementById('menu6').className = "menubutton";
//   document.getElementById('menu5').className = "menubutton";      #

   }

if (menu == 4)
   {
   document.getElementById('page1').style.height = "0px";
   document.getElementById('page2').style.height = "0px";
   document.getElementById('page3').style.height = "0px";
   document.getElementById('page4').style.height = "";
   document.getElementById('page5').style.height = "0px";
   document.getElementById('page6').style.height = "0px";

   document.getElementById('menu1').className = "menubutton";
   document.getElementById('menu2').className = "menubutton";
   document.getElementById('menu3').className = "menubutton";
   document.getElementById('menu4').className = "menubutton_selected";
   document.getElementById('menu5').className = "menubutton";
 //  document.getElementById('menu6').className = "menubutton";


   }


if (menu == 5)
   {
   document.getElementById('page1').style.height = "0px";
   document.getElementById('page2').style.height = "0px";
   document.getElementById('page3').style.height = "0px";
   document.getElementById('page4').style.height = "0px";
   document.getElementById('page5').style.height = "";
   document.getElementById('page6').style.height = "0px";

   document.getElementById('menu1').className = "menubutton";
   document.getElementById('menu2').className = "menubutton";
   document.getElementById('menu3').className = "menubutton";
   document.getElementById('menu4').className = "menubutton";
   document.getElementById('menu5').className = "menubutton_selected";
 //  document.getElementById('menu6').className = "menubutton";
   loadadminnftinfos();
   }


// Terms of Use
if (menu == 6)
   {
   document.getElementById('page1').style.height = "0px";
   document.getElementById('page2').style.height = "0px";
   document.getElementById('page3').style.height = "0px";
   document.getElementById('page4').style.height = "0px";
   document.getElementById('page5').style.height = "0px";
   document.getElementById('page6').style.height = "";

   document.getElementById('menu1').className = "menubutton";
   document.getElementById('menu2').className = "menubutton";
   document.getElementById('menu3').className = "menubutton";
   document.getElementById('menu4').className = "menubutton";
   document.getElementById('menu5').className = "menubutton";
//   document.getElementById('menu6').className = "menubutton_selected";
   }


} // setmenu


function moveobject( direction )
{

last_action				 = "moveobject";
last_attack_direction    = direction;

//var movesteps =  document.getElementById('movesteps').value * 1
var movesteps = 1;

var theactions = [];

var dir = "";
if (direction == 1) dir = "n";
if (direction == 2) dir = "e";
if (direction == 3) dir = "s";
if (direction == 4) dir = "w";

memo = "move;"+global_account+";"+globalselection['assetid']+";"+dir;


var quantitysov = globaldata['m_sov'] / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";



    var action = {
                 account: "sovmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysov,
                       "memo": memo,


                       }
                 };


 for (var i=0; i<movesteps; i++)
     {
     theactions.push(action);
     }





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // moveobject()




function demolishobject( direction )
{

if (direction == 1) direction = "n";
if (direction == 2) direction = "e";
if (direction == 3) direction = "s";
if (direction == 4) direction = "w";





var theactions = [];




    var action = {
                 account: "sovspacegame",
                 name: 'demolish',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "user": global_account,
                       "assetid": globalselection['assetid'],
                       "direction": direction,
                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // demolishobject()




function repeataction()
{

if (last_action == "attackobject")
   {
   attackobject( last_attack_direction, last_attack_tank_assetid, last_attack_target );
   }

if (last_action == "moveobject")
   {
   moveobject( last_attack_direction );
   }

} // repeataction


var last_action 			 = 0;
var last_attack_direction    = 0;
var last_attack_tank_assetid = 0;
var last_attack_target       = 0;

function attackobject( direction, tank_assetid, target )
{
last_action				 = "attackobject";
last_attack_direction    = direction;
last_attack_tank_assetid = tank_assetid;
last_attack_target       = target;


//  attackobject( "", tank_assetid, globalselection['assetid'] )

var theactions = [];

var dir = "";

var memo = "";

if (tank_assetid != "")
{
//  memo = "attack;gametester22;2199023338154;s"
memo = "attack;"+global_account+";"+tank_assetid+";"+target;

} else
  {
  if (direction == 1) dir = "n";
  if (direction == 2) dir = "e";
  if (direction == 3) dir = "s";
  if (direction == 4) dir = "w";
  memo = "attack;"+global_account+";"+globalselection['assetid']+";"+dir;
  }


console.log("a_sov:" + globaldata['a_sov']);
var quantitysov = globaldata['a_sov'] / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";


console.log("MEMO:");
console.log(memo);

console.log("quantitysov:");
console.log(quantitysov);

    var action = {
                 account: "sovmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysov,
                       "memo": memo,


                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // attackobject()



function plantgarden()
{
var theactions = [];


var memo = "homeworld;"+global_account+";"+globalselection['x']+";"+globalselection['y']+"";





var quantitysvx = globaldata['svx_self'] / 10000;
quantitysvx = Number(quantitysvx).toFixed(4) + " SVX";




    var action = {
                 account: "svxmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysvx,
                       "memo": memo,
                       }
                 };


theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // plantgarden


function toggletower()
{
var config = globalselection['config'];
var configarray = split(config,";");

var disabled = 0;




if ( configarray.length > 0)
{

for (var i=0; i< configarray.length; i+=2)
{

if (configarray[i] == 'disabled' &&
    configarray[i+1] != "" && configarray[i+1] != undefined
   )
   {
   disabled = 1;
   }


} // for

} // if

//alert("Toggle tower - disabled:" + disabled);

newvalue = "";
if (disabled == 1) newvalue = "";
if (disabled == 0) newvalue = "1";

var theactions = [];


    var action = {
                 account: "sovspacegame",
                 name: 'setnftoption',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user": global_account,
                       "type": "disabled",
                       "value": newvalue
                       }
                 };


theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }

} // toggletower

function firered()
{

memo = "detonate;"+global_account+";"+globalselection['assetid'];



var quantitysov = globaldata['a_sov'] / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";



var theactions = [];


    var action = {
                 account: "sovmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysov,
                       "memo": memo,


                       }
                 };



theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // firered

function repairobject( direction )
{



var theactions = [];

var dir = "";
if (direction == 1) dir = "n";
if (direction == 2) dir = "e";
if (direction == 3) dir = "s";
if (direction == 4) dir = "w";



memo = "repair;"+global_account+";"+globalselection['assetid']+";"+dir;

// OLD
var quantitysov = (globaldata['a_sov']*3) / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";


// NEW -----
   /*
   globalselection['x']
   thex = mappingarray[theid][0]  ;
they = mappingarray[theid][1] ;

   */
x = globalselection['x'];
y = globalselection['y'];
//alert("xy: " + thex + " " + they + " " );


if (direction == 1)  {   they--;    }
if (direction == 2)  {   thex++;    }
if (direction == 3)  {   they++;    }
if (direction == 4)  {   thex--;    }

target_asset_id         =  tilearray[thex][they]['asset_id'];
target_race             =  tilearray[thex][they]['race'];
target_atype            =  tilearray[thex][they]['atype'];


marketid = 1;
       //
       size2 = pricedata.length;
       for (var i2=1; i2<=size2; i2++)
           {
           if (pricedata[i2]['race'] !== undefined)
              {
              if ( pricedata[i2]['race'] == target_race && pricedata[i2]['atype'] == target_atype)
                 {
                 marketid = i2;
                 i2 = size2;
                 } // if ...
              } // != undefined
           } // for...


       var sov2 =  marketdata[marketid] * 0.50;
      // var sov2 =  marketdata_plus[marketid] * 0.50;



//alert("xy(2): " + thex + " " + they + " sov2_c:"+sov2+ " marketid:" +marketid);

/*
console.log("tilearray ---: " );
console.log(tilearray[thex][they]);
*/
// marketdata[the_id*1]

/// ---

/*

var size = mappingarray.length;

for (var i=0; i<size; i++)
    {
    var thetile = "tile" + i;

    x = mappingarray[i][0];
    y = mappingarray[i][1];




    tile         =  tilearray[x][y]['tile'];
    asset_id         =  tilearray[x][y]['asset_id'];  //
    tileid       =  tilearray[x][y]['tileid'];
    atype        =  tilearray[x][y]['atype'];
    race         =  tilearray[x][y]['race'];


lastsvgid                  = theid;
coordinatei                = tilearray[thex][they].tileid;
owner                      = tilearray[thex][they].owner;
thename                    = tilearray[thex][they].name;
nickname                   = tilearray[thex][they].nick;
globalselection['assetid'] = tilearray[thex][they].asset_id;
globalselection['atype']   = tilearray[thex][they].atype;
globalselection['ori']     = tilearray[thex][they].ori;
globalselection['ts']      = tilearray[thex][they].ts;
globalselection['race']    = tilearray[thex][they].race;
globalselection['shield']  = tilearray[thex][they].shield;
globalselection['attack']  = tilearray[thex][they].attack;
globalselection['config']  = tilearray[thex][they].config;

*/


/*
marketid = 1;
       //
       size2 = pricedata.length;
       for (var i2=1; i2<=size2; i2++)
           {
           if (pricedata[i2]['race'] !== undefined)
              {
              if ( pricedata[i2]['race'] == race && pricedata[i2]['atype'] == atype)
                 {
                 marketid = i2;
                 i2 = size2;
                 } // if ...
              } // != undefined
           } // for...
        // pricedata[id]['race']

       var sov2 =  marketdata[marketid];
       //var sov2 =  marketdata_item[marketid];
       */




/*
    marketdata[the_id*1]      = currentprice2;
    marketdata_item[the_id*1] = currentprice2_sell;


var quantitysov = (globaldata['a_sov']*3) / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";

*/
var quantitysov = sov2;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";


// ---

    var action = {
                 account: "sovmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysov,
                       "memo": memo,


                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // repairobject()



function infectobject( direction )
{



var theactions = [];

var dir = "";
if (direction == 1) dir = "n";
if (direction == 2) dir = "e";
if (direction == 3) dir = "s";
if (direction == 4) dir = "w";



memo = "infect;"+global_account+";"+globalselection['assetid']+";"+dir;

var quantitysov = globaldata['a_sov'] / 10000;
quantitysov = Number(quantitysov).toFixed(4) + " SOV";




    var action = {
                 account: "sovmintofeos",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovspacegame",
                       "quantity": quantitysov,
                       "memo": memo,


                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }


} // infectobject()




nav_mode = 1;

function nav_selection( mode )
{
nav_mode = mode;

if (mode == 1)
   {

   document.getElementById('navsvg_text').innerHTML = "center";

   document.getElementById('navbutton_scroll').className = "navbutton_on";

   // bulldozer=5, service-unit=10, tank=11, transporter=12, RED=14
   if (
      globalselection['atype'] == 5 || // bulldozer
      globalselection['atype'] == 10 ||
      globalselection['atype'] == 11 ||
      globalselection['atype'] == 12 ||
      globalselection['atype'] == 14

      )
      {
      document.getElementById('navbutton_move').className = "navbutton_off";
      } else
        {
        document.getElementById('navbutton_move').className = "navbutton_off_inactive";
        }



   // bulldozer=5, service-unit=10, tank=11, transporter=12
   if (
      globalselection['atype'] == 5 ||
      globalselection['atype'] == 11
      )
      {
        document.getElementById('navbutton_attack').className = "navbutton_off";
      } else
        {
        document.getElementById('navbutton_attack').className = "navbutton_off_inactive";
        }



   // buildings
   if (
      globalselection['atype'] == 1 || // lander
      globalselection['atype'] == 2 || // residence
      globalselection['atype'] == 3 || // agri
      globalselection['atype'] == 4 || // factory
      globalselection['atype'] == 7 || // wall
      globalselection['atype'] == 8 || // collector
      globalselection['atype'] == 9    // tower

      )
      {
        document.getElementById('navbutton_demolish').className = "navbutton_off";
        document.getElementById('navbutton_repeat').className = "navbutton_off";
        document.getElementById('navbutton_garden').className = "navbutton_off";
        document.getElementById('navbutton_disable').className = "navbutton_off";
        document.getElementById('navbutton_fire').className = "navbutton_off";

      } else
        {
        document.getElementById('navbutton_demolish').className = "navbutton_off_inactive";
        document.getElementById('navbutton_repeat').className = "navbutton_off_inactive";
        document.getElementById('navbutton_garden').className = "navbutton_off_inactive";
        document.getElementById('navbutton_disable').className = "navbutton_off_inactive";
        document.getElementById('navbutton_fire').className = "navbutton_off_inactive";
        }
// // navbutton_repeat navbutton_garden navbutton_disable navbutton_fire


   // bulldozer=5, service-unit=10, tank=11, transporter=12
   if (
      globalselection['atype'] == 10
      )
      {
        document.getElementById('navbutton_repair').className = "navbutton_off";
      } else
        {
        document.getElementById('navbutton_repair').className = "navbutton_off_inactive";
        }

//   document.getElementById('navbutton_infect').className = "navbutton_off";


   document.getElementById('path924').style.visibility = "visible";
   document.getElementById('path929').style.visibility = "visible";

   document.getElementById('circ1').style.visibility = "visible";
   document.getElementById('circ3').style.visibility = "visible";
   document.getElementById('circ5').style.visibility = "visible";
   document.getElementById('circ7').style.visibility = "visible";

   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "hidden";
   document.getElementById('movesteps_div').   style.height = "0px";
   */
   }

if (mode == 2)
   {
   document.getElementById('navsvg_text').innerHTML = "move";

    document.getElementById('navbutton_scroll').className = "navbutton_off";
   document.getElementById('navbutton_move').className = "navbutton_on";
  /*
   document.getElementById('navbutton_attack').className = "navbutton_off";
   document.getElementById('navbutton_demolish').className = "navbutton_off";
   document.getElementById('navbutton_repair').className = "navbutton_off";
//   document.getElementById('navbutton_infect').className = "navbutton_off";
   document.getElementById('navbutton_repeat').className = "navbutton_off";
   document.getElementById('navbutton_garden').className = "navbutton_off";
   document.getElementById('navbutton_disable').className = "navbutton_off";
   document.getElementById('navbutton_fire').className = "navbutton_off";
   */


// navbutton_repeat navbutton_garden navbutton_disable navbutton_fire


   document.getElementById('path924').style.visibility = "hidden";
   document.getElementById('path929').style.visibility = "hidden";

   document.getElementById('circ1').style.visibility = "hidden";
   document.getElementById('circ3').style.visibility = "hidden";
   document.getElementById('circ5').style.visibility = "hidden";
   document.getElementById('circ7').style.visibility = "hidden";


   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "visible";
   document.getElementById('movesteps_div').   style.height = "";
   */

   document.getElementById('scrollcenter').style.visibility = "hidden";
   }

if (mode == 3)
   {
   document.getElementById('navsvg_text').innerHTML = "attack";

   document.getElementById('navbutton_scroll').className = "navbutton_off";
   document.getElementById('navbutton_move').className = "navbutton_off";
   document.getElementById('navbutton_attack').className = "navbutton_on";
   document.getElementById('navbutton_demolish').className = "navbutton_off";
   document.getElementById('navbutton_repair').className = "navbutton_off";
//   document.getElementById('navbutton_infect').className = "navbutton_off";


   document.getElementById('path924').style.visibility = "hidden";
   document.getElementById('path929').style.visibility = "hidden";

   document.getElementById('circ1').style.visibility = "hidden";
   document.getElementById('circ3').style.visibility = "hidden";
   document.getElementById('circ5').style.visibility = "hidden";
   document.getElementById('circ7').style.visibility = "hidden";

   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "hidden";
   document.getElementById('movesteps_div').   style.height = "0px";
   */

   document.getElementById('scrollcenter').style.visibility = "hidden";

   if (globalselection['atype'] == 11)
      {
      settanktarget();
      } // if atype == 1


   }

if (mode == 4)
   {
   document.getElementById('navsvg_text').innerHTML = "demolish";

   document.getElementById('navbutton_scroll').className = "navbutton_off";
   document.getElementById('navbutton_move').className = "navbutton_off";
   document.getElementById('navbutton_attack').className = "navbutton_off";
   document.getElementById('navbutton_demolish').className = "navbutton_on";
   document.getElementById('navbutton_repair').className = "navbutton_off";
//   document.getElementById('navbutton_infect').className = "navbutton_off";


   document.getElementById('path924').style.visibility = "hidden";
   document.getElementById('path929').style.visibility = "hidden";

   document.getElementById('circ1').style.visibility = "hidden";
   document.getElementById('circ3').style.visibility = "hidden";
   document.getElementById('circ5').style.visibility = "hidden";
   document.getElementById('circ7').style.visibility = "hidden";

   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "hidden";
   document.getElementById('movesteps_div').   style.height = "0px";
   */

   document.getElementById('scrollcenter').style.visibility = "hidden";
   }

if (mode == 5)
   {
   document.getElementById('navsvg_text').innerHTML = "repair";

   document.getElementById('navbutton_scroll').className = "navbutton_off";
   document.getElementById('navbutton_move').className = "navbutton_off";
   document.getElementById('navbutton_attack').className = "navbutton_off";
   document.getElementById('navbutton_demolish').className = "navbutton_off";
   document.getElementById('navbutton_repair').className = "navbutton_on";
//   document.getElementById('navbutton_infect').className = "navbutton_off";

   document.getElementById('path924').style.visibility = "hidden";
   document.getElementById('path929').style.visibility = "hidden";

   document.getElementById('circ1').style.visibility = "hidden";
   document.getElementById('circ3').style.visibility = "hidden";
   document.getElementById('circ5').style.visibility = "hidden";
   document.getElementById('circ7').style.visibility = "hidden";

   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "hidden";
   document.getElementById('movesteps_div').   style.height = "0px";
   */

   document.getElementById('scrollcenter').style.visibility = "hidden";
   }


if (mode == 6)
   {
   document.getElementById('navsvg_text').innerHTML = "infect";

   document.getElementById('navbutton_scroll').className = "navbutton_off";
   document.getElementById('navbutton_move').className = "navbutton_off";
   document.getElementById('navbutton_attack').className = "navbutton_off";
   document.getElementById('navbutton_demolish').className = "navbutton_off";
   document.getElementById('navbutton_repair').className = "navbutton_off";
//   document.getElementById('navbutton_infect').className = "navbutton_on";

   document.getElementById('path924').style.visibility = "hidden";
   document.getElementById('path929').style.visibility = "hidden";

   document.getElementById('circ1').style.visibility = "hidden";
   document.getElementById('circ3').style.visibility = "hidden";
   document.getElementById('circ5').style.visibility = "hidden";
   document.getElementById('circ7').style.visibility = "hidden";

   // movesteps_div
   /*
   document.getElementById('movesteps_div').   style.visibility = "hidden";
   document.getElementById('movesteps_div').   style.height = "0px";
   */

   document.getElementById('scrollcenter').style.visibility = "hidden";
   }


} // nav_selection



function toggle_info()
{
checkbox_shield = document.getElementById('checkbox_shield').checked;
checkbox_owner  = document.getElementById('checkbox_owner').checked;

var size = mappingarray.length;



value_shield = 'hidden';
if (checkbox_shield) value_shield = 'visible';

value_owner = 'hidden';
if (checkbox_owner) value_owner = 'visible';

for (var i=0; i<size; i++)
    {
    var divid_shieldinfo = "shieldinfo_" + i;
    if ( document.getElementById(divid_shieldinfo) != undefined )
       {
       document.getElementById(divid_shieldinfo).style.visibility = value_shield;
       }

    var divid_shieldinfobar = "shieldbar_" + i;
    if ( document.getElementById(divid_shieldinfobar) != undefined )
       {
       document.getElementById(divid_shieldinfobar).style.visibility = value_shield;
       }

    var divid_ownderinfo = "ownerinfo_" + i;
    if ( document.getElementById(divid_ownderinfo) != undefined )
       {
       document.getElementById(divid_ownderinfo).style.visibility = value_owner;
       }

    } // for i...


} // toggle_info


function history_callback( value )
{
console.log("HIST:");
//console.log(value);

var buffer = "";

size = value.actions.length;

for (var i=0; i<size; i++)
    {
    action = value.actions[i].act.name;
    console.log("A: "+action);
    
    if (action == "logmsg")
       {
       message = value.actions[i].act.data.message;
       
       parsearray = message.split(" ");
       
       
       if ( parsearray[0] == "destroyed" )
          {
          attacker = parsearray[2].split(":")[1];
          nft      = parsearray[4].split(":")[1];
          coor     = parsearray[5].split(":")[1];
  
  
          if (attacker != undefined)
             { 
             link = "https://eos.atomichub.io/explorer/asset/"+nft;
          
             width = 1000000;
             they2 = parseInt ( coor / width );
             thex2 = coor - (they2*width);
  
             link2 = "<span onclick='setcenter2(" +thex2+ "," +they2+ ")' style='cursor:pointer;color:#ffb800;'>[center]</span>";

             buffer +=  "Destroyed: by "+attacker+" NFT: <a href='"+link+"' target='_blank' style='color:9999ff'>"+nft+"</a>  x:"+thex2+" y:"+they2+" "+link2+" <br>";

             } // if (attacker != undefined)

          }
       } // if
       
    } // for i..

document.getElementById("historyinfo").innerHTML = buffer;

} // history_callback




var history_info_cnt = 0;

async  function history_info( mode )
{

if (mode == 0)
   {
   document.getElementById("historyinfo").innerHTML = "";
     document.getElementById("historyinfo").style.height = "20px";
   } else
     {
     document.getElementById("historyinfo").style.height = "";
     }

history_info_cnt++;
console.log("H: " + history_info_cnt);
 // alfalf
limit = 1000;

start = "2023-03-16T03:00Z";
start = "2023-03-13T03:00Z";

var now = new Date().getTime() / 1000;
now -= 60*60*24 * 1.5;

  var a = new Date(now * 1000);
                       
 var year = a.getFullYear();
  var month = a.getMonth()+1;
  if (month < 10) month = "0" + month;
  var day = a.getDate();
  if (day < 10) day = "0" + day;  
  
start = year+ "-" +month+ "-" +day+ "T00:00Z";  

 

var url = "https://eos.hyperion.eosrio.io/v2/history/get_actions?account=sovspacegame&sort=asc&limit="+limit+"&after="+start+"";

console.log("URL: " + url);
 
var jsonparam = JSON.stringify( {} );
 

const options = {
  headers: {
     
  }
};

fetch(url, options)
  .then( res => res.json() )
  .then( data =>   history_callback(data) );


} // history_info



function callback_loadnftinfos( value )
{

console.log("NFT-INFOS");
//console.log( value.rows );


if (value.rows.length == 0) return;

var size = value.rows.length;

var buffer_humans   = "";
var buffer_greys    = "";
var buffer_sirians  = "";
var buffer_reptos   = "";

for (var i=0; i<size; i++)
    {
    the_id     = value.rows[i].id;
    the_name   = value.rows[i].name;
    the_race   =  value.rows[i].race;
    the_sov    =  value.rows[i].psov;
    the_ipfs   = value.rows[i].ipfs;
    the_atype  =  value.rows[i].atype;
    //the_sov    = the_sov / 10000;

    pricespan  = "pricespan_"+the_id;

    var imgbuffer = "<img src='img/nft_"+the_race+"_"+the_atype+".png' style='width:100px;margin-top:10px;'>";

    var blockedview = 0;

  //  if (the_atype == 11 ) blockedview = 1;
  //  if (the_atype == 12 ) blockedview = 1;



    if (blockedview == 0)
    {
    if (the_race == 1)
       {
       mintlink = "mintasset("+the_id+")";

       buffer_humans += "<div class='nft_cell' style='height:220px;'>";
       buffer_humans += "<div style='height:40px'>"+the_name + "</div>";
       buffer_humans += imgbuffer + "<br>";
       buffer_humans += "<span id='"+pricespan+"'>..." + "</span> SOV<br>";
       buffer_humans += "<span class='mintbutton' onclick='"+mintlink+"'>Mint NFT</span>";

       buffer_humans += "</div>";

       }

    if (the_race == 2)
       {
       mintlink = "mintasset("+the_id+")";

       buffer_greys += "<div class='nft_cell' style='height:220px;'>";
       buffer_greys += "<div style='height:40px'>"+the_name + "</div>";
       buffer_greys += imgbuffer + "<br>";
       buffer_greys += "<span id='"+pricespan+"'>..." + "</span> SOV<br>";

       buffer_greys += "<span class='mintbutton' onclick='"+mintlink+"'>Mint NFT</span>";

       buffer_greys += "</div>";
       }

    if (the_race == 4)
       {
       mintlink = "mintasset("+the_id+")";

       buffer_sirians += "<div class='nft_cell' style='height:220px;'>";
       buffer_sirians += "<div style='height:40px'>"+the_name + "</div>";
       buffer_sirians += imgbuffer + "<br>";
       buffer_sirians += "<span id='"+pricespan+"'>..." + "</span> SOV<br>";

       buffer_sirians += "<span class='mintbutton' onclick='"+mintlink+"'>Mint NFT</span>";

       buffer_sirians += "</div>";
       }

    if (the_race == 5)
       {
       mintlink = "mintasset("+the_id+")";

       buffer_reptos += "<div class='nft_cell' style='height:220px;'>";
       buffer_reptos += "<div style='height:40px'>"+the_name + "</div>";
       buffer_reptos += imgbuffer + "<br>";
       buffer_reptos += "<span id='"+pricespan+"'>..." + "</span> SOV<br>";

       buffer_reptos += "<span class='mintbutton' onclick='"+mintlink+"'>Mint NFT</span>";

       buffer_reptos += "</div>";
       }


    } // if (the_atype != 8)

    } // for i...


buffer_humans += "<div style='clear:both'></div><small>(Please wait a few seconds after a mint for price update!)</small>";
buffer_humans += "<br><div onclick='callback_loadmarkets()' class='refreshboard' style='margin-left:auto;margin-right:auto;width:250px;margin-top:20px;margin-bottom:2px;cursor:pointer;'>Update Prices &#8634;</div>";

buffer_greys += "<div style='clear:both'></div><small>(Please wait a few seconds after a mint for price update!)</small>";
buffer_greys += "<br><div onclick='callback_loadmarkets()' class='refreshboard' style='margin-left:auto;margin-right:auto;width:250px;margin-top:20px;margin-bottom:2px;cursor:pointer;'>Update Prices &#8634;</div>";

buffer_sirians += "<div style='clear:both'></div><small>(Please wait a few seconds after a mint for price update!)</small>";
buffer_sirians += "<br><div onclick='callback_loadmarkets()' class='refreshboard' style='margin-left:auto;margin-right:auto;width:250px;margin-top:20px;margin-bottom:2px;cursor:pointer;'>Update Prices &#8634;</div>";

buffer_reptos += "<div style='clear:both'></div><small>(Please wait a few seconds after a mint for price update!)</small>";
buffer_reptos += "<br><div onclick='callback_loadmarkets()' class='refreshboard' style='margin-left:auto;margin-right:auto;width:250px;margin-top:20px;margin-bottom:2px;cursor:pointer;'>Update Prices &#8634;</div>";

document.getElementById("mintarea").innerHTML = "<br><h2>Human-NFT's</h2>" + buffer_humans + "<br><div style='clear:both'></div><br><h2>Grey-NFT's</h2>" + buffer_greys + ""  + "<div style='clear:both'></div><br><h2>Sirian-NFT's</h2>" + buffer_sirians + ""     + "<div style='clear:both'></div><br><h2>Repto-NFT's</h2>" + buffer_reptos + "";

} // callback_render_balance1




function loadnftinfos()
{

getdata(callback_loadnftinfos, "sovspacegame", "sovspacegame", "atemplate", "", "", "", 212 );

} // loadnftinfos




var marketdata           = new Array();
var marketdata_item      = new Array();
var marketdata_plus      = new Array();

async function callback_loadmarkets( value )
{

console.log("MARKET-INFOS");
console.log( value );

if (value == undefined) return;
if (value.rows.length == 0) return;

var size = value.rows.length;

for (var i=0; i<size; i++)
    {
   // console.log("i: " + i+  " " + value.rows[i].id + " sp:"  + value.rows[i].startprice );

    the_id             = value.rows[i].id;
    the_circulation    = value.rows[i].circulation;
    the_startprice     = value.rows[i].startprice;
    the_epsilon        = value.rows[i].epsilon;


    currentprice2 = 0;
    currentprice2_sell = 0;
    currentprice2_plus = 0;

    if (the_epsilon > 0)
    {
    // OLD
    /*
    powresult = Math.pow( 2, (the_circulation / the_epsilon ) );
    var currentprice_f = the_startprice * powresult;
    console.log("powresult: " + powresult + "  currentprice_f:"+currentprice_f  );
      */

    // NEW
    // currentprice_f = (float)iterator_markets->startprice + (float)iterator_markets->startprice * (  (float)( (circulation) / (float)epsilon )    );
    var currentprice_f = the_startprice + ( the_startprice *  (the_circulation / the_epsilon ) );
    currentprice2 = toFixed2(currentprice_f, 4);

    currentprice_f = the_startprice + ( the_startprice *  ( (the_circulation-1) / the_epsilon ) );
    currentprice2_sell = toFixed2(currentprice_f, 4);

    currentprice_fb = the_startprice + ( the_startprice *  ( (the_circulation+2) / the_epsilon ) );
    currentprice2_plus = toFixed2(currentprice_fb, 4);

    } else
      {
      var currentprice_f = the_startprice * 1;
      //console.log("powresult: " + powresult + "  currentprice_f:"+currentprice_f  );

      currentprice2 = toFixed2(currentprice_f, 4);

      currentprice2_sell = 0; // should never displayed
      currentprice2_plus = 0; // should never displayed
      }



    /*
       float powresult = pow( 2,  (float)( (circulation) / (float)epsilon )  )  ;
         //print(" powresult: ", powresult ," " );

         float currentprice_f = (float)iterator_markets->startprice * (  powresult    );

         uint64_t   currentprice  = currentprice_f * 10000;
    */




    marketdata     [the_id*1] = currentprice2;
    marketdata_item[the_id*1] = currentprice2_sell;
    marketdata_plus[the_id*1] = currentprice2_plus;




    pricespan  = "pricespan_"+the_id;

    if ( document.getElementById(pricespan) )
       {
       document.getElementById(pricespan).innerHTML =  currentprice2 ;


       }
    } // for i...

} // callback_loadmarkets

function callback_markets(value) {
    if (value == undefined) return;
    if (value.rows.length == 0) return;
    markets = value;
} // callback_markets

function marketStuffs() {
    getdata(callback_markets, "sovspacegame", "sovspacegame", "markets", "", "", "", 100);
} // marketStuffs


function toFixed2(num, fixed) {
    var re = new RegExp('^-?\\d+(?:\.\\d{0,' + (fixed || -1) + '})?');
    return num.toString().match(re)[0];
}



function loadmarkets()
{
marketdata      = new Array();
marketdata_item = new Array();



getdata(callback_loadmarkets, "sovspacegame", "sovspacegame", "markets", "", "", "", 212 );


} // loadmarkets


function updatemoveattackprices()
{


var new_moveprice   = document.getElementById("new_moveprice").value*1;
var new_attackprice = document.getElementById("new_attackprice").value*1;




var theactions = [];

param = "editprices;"+new_moveprice+";0;"+new_attackprice+";0";



    var action = {
                 account: "sovspacegame",
                 name: 'admin',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "param": param
                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // updatemoveattackprices


function callback_loadadminnftinfos( value )
{

console.log("NFT-INFOS");
console.log( value.rows );


var buffer = "";

buffer += "<br>";
buffer += "edit price:<br>";
buffer += "<br>";
buffer += "Move Price (msov) <input type='text' id='new_moveprice' value='"+globaldata['m_sov']+"'><br>";
buffer += "Attack Price (msov) <input type='text' id='new_attackprice' value='"+globaldata['a_sov']+"'><br>";
buffer += "<div onclick='updatemoveattackprices();'>[update move/attack-prices]</div>";


document.getElementById("admin_edit_move_attac_prices").innerHTML = buffer;




if (value.rows.length == 0) return;

var size = value.rows.length;

var buffer_humans  = "";
var buffer_greys   = "";
var buffer_sirians = "";
var buffer_reptos  = "";

for (var i=0; i<size; i++)
    {
    the_id     = value.rows[i].id;
    the_name   = value.rows[i].name;
    the_race   =  value.rows[i].race;
    the_sov    =  value.rows[i].psov;
    the_ipfs   = value.rows[i].ipfs;
    the_atype  =  value.rows[i].atype;
    the_sov_raw = the_sov ;
    the_sov    = the_sov / 10000;


    var imgbuffer = "<img src='img/nft_"+the_race+"_"+the_atype+".png' style='width:100px;margin-top:10px;'>";


    if (the_race == 1)
       {
       setpricelink = "setassetprice("+the_id+")";

       buffer_humans += "<div class='nft_cell' style='height:270px;'>";
       buffer_humans += "<div style='height:40px'>"+the_name + "</div>";
       buffer_humans += imgbuffer + "<br>";
       buffer_humans += the_sov_raw+ " SOV<br>";
       buffer_humans += "("+the_sov+ " SOV)<br>";

       elm = "admin_setsov_" + the_id;
       buffer_humans += "<input id='"+elm+"' type='text' > <br>";
       buffer_humans += "<span class='mintbutton' onclick='"+setpricelink+"'>Set Price</span>";

       buffer_humans += "</div>";

       }

    if (the_race == 2)
       {

       setpricelink = "setassetprice("+the_id+")";

       buffer_greys += "<div class='nft_cell' style='height:270px;'>";
       buffer_greys += "<div style='height:40px'>"+the_name + "</div>";
       buffer_greys += imgbuffer + "<br>";
       buffer_greys += the_sov_raw+ " SOV<br>";
       buffer_greys += "("+the_sov+ " SOV)<br>";

       elm = "admin_setsov_" + the_id;
       buffer_greys += "<input id='"+elm+"' type='text' > <br>";
       buffer_greys += "<span class='mintbutton' onclick='"+setpricelink+"'>Set Price</span>";

       buffer_greys += "</div>";
       }


    if (the_race == 4)
       {

       setpricelink = "setassetprice("+the_id+")";

       buffer_sirians += "<div class='nft_cell' style='height:270px;'>";
       buffer_sirians += "<div style='height:40px'>"+the_name + "</div>";
       buffer_sirians += imgbuffer + "<br>";
       buffer_sirians += the_sov_raw+ " SOV<br>";
       buffer_sirians += "("+the_sov+ " SOV)<br>";

       elm = "admin_setsov_" + the_id;
       buffer_sirians += "<input id='"+elm+"' type='text' > <br>";
       buffer_sirians += "<span class='mintbutton' onclick='"+setpricelink+"'>Set Price</span>";

       buffer_sirians += "</div>";
       }


    if (the_race == 5)
       {

       setpricelink = "setassetprice("+the_id+")";

       buffer_reptos += "<div class='nft_cell' style='height:270px;'>";
       buffer_reptos += "<div style='height:40px'>"+the_name + "</div>";
       buffer_reptos += imgbuffer + "<br>";
       buffer_reptos += the_sov_raw+ " SOV<br>";
       buffer_reptos += "("+the_sov+ " SOV)<br>";

       elm = "admin_setsov_" + the_id;
       buffer_reptos += "<input id='"+elm+"' type='text' > <br>";
       buffer_reptos += "<span class='mintbutton' onclick='"+setpricelink+"'>Set Price</span>";

       buffer_reptos += "</div>";
       }


    } // for i...

document.getElementById("admin_mintarea").innerHTML = "<br><h2>Human-NFT's</h2>" + buffer_humans + "<br><div style='clear:both'></div><br><h2>Grey-NFT's</h2>" + buffer_greys + ""  +   "<br><div style='clear:both'></div><br><h2>Sirian-NFT's</h2>" + buffer_sirians + ""       +   "<br><div style='clear:both'></div><br><h2>Repto-NFT's</h2>" + buffer_reptos + "";

} // callback_render_balance1




function loadadminnftinfos()
{

getdata(callback_loadadminnftinfos, "sovspacegame", "sovspacegame", "atemplate", "", "", "", 112 );

} // loadnftinfos





// --
// Admin

function initarea()
{

tile = document.getElementById('areatile').value;



width = 1000000;
they = parseInt ( globalselection['coordinate'] / width );

thex = globalselection['coordinate'] - (they*width);





var theactions = [];

param = "initarea;"+thex+";"+they+";"+tile;



    var action = {
                 account: "sovspacegame",
                 name: 'admin',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "param": param

                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // initarea
// end - admin


function delarea()
{

tile = document.getElementById('areatile').value;



width = 1000000;
they = parseInt ( globalselection['coordinate'] / width );

thex = globalselection['coordinate'] - (they*width);





var theactions = [];

param = "delarea;"+thex+";"+they;



    var action = {
                 account: "sovspacegame",
                 name: 'admin',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "param": param

                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // delarea
// end - admin

function selfdestruct()
{
console.log("SELFDESTRUCT");

console.log(global_account);
console.log(globalselection['owner'] );

if ( global_account != "sovspacegame" )
   {
   if ( globalselection['owner'] != global_account ) return;
   } // if



//tile = document.getElementById('areatile').value;


var theactions = [];




    var action = {
                 account: "sovspacegame",
                 name: 'selfdestruct',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "assetid": globalselection['assetid'],
                       "user" : global_account

                       }
                 };


theactions.push(action);



if (1)
   {
   transact( func_success, func_error, theactions );
   }



//alert("");
} // selfdestruct()




function setassetprice( id )
{


elm = "admin_setsov_" + id;
var psov = document.getElementById(elm).value*1;




var theactions = [];

param = "editasset;"+id+";0;"+psov;



    var action = {
                 account: "sovspacegame",
                 name: 'admin',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "param": param

                       }
                 };


    theactions.push(action);





if (1)
   {
   transact( func_success, func_error, theactions );
   }



} // setassetprice


function callback_render_balance_eos( value )
{

if (value.rows.length == 0) return;
balance = value.rows[0].balance;

buffer = "" + balance;
last_balance1 = balance;
document.getElementById('balance_eos').innerHTML = buffer;

} // callback_render_balance1


function getbalance_eos()
{
//alert("test getdata");
getdata(callback_render_balance_eos, "eosio.token", global_account, "accounts", "", "", "", 1 );
}




function callback_render_balance_sov( value )
{

if (value.rows.length == 0) return;
balance = value.rows[0].balance;

buffer = "" + balance;
last_balance1 = balance;
document.getElementById('balance_sov').innerHTML = buffer;

} // callback_render_balance_sov




function getbalance_sov()
{
//alert("test getdata");
getdata(callback_render_balance_sov, "sovmintofeos", global_account, "accounts", "", "", "", 1 );
}





function callback_render_balance_svx( value )
{

if (value.rows.length == 0) return;
balance = value.rows[0].balance;

buffer = "" + balance;
last_balance1 = balance;
document.getElementById('balance_svx').innerHTML = buffer;

} // callback_render_balance_svx




function getbalance_svx()
{
getdata(callback_render_balance_svx, "svxmintofeos", global_account, "accounts", "", "", "", 1 );
}

function buysov_sovdex()
{
value = document.getElementById('eos_for_sov').value;


eostobuy = Number(value).toFixed(4) + " EOS";




var theactions = [];




    var action = {
                 account: "svxmintofeos",
                 name: 'open2',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "user": global_account
                       }
                 };


theactions.push(action);




memo = "SOV";

    var action = {
                 account: "eosio.token",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "to": "sovdexrelays",
                       "quantity": eostobuy,
                       "memo": memo
                       }
                 };


theactions.push(action);

if (1)
   {
   transact( func_success, func_error, theactions );
   }

} // buysov_sovdex




function buysov_newdex()
{
value = document.getElementById('eos_for_sov').value;



eostobuy = Number(value).toFixed(4) + " EOS";




var theactions = [];

var theaction =  {
              "type": "buy-market",
              "symbol":"sovmintofeos-sov-eos",
              "price":"0.000000",
              "channel":"web"
            };

var memo = JSON.stringify(theaction);


    var action = {
                 account: "eosio.token",
                 name: 'transfer',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                  "from": global_account,
                       "to": "newdexpublic",
                       "quantity": eostobuy,
                       "memo": memo
                       }
                 };


theactions.push(action);

if (1)
   {
   transact( func_success, func_error, theactions );
   }

} // buysov_newdex



function update_claimdata()
{

var now = new Date().getTime() / 1000;

var seconds = now - global_tslastclaim;
var interval = (24*60*60);


  var towait_sec = interval - seconds;

  // Find the distance between now and the count down date
    var hours = towait_sec / 3600;
    hours = Math.floor(hours);
    if (hours < 10) hours = "0" + hours;
     var minute =   (towait_sec % 3600) / 60;
    minute = Math.floor(minute);
    if (minute < 10) minute = "0" + minute;

      var second = towait_sec % 60;
    second = Math.floor(second);
    if (second < 10) second = "0" + second;

 if (towait_sec > 0)
    {
    document.getElementById("claim_svx").innerHTML =  ""+hours+ ":" + minute + ":" + second;
    document.getElementById("claim_svx").className =  "claim_off";
    } else
      {
      document.getElementById("claim_svx").innerHTML =  "Claim";
      document.getElementById("claim_svx").className =  "claim";
      }

} // update_claimdata


var updatecnt = -3;
function update_thread()
{
var time = setTimeout("update_thread()", 1000);

if ( (updatecnt % 20) == 0 )
   {
   getbalance_eos();
   getbalance_sov();
   getbalance_svx();
   getuserinfo();
   }


if ( (updatecnt % 21) == 0 )
   {
   loadmarkets();
   }


if ( (updatecnt % 60*5) == 0 )
   {
   load_my_assets();
   }


if (refreshcounter == 1) refreshboard();
if (refreshcounter > 0) refreshcounter--;

update_claimdata();

updatecnt++;
} //// update_thread






</script>

<script>


loadglobals();
initgameboard();


init_wallets( "sovspacegame",setaccountname, logoutall );

update_thread();
board_update();


refreshcounter = 3;
loadinventory();

//alert("DEMO-MODE - NFT-prices will change, Rules will change!");
</script>





 <script>



// --------- CANVAS

function getXYpos(elm)
{
x = elm.offsetLeft;
y = elm.offsetTop;

elm = elm.offsetParent;

while(elm != null)
{
    x = parseInt(x) + parseInt(elm.offsetLeft);
    y = parseInt(y) + parseInt(elm.offsetTop);
    elm = elm.offsetParent;
}

return {'xp':x, 'yp':y};
} // getXYpos


var mousex=0;
var mousey=0;
var mousex2=0;
var mousey2=0;
var mousebutton = 0;

var globalmapoffsetx = 100;
var globalmapoffsety = 45;


// Get X, Y coords, and displays Mouse coordinates
function getCoords(e) {
var xy_pos = getXYpos(this);

// if IE
if(navigator.appVersion.indexOf("MSIE") != -1)
{
var standardBody = (document.compatMode == 'CSS1Compat') ? document.documentElement : document.body;

x = event.clientX + standardBody.scrollLeft;
y = event.clientY + standardBody.scrollTop;
}
  else {
       x = e.pageX;
       y = e.pageY;
       }

mousex = x - xy_pos['xp'];
mousey = y - xy_pos['yp'];


var elmw = document.getElementById('canvasmain').clientWidth;
var elmh = document.getElementById('canvasmain').clientHeight;

var fw = 400 / elmw;
var fh = 200 / elmh;

mousex2 = mousex * fw;
mousey2 = mousey * fw;

if (mousebutton)
   {
   //setpixel(mousex2, mousey2,  0,255,0 );

   /*

   */


   } // mouseclick


grabtocanvans();

//console.log("mausx " + mousex2 + " elmw:"+elmw + " elmh:"+elmh+ " - "+ fw +" " + fh);
} //getCoords


function setmousebuttondown()
{
mousebutton = 1;


document.getElementById('xcoor').value = Math.floor( 500000+ mousex2  - globalmapoffsetx - 10 );
document.getElementById('ycoor').value = Math.floor( 500000+ mousey2  - globalmapoffsety );
refreshboard();

}

function setmousebuttonup()
{
mousebutton = 0;
}



document.getElementById('canvasmain').onmousemove = getCoords;
document.getElementById('canvasmain').ontouchmove = getCoords;

document.getElementById('canvasmain').onmousedown = setmousebuttondown;
document.getElementById('canvasmain').onmouseup   = setmousebuttonup;

document.getElementById('canvasmain').ontouchstart = setmousebuttondown;
document.getElementById('canvasmain').ontouchend   = setmousebuttonup;


document.addEventListener('canvasmain', function (e) { e.preventDefault(); }, false);




// --




nvmapelement = document.getElementById("navmaphidden");
var canvas = nvmapelement.getContext('2d');
width = nvmapelement.width;
height = nvmapelement.height;
canvas.fillStyle = '#111111';
canvas.fillRect(0, 0, width, height);

var nvmapelementvisible = document.getElementById("navmap").getContext('2d');


black = {
    r: 0,
    g: 0,
    b: 0,
    a: 255
};




function setpixel (x,y, r,g,b)
{
    var p=canvas.createImageData(1,1);
    p.data[0]=r;
    p.data[1]=g;
    p.data[2]=b;
    p.data[3]=255;
    canvas.putImageData(p,x,y);
}


function setpixel2 (x,y, r,g,b)
{
    var p=nvmapelementvisible.createImageData(1,1);
    p.data[0]=r;
    p.data[1]=g;
    p.data[2]=b;
    p.data[3]=255;
    nvmapelementvisible.putImageData(p,x,y);
}


function grabtocanvans()
{

/*

// Mapping-array

let mappingarray =
[
                                                                                [10, 0],
                                                                        [ 9, 1],[10, 1],[11, 1],
                                                                [ 8, 2],[ 9, 2],[10, 2],[11, 2],[12, 2],
                                                        [ 7, 3],[ 8, 3],[ 9, 3],[10, 3],[11, 3],[12, 3],[13, 3],
                                                [ 6, 4],[ 7, 4],[ 8, 4],[ 9, 4],[10, 4],[11, 4],[12, 4],[13, 4],[14, 4],
                                        [ 5, 5],[ 6, 5],[ 7, 5],[ 8, 5],[ 9, 5],[10, 5],[11, 5],[12, 5],[13, 5],[14, 5],[15, 5],
                                [ 4, 6],[ 5, 6],[ 6, 6],[ 7, 6],[ 8, 6],[ 9, 6],[10, 6],[11, 6],[12, 6],[13, 6],[14, 6],
                        [ 3, 7],[ 4, 7],[ 5, 7],[ 6, 7],[ 7, 7],[ 8, 7],[ 9, 7],[10, 7],[11, 7],[12, 7],[13, 7],
                [ 2, 8],[ 3, 8],[ 4, 8],[ 5, 8],[ 6, 8],[ 7, 8],[ 8, 8],[ 9, 8],[10, 8],[11, 8],[12, 8],
        [ 1, 9],[ 2, 9],[ 3, 9],[ 4, 9],[ 5, 9],[ 6, 9],[ 7, 9],[ 8, 9],[ 9, 9],[10, 9],[11, 9],
[ 0,10],[ 1,10],[ 2,10],[ 3,10],[ 4,10],[ 5,10],[ 6,10],[ 7,10],[ 8,10],[ 9,10],[10,10],
        [ 1,11],[ 2,11],[ 3,11],[ 4,11],[ 5,11],[ 6,11],[ 7,11],[ 8,11],[ 9,11],
                [ 2,12],[ 3,12],[ 4,12],[ 5,12],[ 6,12],[ 7,12],[ 8,12],
                        [ 3,13],[ 4,13],[ 5,13],[ 6,13],[ 7,13],
                                [ 4,14],[ 5,14],[ 6,14],
                                        [ 5,15]
];
*/

var offx = (xcoor-500000)   + globalmapoffsetx;
var offy = (ycoor-500000)   + globalmapoffsety;

/*
setpixel(10, 10,  100,100,255 );
setpixel(11, 10,  100,100,255 );
setpixel(11, 11,  100,100,255 );
setpixel(10, 11,  100,100,255 );
*/

var size = mappingarray.length;

for (var i=0; i<size; i++)
    {
    var thetile = "tile" + i;

    x = mappingarray[i][0];
    y = mappingarray[i][1];




    tile         =  tilearray[x][y]['tile'];
    asset_id         =  tilearray[x][y]['asset_id'];  //
    tileid       =  tilearray[x][y]['tileid'];
    atype        =  tilearray[x][y]['atype'];
    race         =  tilearray[x][y]['race'];
    ori          =  tilearray[x][y]['ori'];
    nick         =  tilearray[x][y]['nick'];
    sov          =  tilearray[x][y]['sov'];
    svx_balance  =  tilearray[x][y]['svx_balance']+" SVX2";
    sov  = sov  / 10000;
    owner        =  tilearray[x][y]['owner'];
    shield       =  tilearray[x][y]['shield'];
    shield_max   =  tilearray[x][y]['shield_max'];
    config       =  tilearray[x][y]['config'] + "";


   /*
    // config
//    let configarray = config.split(";");
    let configarray = split(config,";");

    if ( tile != "tile10" &&  tile != "tile11")
       {
       var buffer = "<img src='img/"+tile+".png?s=4442' style='position:absolute;border:none;width:100%;'>" ;
       document.getElementById(thetile).innerHTML = buffer;
       }



    // Object
    var theobject = "obj" + i;
*/

    if (tile != "tile00")
    setpixel(x+offx, y+offy,  60,60,60 );

    if (race == 1)
       {
       setpixel(x+offx, y+offy,  200,200,200 );
       }

    if (race == 2)
       {
       setpixel(x+offx, y+offy,  0,200,0 );
       }

    if (race == 4)
       {
       setpixel(x+offx, y+offy,  100,100,255 );
       }

    if (race == 5)
       {
       setpixel(x+offx, y+offy,  255,50,50 );
       }

    if (tile  == "tile00")
       {
       setpixel(x+offx, y+offy,  30,30,120 );
       }

    // console.log("t: " + tile + " " + tileid);

    } // for i...

  //  console.log("xcoor: " + xcoor + " offx" + offx);
    /*
    xcoor = xcoor + offx;
ycoor = ycoor + offy;
    */

    /*
    //grab the context from your destination canvas
var destCtx = destinationCanvas.getContext('2d');

//call its drawImage() function passing it the source canvas directly
destCtx.drawImage(sourceCanvas, 0, 0);
    */

// Copy hidden Canvas to new one



nvmapelementvisible.drawImage(nvmapelement, 0, 0);



var size = mappingarray_frame.length;

for (var i=0; i<size; i++)
    {


    x = mappingarray_frame[i][0];
    y = mappingarray_frame[i][1];

    setpixel2(x+offx, y+offy,  0,255,0 );
    } // for i...

//for (var i=0; i<=10; i++)
//setpixel2 (30,5+i, 0,255,0) ;

} // grabtocanvas

// --------- CANVAS


// BEGINN CHAT -----

  function timeConverter(UNIX_timestamp) {
                        var a = new Date(UNIX_timestamp * 1000);
                        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                        var year = a.getFullYear() + 356;
                        var month = months[a.getMonth()];
                        var date = a.getDate();
                        var hour = a.getHours();
                        var min = a.getMinutes();
                        var sec = a.getSeconds();
                        var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec;
                        return time;
                    }


var chat_id = 0;
var chat_all_last = "";



function callback_load_all( value )
{
console.log("callback_load_all");

//var max = 10;

console.log( value );

size = value.rows.length;

console.log("size: " + size);

var buffer = "";


for (var i=0; i<size; i++)
    {

  //  if (i >= (size-max) )
       {
       user       = value.rows[i]['user'];
       race       = value.rows[i]['race'];
       txt        = value.rows[i]['text'];
       time       = value.rows[i]['time'];

    var col = "#ffffff";

    if (race == "Human") col = "#aaaaaa";
    if (race == "Grey") col = "#bbffbb";
    if (race == "Sirian") col = "#bbbbff";
    if (race == "Repto") col = "#ffbbbb";

    rendertime = timeConverter( time );

     buffer += "<div style='color:"+col+"'>";
           buffer += "<strong>"+ user + " (" + race + ") - " +  rendertime + "</strong>";
     buffer += "</div>";

    buffer += "<div class='chatbox_bubble'>"+txt+"";
    buffer += "</div>"


       }

      
    } // for i...

document.getElementById("chatbox_all_content").innerHTML = buffer ;



// Update scrolling
if (chat_all_last != value.rows[size-1]['time'])
   {
   document.getElementById("chatbox_all_content_outer").scrollTop = document.getElementById("chatbox_all_content_outer").scrollHeight;
   }
chat_all_last = value.rows[size-1]['time']

} // callback_load_all


var chat_myrace_last = "";


function callback_load_myrace( value )
{
console.log("callback_load_myrace");



console.log( value );

size = value.rows.length;

console.log("size: " + size);



var buffer = "";

if ( userdata['race'] == 1 ) buffer += "<strong>Human Chat</strong><br>";
if ( userdata['race'] == 2 ) buffer += "<strong>Grey Chat</strong><br>";
if ( userdata['race'] == 4 ) buffer += "<strong>Sirian Chat</strong><br>";
if ( userdata['race'] == 5 ) buffer += "<strong>Repto Chat</strong><br>";

document.getElementById("chatbox_myrace_title").innerHTML = buffer ;


buffer = "";

for (var i=0; i<size; i++)
    {
    user       = value.rows[i]['user'];
    txt        = value.rows[i]['text'];
    time        = value.rows[i]['time'];

    rendertime = timeConverter( time );

    buffer += "<strong>"+ user + " " + " - "+rendertime+"</strong>";
    buffer += "<div class='chatbox_bubble'>"+txt+"";
    buffer += "</div>"

    } // for i...

document.getElementById("chatbox_myrace_content").innerHTML = buffer ;





// Update scrolling
if (chat_myrace_last != value.rows[size-1]['time'])
   {
   document.getElementById("chatbox_myrace_content_outer").scrollTop = document.getElementById("chatbox_myrace_content_outer").scrollHeight;
   }
chat_myrace_last = value.rows[size-1]['time']

} // callback_load_myrace





function chat_update_thread()
{
chat_id++;
console.log("chat_id: " + chat_id  + " UR:" + userdata['race'] );

getdata(callback_load_all, "invaderschat", "invaderschat", "allmessages", "", "", "", 500 );


if (userdata['race'] >= 1)
   {
   getdata(callback_load_myrace, "invaderschat", userdata['race'], "racemessages", "", "", "", 500 );
   }

var time = setTimeout("chat_update_thread()", 10000);





} // chat_update_thread()


function chatsend( type )
{

chatinput_all    = document.getElementById('chatinput_all').value;
chatinput_myrace = document.getElementById('chatinput_myrace').value;

document.getElementById('chatinput_all').value = "";
document.getElementById('chatinput_myrace').value = "";


var theactions = [];




var memo = global_account+"";



//var quantityeos = globaldata['a_sov'] / 10000;
//quantitysov = Number(quantitysov).toFixed(4) + " SOV";



if (type == 1)
{

message = chatinput_all;

    var action = {
                 account: "invaderschat",
                 name: 'allmsg',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "message": message
                       }
                 };


theactions.push(action);

} // if (type == 1)




if (type == 2)
{

message = chatinput_myrace;

    var action = {
                 account: "invaderschat",
                 name: 'racemsg',
                 authorization: [{
                                actor: global_account,
                                permission: "active"
                                }],
                 data: {
                       "from": global_account,
                       "message": message
                       }
                 };


theactions.push(action);

} // if (type == 2)


if (1)
   {
   transact( func_success, func_error, theactions );
   }

} // chatsend()



// END CHAT -----


chat_update_thread();
 </script>


</body>
</hmtl>
